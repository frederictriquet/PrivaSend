{
	"files": {
		"src/lib/server/security.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "0",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 32ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 165ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 216ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 75ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6943ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1924ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1838ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1029ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:30\n\n   Duration  10.71s (transform 7.06s, setup 0ms, collect 9.33s, tests 9.76s, environment 61ms, prepare 22.50s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 41 }, "start": { "column": 70, "line": 6 } }
				},
				{
					"id": "1",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 6ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 6ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 142ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 49ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6184ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1156ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1526ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 761ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 16ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 15ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n   Start at  22:33:30\n\n   Duration  10.81s (transform 6.10s, setup 0ms, collect 8.74s, tests 8.44s, environment 12ms, prepare 22.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 10 }, "start": { "column": 23, "line": 10 } }
				},
				{
					"id": "2",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 92ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 6ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 28ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 90ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 152ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1406ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 495ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7114ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2096ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 49ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:30\n\n   Duration  10.91s (transform 6.20s, setup 0ms, collect 8.84s, tests 9.36s, environment 40ms, prepare 20.52s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 10 }, "start": { "column": 49, "line": 10 } }
				},
				{
					"id": "3",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 101ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 130ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 138ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 192ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 291ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5596ms\n\n   × Theme Store > Store Structure > should have subscribe method 5013ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 573ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 38ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 47ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 16ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1764ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 774ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n      Tests  1 failed | 508 passed (509)\n   Start at  22:33:30\n   Duration  11.07s (transform 5.48s, setup 0ms, collect 8.78s, tests 8.55s, environment 12ms, prepare 20.21s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 11 }, "start": { "column": 23, "line": 11 } }
				},
				{
					"id": "6",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 82ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 135ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 58ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 41ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 171ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1651ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 826ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5829ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 813ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n      Tests  1 failed | 508 passed (509)\n   Start at  22:33:43\n   Duration  10.77s (transform 6.08s, setup 0ms, collect 11.32s, tests 8.42s, environment 164ms, prepare 20.09s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 12 }, "start": { "column": 43, "line": 12 } }
				},
				{
					"id": "4",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 48, "line": 11 }, "start": { "column": 42, "line": 11 } }
				},
				{
					"id": "5",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 102ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 167ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 43ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 251ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 71ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 31ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 30ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5455ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 441ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1541ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 771ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 115ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:43\n\n   Duration  11.22s (transform 6.15s, setup 0ms, collect 10.33s, tests 8.24s, environment 45ms, prepare 19.60s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 12 }, "start": { "column": 23, "line": 12 } }
				},
				{
					"id": "7",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 42ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 74ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 343ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 301ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 84ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 31ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 35ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 32ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5764ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 746ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1252ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 471ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:44\n\n   Duration  10.46s (transform 6.71s, setup 0ms, collect 11.40s, tests 8.04s, environment 10ms, prepare 18.35s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 13 }, "start": { "column": 23, "line": 13 } }
				},
				{
					"id": "8",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 44ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 77ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 154ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 293ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 34ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 24ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 106ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 182ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6453ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1439ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1437ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 583ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 127ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 27ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:57\n\n   Duration  11.34s (transform 6.41s, setup 0ms, collect 9.09s, tests 9.35s, environment 8ms, prepare 20.60s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 13 }, "start": { "column": 42, "line": 13 } }
				},
				{
					"id": "9",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 62ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 47ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 236ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 108ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 203ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 262ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 62ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 28ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6849ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1833ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1606ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 734ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n   Start at  22:33:57\n\n   Duration  11.34s (transform 7.12s, setup 0ms, collect 10.63s, tests 9.83s, environment 23ms, prepare 20.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 15 }, "start": { "column": 3, "line": 15 } }
				},
				{
					"id": "10",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 33ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 219ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 71ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 92ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 125ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 133ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 94ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6083ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1065ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1407ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 771ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:33:57\n\n   Duration  11.01s (transform 6.03s, setup 0ms, collect 9.71s, tests 8.67s, environment 17ms, prepare 19.65s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 16 }, "start": { "column": 3, "line": 16 } }
				},
				{
					"id": "11",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 21 }, "start": { "column": 3, "line": 21 } }
				},
				{
					"id": "13",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 22ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 39ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 144ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 50ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 89ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 183ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 177ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 158ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6353ms\n\n   × Theme Store > Store Structure > should have subscribe method 5014ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1322ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1263ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 582ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 58ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:12\n\n   Duration  13.21s (transform 7.64s, setup 0ms, collect 11.89s, tests 8.79s, environment 39ms, prepare 23.39s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 23 }, "start": { "column": 4, "line": 23 } }
				},
				{
					"id": "14",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 191ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 47ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 55ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 71ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 313ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 87ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 21ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 139ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 25ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6734ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1711ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1549ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 956ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 47ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 28ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:12\n\n   Duration  13.07s (transform 9.06s, setup 0ms, collect 13.78s, tests 9.68s, environment 10ms, prepare 24.47s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 39, "line": 24 }, "start": { "column": 4, "line": 24 } }
				},
				{
					"id": "12",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 109ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 143ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 145ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 20ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1713ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 903ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7219ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2205ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:12\n\n   Duration  13.13s (transform 6.97s, setup 0ms, collect 13.00s, tests 9.82s, environment 11ms, prepare 21.85s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 32 }, "start": { "column": 3, "line": 22 } }
				},
				{
					"id": "15",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 38, "line": 25 }, "start": { "column": 4, "line": 25 } }
				},
				{
					"id": "17",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 206ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 100ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 121ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 40ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 33ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7854ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2828ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1542ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 762ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n   Start at  22:34:29\n   Duration  13.45s (transform 7.24s, setup 0ms, collect 11.95s, tests 10.39s, environment 33ms, prepare 25.65s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 27 }, "start": { "column": 4, "line": 27 } }
				},
				{
					"id": "18",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 216ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 72ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 76ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 68ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 116ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 63ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 47ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8288ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3272ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2070ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1123ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:29\n\n   Duration  14.17s (transform 8.87s, setup 0ms, collect 12.02s, tests 11.43s, environment 82ms, prepare 23.76s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 28 }, "start": { "column": 4, "line": 28 } }
				},
				{
					"id": "16",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 30ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 67ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 100ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 188ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 48ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 43ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1756ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 952ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9297ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4272ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:29\n\n   Duration  14.50s (transform 10.19s, setup 0ms, collect 12.63s, tests 11.88s, environment 9ms, prepare 24.72s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 32, "line": 26 }, "start": { "column": 4, "line": 26 } }
				},
				{
					"id": "19",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 29 }, "start": { "column": 4, "line": 29 } }
				},
				{
					"id": "20",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 155ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 279ms\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 40ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 30ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 209ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 103ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 33ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6332ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1306ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1787ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 852ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 114ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:48\n\n   Duration  11.25s (transform 6.61s, setup 0ms, collect 9.87s, tests 9.49s, environment 10ms, prepare 19.93s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 30 }, "start": { "column": 4, "line": 30 } }
				},
				{
					"id": "21",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 217ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 21ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 151ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 46ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7187ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2171ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1555ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 768ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 17ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:48\n\n   Duration  12.68s (transform 7.69s, setup 0ms, collect 10.59s, tests 9.69s, environment 14ms, prepare 24.08s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 31 }, "start": { "column": 4, "line": 31 } }
				},
				{
					"id": "22",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 202ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 264ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 42ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 47ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 25ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6952ms\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1871ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1645ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 793ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 172ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:34:48\n\n   Duration  13.98s (transform 7.66s, setup 0ms, collect 12.81s, tests 9.84s, environment 117ms, prepare 22.25s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 14, "line": 32 }, "start": { "column": 10, "line": 32 } }
				},
				{
					"id": "23",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "24",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "25",
					"mutatorName": "EqualityOperator",
					"replacement": "event.url.protocol !== 'https:'",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "26",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 29, "line": 36 } }
				},
				{
					"id": "27",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 38 }, "start": { "column": 39, "line": 36 } }
				},
				{
					"id": "28",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 45ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 70ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 223ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 200ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 39ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 34ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 133ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 38ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 31ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6355ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1327ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1575ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 795ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 279ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:35:23\n\n   Duration  11.85s (transform 6.03s, setup 0ms, collect 10.06s, tests 9.31s, environment 51ms, prepare 20.12s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 51, "line": 37 }, "start": { "column": 24, "line": 37 } }
				},
				{
					"id": "29",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 71ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 99ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 30ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 34ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1033ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 402ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 40ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7608ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2578ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 41ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n      Tests  1 failed | 508 passed (509)\n   Start at  22:35:25\n\n   Duration  12.97s (transform 9.34s, setup 0ms, collect 13.35s, tests 9.50s, environment 10ms, prepare 22.03s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 90, "line": 37 }, "start": { "column": 53, "line": 37 } }
				},
				{
					"id": "30",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 162ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 81ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 114ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 118ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 81ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 23ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 15ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5996ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 978ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 26ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 798ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 319ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 12ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:35:27\n\n   Duration  11.89s (transform 6.55s, setup 0ms, collect 12.06s, tests 7.88s, environment 9ms, prepare 19.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 61 }, "start": { "column": 68, "line": 46 } }
				},
				{
					"id": "31",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 61, "line": 47 }, "start": { "column": 42, "line": 47 } }
				},
				{
					"id": "32",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 64ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 28ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 30ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 148ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 324ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 17ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 34ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1541ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 749ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 32ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8565ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3543ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n   Start at  22:35:43\n\n   Duration  13.28s (transform 9.54s, setup 0ms, collect 14.72s, tests 11.24s, environment 16ms, prepare 23.23s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "33",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 41ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 58ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 60ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 260ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 207ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 86ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 197ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 80ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 63ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 749ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 345ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6646ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1626ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 31ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:35:45\n\n   Duration  12.66s (transform 7.83s, setup 0ms, collect 11.23s, tests 8.84s, environment 9ms, prepare 21.24s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "34",
					"mutatorName": "LogicalOperator",
					"replacement": "process.env.NODE_ENV === 'production' || proto === 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 174ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 96ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 28ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 160ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 187ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 203ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 26ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 81ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 81ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 21ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 424ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5344ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 327ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:35:48\n   Duration  11.16s (transform 6.39s, setup 0ms, collect 10.89s, tests 7.08s, environment 12ms, prepare 18.19s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "35",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 61ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 97ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 28ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 49ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 164ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 30ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1438ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 546ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5258ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n      Tests  1 failed | 508 passed (509)\n   Start at  22:36:00\n\n   Duration  8.72s (transform 5.12s, setup 0ms, collect 7.59s, tests 7.62s, environment 32ms, prepare 12.52s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "36",
					"mutatorName": "EqualityOperator",
					"replacement": "process.env.NODE_ENV !== 'production'",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "37",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 31, "line": 50 } }
				},
				{
					"id": "38",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "39",
					"mutatorName": "EqualityOperator",
					"replacement": "proto !== 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 33ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 85ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 103ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 124ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 111ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 928ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 774ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 78ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5111ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 121ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:36:17\n\n   Duration  8.63s (transform 5.13s, setup 0ms, collect 7.70s, tests 7.13s, environment 28ms, prepare 13.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "40",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 38ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 37ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 103ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 77ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5404ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 390ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 711ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 401ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n      Tests  1 failed | 508 passed (509)\n   Start at  22:36:18\n\n   Duration  9.73s (transform 5.80s, setup 0ms, collect 8.84s, tests 6.86s, environment 21ms, prepare 17.69s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 57, "line": 50 } }
				},
				{
					"id": "41",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 58 }, "start": { "column": 65, "line": 50 } }
				},
				{
					"id": "42",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 58, "line": 51 }, "start": { "column": 49, "line": 51 } }
				},
				{
					"id": "43",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 70, "line": 51 }, "start": { "column": 60, "line": 51 } }
				},
				{
					"id": "44",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 43ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 129ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 178ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 75ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 27ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 32ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6764ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1744ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1026ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 620ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:36:36\n\n   Duration  10.99s (transform 6.16s, setup 0ms, collect 8.27s, tests 8.72s, environment 27ms, prepare 20.43s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 57 }, "start": { "column": 29, "line": 52 } }
				},
				{
					"id": "45",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 5, "line": 56 }, "start": { "column": 13, "line": 54 } }
				},
				{
					"id": "46",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 78ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 116ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 73ms\n\n     → expected undefined to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 3ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 1ms\n\n     → Cannot read properties of undefined (reading 'trim')\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 9 failed) 105ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 29ms\n\n     → expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 3ms\n\n     → expected undefined to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 20ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 17ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 10ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 1ms\n\n     → expected undefined to be 'Hello World' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle empty string 1ms\n\n     → expected undefined to be '' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 12ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 143ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 188ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 156ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 36ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 62ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 29ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 625ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 415ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 17ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3591ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3580ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected undefined to be '' // Object.is equality\n\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/15]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/15]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/15]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/15]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nTypeError: Cannot read properties of undefined (reading 'trim')\n\n ❯ tests/unit/lib/security-complete.test.ts:55:18\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                  ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/15]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\n- Expected: \n\"scriptalert(\\\"xss\\\")/script\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected undefined to be 'testtest' // Object.is equality\n\n\n- Expected: \n\"testtest\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected undefined to be 'Hello World' // Object.is equality\n\n\n- Expected: \n\"Hello World\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/15]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle empty string\nAssertionError: expected undefined to be '' // Object.is equality\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:43:30\n     41| \n     42|   it('should handle empty string', () => {\n     43|    expect(sanitizeInput('')).toBe('');\n       |                              ^\n     44|   });\n     45| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/15]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/15]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  15 failed | 494 passed (509)\n   Start at  22:36:48\n   Duration  6.59s (transform 3.64s, setup 0ms, collect 6.28s, tests 5.56s, environment 40ms, prepare 10.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 82 }, "start": { "column": 54, "line": 66 } }
				},
				{
					"id": "47",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 77ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 39ms\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 17ms\n     → expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n     → expected 'test<>test' to be 'testtest' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 1ms\n     → expected '<script>alert(\"xss\")</script>' not to contain '<'\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 31ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 10ms\n     → expected '<' to be '' // Object.is equality\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 3ms\n     → expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 64ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 53ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5360ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 338ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1490ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 623ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<script>alert(1)</script>\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected 'test<>test' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"test<>test\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected '<script>alert(\"xss\")</script>' not to contain '<'\n\n\nExpected: \"<\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  6 failed | 503 passed (509)\n\n   Start at  22:36:53\n\n   Duration  10.56s (transform 5.86s, setup 0ms, collect 10.03s, tests 7.58s, environment 10ms, prepare 17.43s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "49",
					"mutatorName": "Regex",
					"replacement": "/[^<>]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 44ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 58ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 16ms\n\n     → expected '<' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 3ms\n     → expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 8 failed) 54ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 25ms\n     → expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 3ms\n     → expected '<>' to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 5ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 2ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should remove event handlers 1ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 1ms\n\n     → expected '' to be 'Hello World' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 6ms\n\n     → expected '<><>' not to contain '<'\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 137ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4737ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4475ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 706ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 17ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<><>\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected '<>' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"<>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n- Expected\n+ Received\n\n- alert(1)\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\nAssertionError: expected '' to be 'test' // Object.is equality\n\n- Expected\n+ Received\n\n- test\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected '' to be 'Hello World' // Object.is equality\n\n\n- Expected\n+ Received\n\n- Hello World\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected '<><>' not to contain '<'\n\n\nExpected: \"<\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  13 failed | 496 passed (509)\n\n   Start at  22:36:58\n\n   Duration  10.42s (transform 7.09s, setup 0ms, collect 11.64s, tests 6.21s, environment 13ms, prepare 18.20s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 61, "line": 70 }, "start": { "column": 54, "line": 70 } }
				},
				{
					"id": "50",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 55ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 140ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 43ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 15ms\n\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 41ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 12ms\n\n     → expected 'Stryker was here!' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 5ms\n\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 40ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 137ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 135ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1062ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 432ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 17ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4016ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4006ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected 'Stryker was here!' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ Stryker was here!\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(1)Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(\"xss\")Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"testStryker was here!Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:37:08\n\n   Duration  7.91s (transform 4.17s, setup 0ms, collect 7.19s, tests 6.11s, environment 17ms, prepare 12.95s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 70 }, "start": { "column": 63, "line": 70 } }
				},
				{
					"id": "51",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 24ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 15ms\n\n     → expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 27ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 10ms\n\n     → expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 170ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 23ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 44ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 193ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 60ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 993ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 432ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4216ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4202ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptjavascript:alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n\nExpected: \"javascript:\"\nReceived: \"scriptjavascript:alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:51:23\n\n     49|    expect(result).not.toContain('<');\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n       |                       ^\n     52|    expect(result).not.toContain('onclick=');\n     53|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:37:12\n\n   Duration  8.96s (transform 6.11s, setup 0ms, collect 9.59s, tests 6.00s, environment 10ms, prepare 16.45s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "53",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 50ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 26ms\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 13ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 3 failed) 43ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 16ms\n\n     → expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 3ms\n\n     → expected 'Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 2ms\n\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 28ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 49ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 46ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2650ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2639ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 692ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 14ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\nExpected: \"test\"\nReceived: \"Stryker was here!Stryker was here!test\"\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected 'Stryker was here!test' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  5 failed | 504 passed (509)\n   Start at  22:37:24\n   Duration  6.96s (transform 3.65s, setup 0ms, collect 6.71s, tests 4.06s, environment 21ms, prepare 11.28s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 73, "line": 73 }, "start": { "column": 71, "line": 73 } }
				},
				{
					"id": "54",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 75, "line": 76 }, "start": { "column": 73, "line": 76 } }
				},
				{
					"id": "55",
					"mutatorName": "Regex",
					"replacement": "/\\son\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 31ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 40ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 8ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 4ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 55ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 38ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 54ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 67ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2699ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2686ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 900ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 603ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:37:37\n\n   Duration  5.90s (transform 2.89s, setup 0ms, collect 5.63s, tests 4.26s, environment 12ms, prepare 9.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "56",
					"mutatorName": "Regex",
					"replacement": "/\\S*on\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 149ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 53ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 26ms\n\n     → expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 50ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 80ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 29ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 428ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3464ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3453ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:37:41\n\n   Duration  7.25s (transform 3.99s, setup 0ms, collect 6.66s, tests 4.69s, environment 14ms, prepare 11.59s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "57",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 83ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 58ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 97ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 31ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 5ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 130ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 27ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 9ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 35ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 41ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2779ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2755ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 503ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:37:49\n   Duration  5.98s (transform 3.02s, setup 0ms, collect 4.87s, tests 4.17s, environment 8ms, prepare 10.91s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "58",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\W+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 66ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 42ms\n     → expected 'onclick=alert()' not to contain 'onclick='\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 3ms\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 169ms\n   × Security Extended Tests > sanitizeInput > should remove event handlers 18ms\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 278ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 281ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 279ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 323ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3783ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3772ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:37:55\n   Duration  8.34s (transform 6.55s, setup 0ms, collect 11.06s, tests 5.67s, environment 12ms, prepare 12.87s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "59",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\s=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 86ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 98ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 11ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 2ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 123ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 11ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 32ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 28ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 45ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 35ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 60ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 692ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 308ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 14ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4094ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4079ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 130ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:38:04\n   Duration  7.07s (transform 4.42s, setup 0ms, collect 6.72s, tests 5.88s, environment 11ms, prepare 10.84s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "60",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\S*=/gi",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "61",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 49ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 25ms\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 35ms\n   × Security Extended Tests > sanitizeInput > should remove event handlers 17ms\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 227ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 27ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3022ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3010ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 594ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 371ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n   Start at  22:38:19\n   Duration  6.46s (transform 3.55s, setup 0ms, collect 5.78s, tests 4.46s, environment 19ms, prepare 11.07s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 79 }, "start": { "column": 50, "line": 79 } }
				},
				{
					"id": "62",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 21ms\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 10ms\n\n     → expected '  test  ' to be 'test' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 23ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 10ms\n\n     → expected '   test   ' to be 'test' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 153ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 25ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 114ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 52ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 114ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 23ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3467ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3450ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 811ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 405ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '   test   ' to be 'test' // Object.is equality\n\nExpected: \"test\"\nReceived: \"   test   \"\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\nAssertionError: expected '  test  ' to be 'test' // Object.is equality\n\nExpected: \"test\"\nReceived: \"  test  \"\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  2 failed | 507 passed (509)\n   Start at  22:38:26\n   Duration  6.82s (transform 3.51s, setup 0ms, collect 5.69s, tests 5.30s, environment 10ms, prepare 11.32s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 81 }, "start": { "column": 9, "line": 81 } }
				},
				{
					"id": "63",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 43ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 23ms\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n     → expected undefined to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n     → expected undefined to be 'README' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 0ms\n     → Cannot read properties of undefined (reading 'length')\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 0ms\n     → Cannot read properties of undefined (reading 'length')\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n     → expected undefined to be '_' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 53ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 64ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 65ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 28ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 13ms\n     → expected undefined to be 'file.tar.gz' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle unicode characters 2ms\n\n     → expected undefined to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 7ms\n\n     → expected undefined to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 177ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 184ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 6 failed) 25ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 8ms\n     → expected undefined to be 'document.pdf' // Object.is equality\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts 6ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal 1ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 1ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 1ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 156ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 15ms\n     → expected undefined to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected undefined to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 129ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 3ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 19ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 9ms\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected undefined to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected undefined to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 3ms\n     → expected undefined to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected undefined to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected undefined to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 0ms\n\n     → Cannot read properties of undefined (reading 'length')\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3568ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3548ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 576ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 23ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 16ms\n     → expected undefined to be 'test.txt' // Object.is equality\n\n   × Security - Real Import Tests > sanitizeFilename > should remove path traversal 3ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 110ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 32 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/32]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected undefined to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected undefined to be 'file.txt' // Object.is equality\n\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:18\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected undefined to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected undefined to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-complete.test.ts:79:18\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                  ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-complete.test.ts:85:18\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected undefined to be '_' // Object.is equality\n\n\n- Expected: \n\"_\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/32]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:13:23\n\n     11|   it('should remove path traversal attempts', () => {\n     12|    const result = sanitizeFilename('../../../etc/passwd');\n     13|    expect(result).not.toContain('..');\n       |                       ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:18:23\n\n     16|   it('should handle nested path traversal', () => {\n     17|    const result = sanitizeFilename('../../.../../evil');\n     18|    expect(result).not.toContain('..');\n       |                       ^\n     19|   });\n     20| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/32]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:33:23\n\n     31|   it('should handle multiple dangerous chars', () => {\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n       |                       ^\n     34|    expect(result).not.toContain('/');\n     35|    expect(result).not.toContain('\\\\');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-extended.test.ts:60:18\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/32]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected undefined to be 'file.tar.gz' // Object.is equality\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/32]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\nAssertionError: expected undefined to be '文件.pdf' // Object.is equality\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/32]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected undefined to be 'my file.txt' // Object.is equality\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/32]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected undefined to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/32]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should remove path traversal\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-real-import.test.ts:14:23\n\n     12|   it('should remove path traversal', () => {\n     13|    const result = sanitizeFilename('../../../etc/passwd');\n     14|    expect(result).not.toContain('..');\n       |                       ^\n     15|   });\n     16|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security.test.ts:30:18\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/32]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n      Tests  32 failed | 477 passed (509)\n   Start at  22:38:33\n   Duration  7.15s (transform 4.75s, setup 0ms, collect 7.25s, tests 5.28s, environment 88ms, prepare 12.43s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 102 }, "start": { "column": 60, "line": 87 } }
				},
				{
					"id": "64",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 29ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 10ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 57ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 69ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 40ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 31ms\n\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 34ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 28ms\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3288ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3277ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 714ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  5 failed | 504 passed (509)\n\n   Start at  22:38:41\n\n   Duration  6.00s (transform 4.02s, setup 0ms, collect 5.14s, tests 4.70s, environment 46ms, prepare 10.28s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 46, "line": 89 }, "start": { "column": 44, "line": 89 } }
				},
				{
					"id": "65",
					"mutatorName": "Regex",
					"replacement": "/[^/\\\\]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 41ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 13ms\n\n     → expected '___' to be 'abc' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n\n     → expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected '______' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n\n     → expected 279 to be less than or equal to 255\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 3ms\n\n     → expected '/' to be '_' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 57ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 37ms\n\n     → expected 305 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 5ms\n\n     → expected '___________' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '______' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 2ms\n\n     → expected '___________' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 218ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 50ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 10ms\n\n     → expected '____________' to be 'document.pdf' // Object.is equality\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 27ms\n\n     → expected '____/__/________' not to contain '/'\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 1ms\n\n     → expected '__\\_______\\________' not to contain '\\'\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 1ms\n\n     → expected '/____\\__///____' not to contain '/'\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 79ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 16ms\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 43ms\n     → expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 7ms\n\n     → expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected '____________' to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 4ms\n\n     → expected 305 to be less than or equal to 255\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 304ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 6 failed) 83ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 38ms\n\n     → expected '_/_' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 7ms\n\n     → expected '_\\_' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected '///' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 3ms\n\n     → expected '________' to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 10ms\n\n     → expected 305 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2955ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2940ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 37ms\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 29ms\n     → expected '________' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 11ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 25 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected '_/_' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"_/_\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected '_\\_' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"_\\_\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '///' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"///\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/25]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\nAssertionError: expected '________' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"________\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/25]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected 305 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected '___' to be 'abc' // Object.is equality\n\nExpected: \"abc\"\nReceived: \"___\"\n\n ❯ tests/unit/lib/security-complete.test.ts:63:40\n\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n       |                                        ^\n     64|   });\n     65| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"_/_/_/_\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected '______' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"______\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nAssertionError: expected 279 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected '/' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"/\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/25]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/25]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\nAssertionError: expected '____/__/________' not to contain '/'\n\nExpected: \"/\"\nReceived: \"____/__/________\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/25]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\nAssertionError: expected '__\\_______\\________' not to contain '\\'\n\nExpected: \"\\\"\nReceived: \"__\\_______\\________\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/25]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\nAssertionError: expected '/____\\__///____' not to contain '/'\n\nExpected: \"/\"\nReceived: \"/____\\__///____\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:34:23\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n     34|    expect(result).not.toContain('/');\n       |                       ^\n     35|    expect(result).not.toContain('\\\\');\n     36|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/25]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected 305 to be less than or equal to 255\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/25]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\nAssertionError: expected '___________' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"___________\"\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/25]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '______' to be '文件.pdf' // Object.is equality\n\nExpected: \"文件.pdf\"\nReceived: \"______\"\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/25]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected '___________' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"___________\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/25]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected '________' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"________\"\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"____/__/________\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"____\\__\\________\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nAssertionError: expected 305 to be less than or equal to 255\n ❯ tests/unit/lib/security.test.ts:30:26\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/25]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n      Tests  25 failed | 484 passed (509)\n   Start at  22:38:47\n   Duration  5.92s (transform 3.50s, setup 0ms, collect 6.07s, tests 4.29s, environment 10ms, prepare 9.31s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 92 }, "start": { "column": 32, "line": 92 } }
				},
				{
					"id": "66",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 29ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 10ms\n\n     → expected 'abcd' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 100ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 31ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 66ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 48ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 41ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 21ms\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 4 failed) 38ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 19ms\n\n     → expected 'ab' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 5ms\n     → expected 'ab' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 4ms\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 2ms\n     → expected 'unnamed_file' to be '___' // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3184ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3171ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 554ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 9 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/9]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\nAssertionError: expected 'abcd' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"abcd\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/9]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/9]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n      Tests  9 failed | 500 passed (509)\n   Start at  22:38:54\n   Duration  6.90s (transform 3.13s, setup 0ms, collect 5.75s, tests 4.54s, environment 15ms, prepare 11.17s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 92 }, "start": { "column": 42, "line": 92 } }
				},
				{
					"id": "67",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 30ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 9ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n     → expected 'README.README' to be 'README' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 3ms\n     → expected 255 to be 254 // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected '_._' to be '_' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 54ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 48ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 142ms\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 36ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 127ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 86ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 29ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 29ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 84ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 105ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 87ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 11ms\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 163ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 54ms\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3648ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3628ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 7 failed) 71ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 48ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 4ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 3ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 9ms\n\n     → expected '___.___' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 2ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 624ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 67ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 62ms\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 18ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 22 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/22]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/22]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/22]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/22]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/22]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/22]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/22]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/22]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\nAssertionError: expected 255 to be 254 // Object.is equality\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '_._' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"_._\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/22]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/22]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/22]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/22]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/22]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n      Tests  22 failed | 487 passed (509)\n   Start at  22:39:01\n   Duration  7.66s (transform 4.24s, setup 0ms, collect 7.78s, tests 5.77s, environment 11ms, prepare 12.25s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "68",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 61ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 8ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 51ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 11ms\n\n     → expected 278 to be less than or equal to 255\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 95ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 120ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 59ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 27ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 13ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3015ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2998ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 20ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 7ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 500ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:39:09\n\n   Duration  7.26s (transform 3.29s, setup 0ms, collect 5.77s, tests 4.37s, environment 13ms, prepare 10.35s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "69",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length >= 255",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "70",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length <= 255",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 103ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 149ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 75ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 73ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 34ms\n\n     → expected 304 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 39ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 10ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n     → expected 255 to be 254 // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n     → expected 278 to be less than or equal to 255\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected '_._' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 57ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 30ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 36ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 62ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 46ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 19ms\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 143ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 35ms\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 1ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n\n     → expected 304 to be less than or equal to 255\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 48ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 85ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 49ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 2ms\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 3ms\n\n     → expected '___.___' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 7ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 7ms\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 2ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 451ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4176ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4167ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 65ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 17ms\n\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 139ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 26 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 255 to be 254 // Object.is equality\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nAssertionError: expected 278 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected '_._' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"_._\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/26]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/26]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/26]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n      Tests  26 failed | 483 passed (509)\n   Start at  22:39:24\n   Duration  8.77s (transform 4.57s, setup 0ms, collect 8.34s, tests 6.14s, environment 97ms, prepare 14.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "71",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 20ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 34ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 12ms\n     → expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 29ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 16ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 52ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 20ms\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 9ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 16ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 6ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3374ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3360ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 22ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 618ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 25ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security.test.ts:30:26\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:39:33\n   Duration  6.87s (transform 4.31s, setup 0ms, collect 7.59s, tests 4.64s, environment 9ms, prepare 10.78s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 99 }, "start": { "column": 30, "line": 95 } }
				},
				{
					"id": "72",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 89ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 18ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 58ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 33ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 15ms\n     → expected '.true' to contain '.txt'\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 147ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 289ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 24ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 17ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3236ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3223ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected '.true' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \".true\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:39:40\n\n   Duration  6.13s (transform 3.57s, setup 0ms, collect 6.22s, tests 4.32s, environment 8ms, prepare 9.29s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "48",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/[<>]/g, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "73",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 40ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 21ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 9ms\n\n     → expected '.false' to contain '.txt'\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 161ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 101ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 293ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 16ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 8ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3399ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3386ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected '.false' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \".false\"\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n   Start at  22:39:46\n\n   Duration  6.30s (transform 2.88s, setup 0ms, collect 5.07s, tests 4.49s, environment 30ms, prepare 9.15s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "74",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized.split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 36ms\n   × Security Extended Tests > filename edge cases > should handle very long filenames 19ms\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 48ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 54ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 70ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 36ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 13ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 8ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2523ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2502ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 397ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:39:53\n\n   Duration  5.50s (transform 3.28s, setup 0ms, collect 5.41s, tests 3.64s, environment 23ms, prepare 8.23s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "75",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 44ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 25ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 118ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 88ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 44ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 79ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 101ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 14ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 8ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 602ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4196ms\n   ✓ Theme Store > Store Structure > should have subscribe method 4184ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.t\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:39:58\n\n   Duration  8.54s (transform 4.52s, setup 0ms, collect 8.12s, tests 5.72s, environment 20ms, prepare 12.80s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 34, "line": 96 }, "start": { "column": 31, "line": 96 } }
				},
				{
					"id": "76",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 45, "line": 96 } }
				},
				{
					"id": "52",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/javascript:/gi, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "77",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 28ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 78ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 22ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 8ms\n\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 43ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 58ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 18ms\n\n     → expected 296 to be less than or equal to 255\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 27ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 7ms\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 14ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 7ms\n\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3071ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3022ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 453ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 296 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:40:08\n\n   Duration  6.88s (transform 4.21s, setup 0ms, collect 6.90s, tests 4.25s, environment 13ms, prepare 10.89s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 70, "line": 97 }, "start": { "column": 26, "line": 97 } }
				},
				{
					"id": "78",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 - ext.length + 1",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 28ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 12ms\n\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 103ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 42ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 25ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 44ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 9ms\n\n     → expected 257 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 34ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 29ms\n\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1067ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 498ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4913ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4897ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:40:13\n\n   Duration  9.15s (transform 5.36s, setup 0ms, collect 9.20s, tests 6.76s, environment 35ms, prepare 13.06s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 69, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "79",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 + ext.length",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 9ms\n\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 110ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 37ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 7ms\n     → expected 289 to be less than or equal to 255\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 31ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 190ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 58ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 67ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 7ms\n     → expected 261 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 30ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 16ms\n\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 698ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 313ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 5002ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4987ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected 261 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 289 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected 261 to be less than or equal to 255\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nAssertionError: expected 261 to be less than or equal to 255\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:40:14\n\n   Duration  8.88s (transform 5.48s, setup 0ms, collect 9.04s, tests 6.55s, environment 12ms, prepare 14.45s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "80",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 78ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 14ms\n\n     → expected 'unnamed_file' to contain '.txt'\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 170ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 199ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 39ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 20ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 849ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 392ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 5019ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4999ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:40:23\n\n   Duration  9.01s (transform 5.61s, setup 0ms, collect 8.17s, tests 6.73s, environment 17ms, prepare 13.35s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 98 }, "start": { "column": 15, "line": 98 } }
				},
				{
					"id": "81",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 115ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 18ms\n     → expected true to be 'unnamed_file' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n     → expected true to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n     → expected true to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n     → expected undefined to be 254 // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 2ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 13ms\n     → expected true to be '_' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 53ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 102ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 15ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected true to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected true to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected true to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 38ms\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 11ms\n     → expected true to be 'document.pdf' // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 114ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 20ms\n     → expected true to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 45ms\n     → expected true to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 5ms\n     → expected true to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected true to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 5ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 25ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 98ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 40ms\n     → expected true to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 5ms\n\n     → expected true to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 2ms\n\n     → expected true to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 2ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected true to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 39ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1269ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 625ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4713ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4680ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 31ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 145ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 134ms\n     → expected true to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 26 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected true to be '___' // Object.is equality\n\n- Expected: \n\"___\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected true to be 'file.txt' // Object.is equality\n\n\n- Expected: \n\"file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected true to be 'a_b_c_d' // Object.is equality\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected true to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected undefined to be 254 // Object.is equality\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected true to be '_' // Object.is equality\n\n\n- Expected: \n\"_\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/26]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected true to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected true to be '文件.pdf' // Object.is equality\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected true to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/26]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected true to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/26]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  26 failed | 483 passed (509)\n\n   Start at  22:40:24\n\n   Duration  9.39s (transform 5.61s, setup 0ms, collect 8.41s, tests 7.14s, environment 14ms, prepare 15.42s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "82",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 48ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 8ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected false to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 4ms\n\n     → expected false to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected false to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 70ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 106ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 20ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n\n     → expected false to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected false to be 'README' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n\n     → expected undefined to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 6ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n\n     → expected false to be '_' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 192ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 38ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 32ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 83ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 62ms\n\n     → expected false to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 28ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 11ms\n\n     → expected false to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 5ms\n\n     → expected false to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected false to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected false to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 2ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 98ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 26ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 31ms\n\n     → expected false to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected false to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected false to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 5ms\n\n     → expected false to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 2ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 14ms\n\n     → expected false to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 16ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 397ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4476ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4454ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 46ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 38ms\n     → expected false to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 26 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected false to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected false to be 'file.txt' // Object.is equality\n\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected false to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/26]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected false to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected undefined to be 254 // Object.is equality\n\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected false to be '_' // Object.is equality\n\n\n- Expected: \n\"_\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/26]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected false to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected false to be '文件.pdf' // Object.is equality\n\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected false to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/26]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected false to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/26]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  26 failed | 483 passed (509)\n\n   Start at  22:40:30\n\n   Duration  8.79s (transform 4.82s, setup 0ms, collect 7.09s, tests 6.03s, environment 10ms, prepare 13.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "83",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized && 'unnamed_file'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 37ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 39ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 12ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 4ms\n\n     → expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'unnamed_file' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n     → expected 12 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 73ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 102ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 12ms\n\n     → expected 'unnamed_file' to contain '.txt'\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n     → expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 50ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 44ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 67ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 26ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 18ms\n\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 117ms\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 55ms\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 2ms\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 2ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 344ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 81ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 10ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 14ms\n\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 2ms\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 2ms\n     → expected 'unnamed_file' to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n     → expected 'unnamed_file' to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 47ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3643ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3625ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 69ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 62ms\n     → expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 12ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 24 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/24]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/24]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/24]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/24]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/24]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/24]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'unnamed_file' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/24]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/24]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/24]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/24]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected 'unnamed_file' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/24]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 12 to be 254 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 254\n+ 12\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/24]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/24]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/24]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/24]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\nAssertionError: expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/24]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/24]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/24]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/24]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/24]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/24]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/24]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/24]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/24]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  24 failed | 485 passed (509)\n\n   Start at  22:40:33\n\n   Duration  7.46s (transform 4.90s, setup 0ms, collect 7.07s, tests 5.09s, environment 12ms, prepare 13.14s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "84",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 51ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 31ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 127ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 34ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 90ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 33ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 178ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 23ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 37ms\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 13ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 34ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 27ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 2ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 703ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 404ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5291ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  6 failed | 503 passed (509)\n   Start at  22:40:41\n\n   Duration  9.38s (transform 6.75s, setup 0ms, collect 10.27s, tests 6.85s, environment 29ms, prepare 12.45s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 22, "line": 101 }
					}
				},
				{
					"id": "85",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 131ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 7 failed) 196ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 78ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 12ms\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 4ms\n     → expected undefined to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 2ms\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected undefined to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 11ms\n     → expected undefined to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 3ms\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 155ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 33ms\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 13ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 8ms\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 66ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 52ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 58ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 36ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 10ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 2ms\n     → expected undefined to be false // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 4ms\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 39ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 22ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > isValidMimeType > should validate exact match 1ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 2ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3908ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3893ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 174ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 158ms\n     → expected undefined to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 4ms\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1090ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 484ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 22 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/22]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/22]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/22]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/22]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/22]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/22]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/22]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/22]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  22 failed | 487 passed (509)\n\n   Start at  22:40:43\n\n   Duration  8.76s (transform 4.62s, setup 0ms, collect 8.01s, tests 6.32s, environment 12ms, prepare 14.63s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 119 },
						"start": { "column": 84, "line": 107 }
					}
				},
				{
					"id": "86",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 58ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 19ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 54ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 32ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 86ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 183ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 81ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 19ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 158ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 19ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 9ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 28ms\n   × Security Utils > isValidMimeType > should validate exact match 15ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 3ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 20ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 959ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 358ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4903ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4889ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 54ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  13 failed | 496 passed (509)\n\n   Start at  22:40:50\n\n   Duration  8.52s (transform 4.57s, setup 0ms, collect 6.96s, tests 6.98s, environment 11ms, prepare 13.20s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "87",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 25ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 10ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 42ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 31ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 173ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 43ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 21ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 19ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 24ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4798ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4785ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 664ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 101ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 75ms\n     → expected false to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 4ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n      Tests  6 failed | 503 passed (509)\n   Start at  22:40:52\n   Duration  7.81s (transform 5.11s, setup 0ms, collect 7.21s, tests 6.36s, environment 11ms, prepare 12.41s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "88",
					"mutatorName": "EqualityOperator",
					"replacement": "allowedTypes.length !== 0",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 257ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 42ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 62ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 16ms\n\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 15ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 3ms\n\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 90ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 50ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 103ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 10ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 1ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 66ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 49ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate exact match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4475ms\n   ✓ Theme Store > Store Structure > should have subscribe method 4461ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 965ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 432ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 86ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 14ms\n     → expected false to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 18 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/18]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/18]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/18]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/18]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/18]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/18]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  18 failed | 491 passed (509)\n\n   Start at  22:41:00\n\n   Duration  8.55s (transform 5.39s, setup 0ms, collect 9.05s, tests 6.67s, environment 9ms, prepare 14.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "89",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 62ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 65ms\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 19ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 305ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 51ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 118ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 73ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 46ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 34ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4238ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4226ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 671ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 355ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 163ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 155ms\n     → expected false to be true // Object.is equality\n\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 3ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:66:51\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n      Tests  6 failed | 503 passed (509)\n   Start at  22:41:00\n   Duration  8.66s (transform 4.08s, setup 0ms, collect 7.51s, tests 6.09s, environment 11ms, prepare 13.60s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 109 },
						"start": { "column": 40, "line": 109 }
					}
				},
				{
					"id": "90",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 38ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 11ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 5ms\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 2ms\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 63ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 9ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 11ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 3ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 75ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 60ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 95ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 143ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 202ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 81ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 70ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 36ms\n\n   × Security Utils > isValidMimeType > should validate exact match 15ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 3ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 3ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 677ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 316ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4651ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4640ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  13 failed | 496 passed (509)\n\n   Start at  22:41:08\n\n   Duration  7.96s (transform 4.04s, setup 0ms, collect 6.59s, tests 6.33s, environment 18ms, prepare 13.64s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "91",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 49ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 114ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 59ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 46ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 8ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 136ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 26ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 182ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 31ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 11ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 33ms\n   × Security Utils > isValidMimeType > should validate exact match 15ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 4ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4581ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4564ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 693ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 438ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  7 failed | 502 passed (509)\n   Start at  22:41:10\n   Duration  8.23s (transform 4.56s, setup 0ms, collect 7.04s, tests 6.16s, environment 24ms, prepare 13.25s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "92",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 73ms\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 24ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 77ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 20ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 2ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 40ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 154ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 227ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 61ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 74ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 25ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 9ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 282ms\n\n   × Security Utils > isValidMimeType > should validate exact match 136ms\n\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 4ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 730ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 344ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4133ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4123ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 20ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  7 failed | 502 passed (509)\n   Start at  22:41:18\n\n   Duration  8.89s (transform 6.41s, setup 0ms, collect 11.03s, tests 6.25s, environment 9ms, prepare 15.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 50, "line": 112 },
						"start": { "column": 46, "line": 112 }
					}
				},
				{
					"id": "93",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 118ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 70ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 42ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 44ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 69ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 48ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 44ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 13ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 66ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 71ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 148ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 95ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 34ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3957ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3944ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 950ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 458ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:76:55\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:83:51\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n      Tests  5 failed | 504 passed (509)\n   Start at  22:41:18\n\n   Duration  8.97s (transform 6.16s, setup 0ms, collect 8.81s, tests 5.94s, environment 38ms, prepare 15.24s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 115 },
						"start": { "column": 34, "line": 115 }
					}
				},
				{
					"id": "94",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 38ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 18ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 53ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 31ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 3ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 104ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 91ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 127ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 22ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 11ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 46ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 163ms\n\n   × Security Utils > isValidMimeType > should validate exact match 66ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 78ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 4ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 17ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1001ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 529ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 25ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5886ms\n\n   × Theme Store > Store Structure > should have subscribe method 5022ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 837ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 14 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/14]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/14]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/14]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  14 failed | 495 passed (509)\n\n   Start at  22:41:27\n\n   Duration  9.69s (transform 8.23s, setup 0ms, collect 12.71s, tests 7.95s, environment 17ms, prepare 15.20s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "95",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 58ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 77ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 47ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 20ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 42ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 28ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 25ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 23ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 11ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4917ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4898ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 680ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 13ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  5 failed | 504 passed (509)\n   Start at  22:41:27\n   Duration  9.37s (transform 5.92s, setup 0ms, collect 9.58s, tests 6.35s, environment 135ms, prepare 15.37s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "96",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 43ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 9ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 24ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 9ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 55ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 148ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 34ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 16ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 727ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4275ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4226ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  5 failed | 504 passed (509)\n\n   Start at  22:41:37\n\n   Duration  8.17s (transform 4.97s, setup 0ms, collect 8.20s, tests 5.74s, environment 10ms, prepare 14.26s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 43, "line": 116 },
						"start": { "column": 28, "line": 116 }
					}
				},
				{
					"id": "97",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 26ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 44ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 46ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 52ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 180ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 72ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 14ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 52ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 21ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 8ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 809ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 476ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4932ms\n   ✓ Theme Store > Store Structure > should have subscribe method 4913ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  5 failed | 504 passed (509)\n\n   Start at  22:41:37\n\n   Duration  8.21s (transform 4.72s, setup 0ms, collect 7.10s, tests 6.61s, environment 17ms, prepare 12.65s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 57, "line": 116 },
						"start": { "column": 53, "line": 116 }
					}
				},
				{
					"id": "98",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 32ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 13ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 65ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 67ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 10ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 39ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 183ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 35ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 72ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 60ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 42ms\n   × Security Utils > isValidMimeType > should validate exact match 25ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 3ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 5ms\n     → expected true to be false // Object.is equality\n ✓ tests/unit/lib/auth.test.ts (11 tests) 559ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4425ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4412ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  13 failed | 496 passed (509)\n   Start at  22:41:46\n\n   Duration  8.35s (transform 4.97s, setup 0ms, collect 8.03s, tests 5.92s, environment 8ms, prepare 13.40s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 14, "line": 118 },
						"start": { "column": 9, "line": 118 }
					}
				},
				{
					"id": "99",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 63ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 7 failed) 28ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 9ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe image formats 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe document formats 1ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats 3ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 21 failed) 44ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 14ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 3ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension 1ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 13 failed) 228ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 19ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 2ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 53ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 2ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 29ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions 14ms\n\n     → expected undefined to be false // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 72ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 77ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 43ms\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 3ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected undefined to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should allow .pdf files 2ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should allow .jpg files 2ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 6ms\n\n     → expected undefined to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4035ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4017ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 782ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 413ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 13ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 7ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Real Import Tests > hasDangerousExtension > should allow .txt 1ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 49 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/49]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:177:49\n\n    175| \n    176|   it('should handle no extension', () => {\n    177|    expect(hasDangerousExtension('noextension')).toBe(false);\n       |                                                 ^\n    178|   });\n    179|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/49]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/49]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:85:50\n\n     83| \n     84|   it('should allow safe extensions', () => {\n     85|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     86|    expect(hasDangerousExtension('image.png')).toBe(false);\n     87|    expect(hasDangerousExtension('data.json')).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/49]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:91:44\n\n     89| \n     90|   it('should handle files without extension', () => {\n     91|    expect(hasDangerousExtension('README')).toBe(false);\n       |                                            ^\n     92|   });\n     93| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/49]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe image formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:94:47\n\n     92|   it('should allow safe image formats', () => {\n     93|    // Function already imported\n     94|    expect(hasDangerousExtension('photo.png')).toBe(false);\n       |                                               ^\n     95|    expect(hasDangerousExtension('image.gif')).toBe(false);\n     96|    expect(hasDangerousExtension('pic.webp')).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe document formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:101:51\n\n     99|   it('should allow safe document formats', () => {\n    100|    // Function already imported\n    101|    expect(hasDangerousExtension('document.docx')).toBe(false);\n       |                                                   ^\n    102|    expect(hasDangerousExtension('sheet.xlsx')).toBe(false);\n    103|    expect(hasDangerousExtension('presentation.pptx')).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:108:48\n\n    106|   it('should allow safe archive formats', () => {\n    107|    // Function already imported\n    108|    expect(hasDangerousExtension('archive.7z')).toBe(false);\n       |                                                ^\n    109|    expect(hasDangerousExtension('files.rar')).toBe(false);\n    110|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/49]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/49]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/49]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should allow .txt\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:38:19\n     36|   it('should allow .txt', () => {\n     37|    const result = hasDangerousExtension('safe.txt');\n     38|    expect(result).toBe(false);\n       |                   ^\n     39|   });\n     40|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/49]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .pdf files\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:52:50\n\n     50| \n     51|   it('should allow .pdf files', () => {\n     52|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     53|   });\n     54| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/49]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .jpg files\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:56:47\n\n     54| \n     55|   it('should allow .jpg files', () => {\n     56|    expect(hasDangerousExtension('photo.jpg')).toBe(false);\n       |                                               ^\n     57|   });\n     58| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/49]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/49]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  49 failed | 460 passed (509)\n\n   Start at  22:41:46\n\n   Duration  8.64s (transform 3.52s, setup 0ms, collect 7.38s, tests 5.72s, environment 19ms, prepare 12.63s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 150 },
						"start": { "column": 66, "line": 124 }
					}
				},
				{
					"id": "100",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 30ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 70ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 64ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 49ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 27ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 4ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 129ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 22ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 14ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 52ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 10ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 30ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 30ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 57ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 140ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 109ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 7ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 28ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5415ms\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 381ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1317ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 597ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 254ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 247ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 12ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  41 failed | 468 passed (509)\n   Start at  22:41:53\n\n   Duration  10.68s (transform 6.09s, setup 0ms, collect 9.34s, tests 8.00s, environment 9ms, prepare 14.57s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 146 },
						"start": { "column": 20, "line": 125 }
					}
				},
				{
					"id": "101",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 74ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 35ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 41ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 16ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 171ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 41ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 28ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 33ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 27ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 36ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 160ms\n   × Security Utils > hasDangerousExtension > should detect .exe files 18ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 87ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 21ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 33ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1011ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 464ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 15ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 9ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5653ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 636ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 11 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/11]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/11]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/11]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/11]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/11]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/11]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/11]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/11]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/11]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n      Tests  11 failed | 498 passed (509)\n   Start at  22:41:55\n   Duration  10.11s (transform 6.88s, setup 0ms, collect 10.39s, tests 7.74s, environment 14ms, prepare 16.45s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 126 }, "start": { "column": 3, "line": 126 } }
				},
				{
					"id": "103",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 64ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 28ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 10ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 43ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 74ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 32ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 101ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 76ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 737ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 374ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4227ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4216ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  3 failed | 506 passed (509)\n   Start at  22:42:05\n   Duration  8.60s (transform 4.03s, setup 0ms, collect 6.96s, tests 5.76s, environment 8ms, prepare 16.51s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 128 }, "start": { "column": 3, "line": 128 } }
				},
				{
					"id": "102",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 49ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 32ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 35ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 113ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 32ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 76ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 72ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 56ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 37ms\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 27ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 15ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 702ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 404ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4286ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4262ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n      Tests  4 failed | 505 passed (509)\n   Start at  22:42:05\n\n   Duration  8.82s (transform 4.95s, setup 0ms, collect 8.06s, tests 5.88s, environment 9ms, prepare 15.18s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 127 }, "start": { "column": 3, "line": 127 } }
				},
				{
					"id": "104",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 39ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 15ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 68ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 44ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 19ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 189ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 46ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 51ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 43ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 27ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 29ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 903ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 503ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4692ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4680ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n      Tests  3 failed | 506 passed (509)\n   Start at  22:42:14\n\n   Duration  7.81s (transform 4.40s, setup 0ms, collect 6.78s, tests 6.37s, environment 12ms, prepare 13.00s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 129 }, "start": { "column": 3, "line": 129 } }
				},
				{
					"id": "105",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 261ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 76ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 67ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 51ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 72ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 53ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 445ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4167ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4157ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  2 failed | 507 passed (509)\n   Start at  22:42:15\n   Duration  7.89s (transform 4.28s, setup 0ms, collect 7.24s, tests 5.76s, environment 11ms, prepare 11.69s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 130 }, "start": { "column": 3, "line": 130 } }
				},
				{
					"id": "106",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 44ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 25ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 57ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 76ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 150ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 89ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 62ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 56ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 42ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 22ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4370ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4340ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1324ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 590ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 20ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  3 failed | 506 passed (509)\n\n   Start at  22:42:23\n\n   Duration  8.66s (transform 4.15s, setup 0ms, collect 7.97s, tests 6.72s, environment 9ms, prepare 13.53s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 131 }, "start": { "column": 3, "line": 131 } }
				},
				{
					"id": "107",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 28ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 41ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 90ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 45ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 27ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 44ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 184ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 146ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 14ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 23ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 724ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5542ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 526ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 27 passed (31)\n\n      Tests  4 failed | 505 passed (509)\n\n   Start at  22:42:23\n\n   Duration  9.07s (transform 5.59s, setup 0ms, collect 8.79s, tests 7.13s, environment 11ms, prepare 15.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 132 }, "start": { "column": 3, "line": 132 } }
				},
				{
					"id": "108",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 50ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 38ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 13ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 16ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 51ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 34ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 136ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 61ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 124ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 19ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 26ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 886ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 511ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5078ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  3 failed | 506 passed (509)\n\n   Start at  22:42:32\n\n   Duration  8.39s (transform 4.66s, setup 0ms, collect 7.60s, tests 6.99s, environment 38ms, prepare 14.28s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 133 }, "start": { "column": 3, "line": 133 } }
				},
				{
					"id": "109",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 88ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 71ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 20ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 60ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 29ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 17ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 158ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 46ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 76ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 262ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5057ms\n\n   × Theme Store > Store Structure > should have subscribe method 5034ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n      Tests  3 failed | 506 passed (509)\n   Start at  22:42:33\n   Duration  9.06s (transform 6.63s, setup 0ms, collect 10.55s, tests 6.27s, environment 15ms, prepare 14.41s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 134 }, "start": { "column": 3, "line": 134 } }
				},
				{
					"id": "110",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 103ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 73ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 92ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 32ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 176ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 44ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 230ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 68ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 90ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 33ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5112ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 989ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 447ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 15ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n\n      Tests  3 failed | 506 passed (509)\n\n   Start at  22:42:41\n\n   Duration  9.48s (transform 5.11s, setup 0ms, collect 8.35s, tests 7.34s, environment 26ms, prepare 15.59s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 135 }, "start": { "column": 3, "line": 135 } }
				},
				{
					"id": "111",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 55ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 25ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 49ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 128ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 28ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 79ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 76ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 26ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 19ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 894ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 359ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5362ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 329ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 32ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:42:42\n\n   Duration  9.59s (transform 6.02s, setup 0ms, collect 9.95s, tests 7.17s, environment 19ms, prepare 16.99s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 136 }, "start": { "column": 3, "line": 136 } }
				},
				{
					"id": "112",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 113ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 166ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 140ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 166ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 31ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 176ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 309ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 162ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 540ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3956ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3945ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 52ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 24ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:42:51\n\n   Duration  7.59s (transform 4.13s, setup 0ms, collect 6.32s, tests 6.11s, environment 11ms, prepare 11.83s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 137 }, "start": { "column": 3, "line": 137 } }
				},
				{
					"id": "113",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 98ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 94ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 105ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 58ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 169ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 22ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 272ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 15ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3672ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3661ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:42:54\n\n   Duration  7.19s (transform 3.63s, setup 0ms, collect 6.49s, tests 4.86s, environment 10ms, prepare 11.53s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 138 },
						"start": { "column": 3, "line": 138 }
					}
				},
				{
					"id": "114",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 326ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 42ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 25ms\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 2ms\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 46ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 29ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 60ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 142ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 103ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 62ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 59ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 27ms\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 16ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 762ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 359ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 26ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4710ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4691ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 18ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:44:47\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 28 passed (31)\n      Tests  5 failed | 504 passed (509)\n   Start at  22:43:00\n\n   Duration  9.13s (transform 4.11s, setup 0ms, collect 6.86s, tests 6.78s, environment 11ms, prepare 13.99s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 139 }, "start": { "column": 3, "line": 139 } }
				},
				{
					"id": "115",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 42ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 24ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 157ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 73ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 203ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 89ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 36ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 68ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 45ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 36ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 828ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 339ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 17ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6233ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1213ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n   Start at  22:43:01\n\n   Duration  9.85s (transform 7.55s, setup 0ms, collect 9.80s, tests 8.10s, environment 24ms, prepare 15.69s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 140 },
						"start": { "column": 3, "line": 140 }
					}
				},
				{
					"id": "116",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 23ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 46ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 27ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 36ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 109ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 24ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 44ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 121ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4053ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4038ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 762ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 375ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:43:09\n\n   Duration  7.98s (transform 4.91s, setup 0ms, collect 8.15s, tests 5.66s, environment 43ms, prepare 11.72s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 141 }, "start": { "column": 3, "line": 141 } }
				},
				{
					"id": "117",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 32ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 15ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 39ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 162ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 111ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 126ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 24ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 58ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 48ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 25ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 28ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 407ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4213ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4200ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n   Start at  22:43:12\n\n   Duration  7.68s (transform 5.20s, setup 0ms, collect 9.40s, tests 5.60s, environment 92ms, prepare 11.21s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 142 }, "start": { "column": 3, "line": 142 } }
				},
				{
					"id": "118",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 34ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 44ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 69ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 39ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 122ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 62ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 107ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 19ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 46ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 20ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 47ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 39ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 746ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 361ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 18ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4594ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4585ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n      Tests  2 failed | 507 passed (509)\n   Start at  22:43:18\n\n   Duration  8.64s (transform 5.80s, setup 0ms, collect 8.21s, tests 6.32s, environment 40ms, prepare 12.03s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 143 }, "start": { "column": 3, "line": 143 } }
				},
				{
					"id": "119",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 58ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 133ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 89ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 68ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 79ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 62ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 78ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 723ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 316ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3862ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3853ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 102ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 30 passed (31)\n\n      Tests  1 failed | 508 passed (509)\n\n   Start at  22:43:20\n\n   Duration  8.19s (transform 4.29s, setup 0ms, collect 6.78s, tests 5.59s, environment 17ms, prepare 13.13s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 144 }, "start": { "column": 3, "line": 144 } }
				},
				{
					"id": "120",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 73ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 46ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 39ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 38ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 28ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 611ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5228ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 29 passed (31)\n\n      Tests  2 failed | 507 passed (509)\n\n   Start at  22:43:26\n\n   Duration  8.77s (transform 6.58s, setup 0ms, collect 9.14s, tests 6.55s, environment 17ms, prepare 13.98s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 145 }, "start": { "column": 3, "line": 145 } }
				},
				{
					"id": "121",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 91ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 18ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 79ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 52ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 12ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 5ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 29ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 140ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 22ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 79ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 6ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 9ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 48ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 44ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 23ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 319ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3298ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3283ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 77ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 72ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 19ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  40 failed | 469 passed (509)\n\n   Start at  22:43:29\n\n   Duration  7.53s (transform 4.34s, setup 0ms, collect 7.02s, tests 4.63s, environment 8ms, prepare 11.07s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "123",
					"mutatorName": "LogicalOperator",
					"replacement": "filename.toLowerCase().split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 39ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 24ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 60ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 151ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 39ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 17ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 6ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 317ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 77ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 158ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 12ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 129ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 106ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 84ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 62ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4060ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4046ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 925ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 409ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 123ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 118ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  40 failed | 469 passed (509)\n   Start at  22:43:37\n\n   Duration  8.77s (transform 3.88s, setup 0ms, collect 6.97s, tests 6.48s, environment 8ms, prepare 13.21s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "122",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 45ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 55ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 24ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 4ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 78ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 17ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 8ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 3ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 60ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 68ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 40ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 7ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 27ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 15ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1015ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 440ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 47ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 32ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5214ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  41 failed | 468 passed (509)\n\n   Start at  22:43:37\n\n   Duration  8.87s (transform 4.99s, setup 0ms, collect 7.18s, tests 7.07s, environment 11ms, prepare 14.29s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "124",
					"mutatorName": "MethodExpression",
					"replacement": "filename.toUpperCase()",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 34ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 14ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 2ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 65ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 20ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 57ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 75ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 90ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 85ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 51ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 4ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 124ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 85ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5245ms\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1065ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 536ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 141ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 65ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 25 passed (31)\n\n      Tests  41 failed | 468 passed (509)\n\n   Start at  22:43:45\n\n   Duration  8.48s (transform 5.04s, setup 0ms, collect 8.06s, tests 7.42s, environment 25ms, prepare 13.67s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "125",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 124ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 117ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 39ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 20ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 2ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 168ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 108ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 13ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 5ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 3ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 27ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 198ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 157ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 5ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 10ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 3ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4328ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4308ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 35ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 62ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 50ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 302ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 109ms\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 43ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  40 failed | 469 passed (509)\n\n   Start at  22:43:47\n\n   Duration  7.94s (transform 4.94s, setup 0ms, collect 7.35s, tests 5.93s, environment 13ms, prepare 13.67s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 46, "line": 148 },
						"start": { "column": 43, "line": 148 }
					}
				},
				{
					"id": "127",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-is0cdV\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 35ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 32ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 3ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 53ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 12ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 2ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 7ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 90ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 40ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 41ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 57ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 36ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 12ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 4ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 71ms\n   × Security Utils > hasDangerousExtension > should detect .exe files 56ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 3ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3818ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3808ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 454ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 20ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 26 passed (31)\n\n      Tests  40 failed | 469 passed (509)\n   Start at  22:43:55\n   Duration  7.41s (transform 4.49s, setup 0ms, collect 7.90s, tests 5.23s, environment 12ms, prepare 13.50s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 149 },
						"start": { "column": 28, "line": 149 }
					}
				},
				{
					"id": "126",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 57, "line": 148 }
					}
				}
			],
			"source": "import type { Handle } from '@sveltejs/kit';\n\n/**\n * Security middleware for HTTP headers and request validation\n */\nexport const securityHeaders: Handle = async ({ event, resolve }) => {\n\tconst response = await resolve(event);\n\n\t// Security headers\n\tresponse.headers.set('X-Content-Type-Options', 'nosniff');\n\tresponse.headers.set('X-Frame-Options', 'DENY');\n\tresponse.headers.set('X-XSS-Protection', '1; mode=block');\n\tresponse.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n\tresponse.headers.set(\n\t\t'Permissions-Policy',\n\t\t'camera=(), microphone=(), geolocation=(), interest-cohort=()'\n\t);\n\n\t// Content Security Policy\n\tresponse.headers.set(\n\t\t'Content-Security-Policy',\n\t\t[\n\t\t\t\"default-src 'self'\",\n\t\t\t\"script-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"style-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"img-src 'self' data: blob:\",\n\t\t\t\"font-src 'self' data:\",\n\t\t\t\"connect-src 'self'\",\n\t\t\t\"frame-ancestors 'none'\",\n\t\t\t\"base-uri 'self'\",\n\t\t\t\"form-action 'self'\"\n\t\t].join('; ')\n\t);\n\n\t// HSTS (HTTP Strict Transport Security) - only in production with HTTPS\n\tif (event.url.protocol === 'https:') {\n\t\tresponse.headers.set('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');\n\t}\n\n\treturn response;\n};\n\n/**\n * Enforce HTTPS in production\n */\nexport const httpsRedirect: Handle = async ({ event, resolve }) => {\n\tconst proto = event.request.headers.get('x-forwarded-proto');\n\n\t// In production, redirect HTTP to HTTPS\n\tif (process.env.NODE_ENV === 'production' && proto === 'http') {\n\t\tconst httpsUrl = event.url.toString().replace('http://', 'https://');\n\t\treturn new Response(null, {\n\t\t\tstatus: 301,\n\t\t\theaders: {\n\t\t\t\tlocation: httpsUrl\n\t\t\t}\n\t\t});\n\t}\n\n\treturn resolve(event);\n};\n\n/**\n * Sanitize user input to prevent XSS\n */\nexport function sanitizeInput(input: string): string {\n\tlet sanitized = input;\n\n\t// Remove dangerous characters - loop to handle nested attempts\n\twhile (sanitized !== (sanitized = sanitized.replace(/[<>]/g, '')));\n\n\t// Remove javascript: protocol - loop to handle obfuscation like jajavascript:vascript:\n\twhile (sanitized !== (sanitized = sanitized.replace(/javascript:/gi, '')));\n\n\t// Remove all URL schemes that could be dangerous\n\tsanitized = sanitized.replace(/\\b(javascript|data|vbscript|about):/gi, '');\n\n\t// Remove event handlers - more comprehensive\n\tsanitized = sanitized.replace(/\\s*on\\w+\\s*=/gi, '');\n\n\treturn sanitized.trim();\n}\n\n/**\n * Validate filename for security\n */\nexport function sanitizeFilename(filename: string): string {\n\t// Remove path traversal attempts\n\tlet sanitized = filename.replace(/\\.\\./g, '');\n\n\t// Remove potentially dangerous characters\n\tsanitized = sanitized.replace(/[/\\\\]/g, '_');\n\n\t// Limit length\n\tif (sanitized.length > 255) {\n\t\tconst ext = sanitized.split('.').pop() || '';\n\t\tconst nameWithoutExt = sanitized.substring(0, 255 - ext.length - 1);\n\t\tsanitized = `${nameWithoutExt}.${ext}`;\n\t}\n\n\treturn sanitized || 'unnamed_file';\n}\n\n/**\n * Validate MIME type against whitelist\n */\nexport function isValidMimeType(mimeType: string, allowedTypes: string[]): boolean {\n\t// If no restrictions, allow all\n\tif (allowedTypes.length === 0) return true;\n\n\t// Exact match\n\tif (allowedTypes.includes(mimeType)) return true;\n\n\t// Wildcard match (e.g., image/*)\n\tconst category = mimeType.split('/')[0];\n\tif (allowedTypes.includes(`${category}/*`)) return true;\n\n\treturn false;\n}\n\n/**\n * Detect potentially dangerous file extensions\n */\nexport function hasDangerousExtension(filename: string): boolean {\n\tconst dangerous = [\n\t\t'.exe',\n\t\t'.bat',\n\t\t'.cmd',\n\t\t'.com',\n\t\t'.pif',\n\t\t'.scr',\n\t\t'.vbs',\n\t\t'.js',\n\t\t'.jse',\n\t\t'.wsf',\n\t\t'.wsh',\n\t\t'.ps1',\n\t\t'.psm1',\n\t\t'.sh',\n\t\t'.bash',\n\t\t'.csh',\n\t\t'.jar',\n\t\t'.app',\n\t\t'.deb',\n\t\t'.rpm'\n\t];\n\n\tconst ext = filename.toLowerCase().split('.').pop() || '';\n\treturn dangerous.includes(`.${ext}`);\n}\n"
		}
	},
	"schemaVersion": "1.0",
	"thresholds": { "high": 80, "low": 60, "break": 50 },
	"testFiles": { "": { "tests": [{ "id": "0", "name": "All tests" }] } },
	"projectRoot": "/Users/fred/Code/PrivaSend",
	"config": {
		"$schema": "./node_modules/@stryker-mutator/core/schema/stryker-schema.json",
		"packageManager": "npm",
		"testRunner": "command",
		"commandRunner": { "command": "npm test -- --run" },
		"checkers": [],
		"mutate": ["src/lib/server/security.ts"],
		"reporters": ["progress", "clear-text", "html", "json"],
		"htmlReporter": { "fileName": "mutation-report.html" },
		"jsonReporter": { "fileName": "mutation-report.json" },
		"coverageAnalysis": "off",
		"thresholds": { "high": 80, "low": 60, "break": 50 },
		"timeoutMS": 180000,
		"concurrency": 4,
		"ignorePatterns": ["dist", "build", ".svelte-kit", "node_modules", "coverage"],
		"allowConsoleColors": true,
		"checkerNodeArgs": [],
		"clearTextReporter": {
			"allowColor": true,
			"allowEmojis": false,
			"logTests": true,
			"maxTestsToLog": 3,
			"reportTests": true,
			"reportMutants": true,
			"reportScoreTable": true,
			"skipFull": false
		},
		"dashboard": {
			"baseUrl": "https://dashboard.stryker-mutator.io/api/reports",
			"reportType": "full"
		},
		"dryRunOnly": false,
		"eventReporter": { "baseDir": "reports/mutation/events" },
		"ignoreStatic": false,
		"incremental": false,
		"incrementalFile": "reports/stryker-incremental.json",
		"force": false,
		"fileLogLevel": "off",
		"inPlace": false,
		"logLevel": "info",
		"maxConcurrentTestRunners": 9007199254740991,
		"maxTestRunnerReuse": 0,
		"mutator": { "plugins": null, "excludedMutations": [] },
		"plugins": ["@stryker-mutator/*"],
		"appendPlugins": [],
		"disableTypeChecks": true,
		"symlinkNodeModules": true,
		"tempDirName": ".stryker-tmp",
		"cleanTempDir": true,
		"testRunnerNodeArgs": [],
		"timeoutFactor": 1.5,
		"dryRunTimeoutMinutes": 5,
		"tsconfigFile": "tsconfig.json",
		"warnings": true,
		"disableBail": false,
		"allowEmpty": false,
		"ignorers": [],
		"typescriptChecker": { "prioritizePerformanceOverAccuracy": true },
		"vitest": { "related": true }
	},
	"framework": {
		"name": "StrykerJS",
		"version": "9.4.0",
		"branding": {
			"homepageUrl": "https://stryker-mutator.io",
			"imageUrl": "data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"
		},
		"dependencies": { "@stryker-mutator/typescript-checker": "9.4.0", "typescript": "5.9.3" }
	}
}
