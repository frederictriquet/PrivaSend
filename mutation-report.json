{
	"files": {
		"src/lib/server/security.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "0",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 48ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 53ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 65ms\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 190ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 23ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 481ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 373ms\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Cannot read properties of undefined (reading 'headers')\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 204ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6508ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1445ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 62ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 141ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1614ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 908ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:13:20\n\n     11|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     12| \n     13|    expect(response.headers.get('X-Frame-Options')).toBe('DENY');\n       |                    ^\n     14|   });\n     15| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:22:20\n\n     20|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     21| \n     22|    expect(response.headers.get('X-Content-Type-Options')).toBe('nosnif…\n       |                    ^\n     23|   });\n     24| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:30:25\n     28| \n     29|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     30|    const csp = response.headers.get('Content-Security-Policy');\n       |                         ^\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:41:20\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                    ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:52:20\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                    ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  6 failed | 514 passed (520)\n   Start at  23:12:26\n   Duration  15.32s (transform 6.89s, setup 0ms, collect 10.96s, tests 9.64s, environment 31ms, prepare 27.19s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 41 }, "start": { "column": 70, "line": 6 } }
				},
				{
					"id": "2",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\nENOENT: no such file or directory, stat '/Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW/.svelte-kit/types/src/routes/proxy+page.server.ts'\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 60ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 90ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 37ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 36ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 35ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 40ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 472ms\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 84ms\n     → expected '' to be 'nosniff' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 48ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 34ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7854ms\n\n   × Theme Store > Store Structure > should have subscribe method 5168ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2664ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1700ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 886ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nAssertionError: expected '' to be 'nosniff' // Object.is equality\n\n\n- Expected\n+ Received\n\n- nosniff\n\n\n ❯ tests/unit/lib/security-headers.test.ts:22:59\n\n     20|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     21| \n     22|    expect(response.headers.get('X-Content-Type-Options')).toBe('nosnif…\n       |                                                           ^\n     23|   });\n     24| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n   Start at  23:12:26\n   Duration  15.33s (transform 7.98s, setup 0ms, collect 12.79s, tests 10.82s, environment 184ms, prepare 27.92s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 10 }, "start": { "column": 49, "line": 10 } }
				},
				{
					"id": "3",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 79ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 44ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 143ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 54ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 266ms\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 251ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 1ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 2ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 52ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 134ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 32ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7097ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2027ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1648ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 886ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n     67|     response.headers.set(stryMutAct_9fa48(\"7\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n     67|     response.headers.set(stryMutAct_9fa48(\"7\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n     67|     response.headers.set(stryMutAct_9fa48(\"7\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n     67|     response.headers.set(stryMutAct_9fa48(\"7\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n     67|     response.headers.set(stryMutAct_9fa48(\"7\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  6 failed | 514 passed (520)\n   Start at  23:12:26\n   Duration  15.35s (transform 9.25s, setup 0ms, collect 14.49s, tests 10.01s, environment 98ms, prepare 25.44s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 11 }, "start": { "column": 23, "line": 11 } }
				},
				{
					"id": "1",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 60ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 71ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 61ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 29ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 190ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 168ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 8ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 125ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 52ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7065ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2049ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1665ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 744ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"1\") ? \"\" : (stryCov_9fa48(\"…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"3\") ? \"\" : (stryCov_9fa48(\"…\n     66|     response.headers.set(stryMutAct_9fa48(\"5\") ? \"\" : (stryCov_9fa48(\"…\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n   Start at  23:12:26\n   Duration  15.53s (transform 9.46s, setup 0ms, collect 13.73s, tests 9.82s, environment 17ms, prepare 27.42s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 10 }, "start": { "column": 23, "line": 10 } }
				},
				{
					"id": "6",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 100ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 178ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 51ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 75ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 137ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 23ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 178ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 156ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6298ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1280ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 24ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1568ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1010ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 33ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n   Start at  23:12:45\n\n   Duration  13.69s (transform 7.04s, setup 0ms, collect 11.04s, tests 9.07s, environment 22ms, prepare 22.85s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 12 }, "start": { "column": 43, "line": 12 } }
				},
				{
					"id": "5",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 48ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 112ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 142ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 397ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 376ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 3ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7201ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2185ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 83ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1797ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 932ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n\n   Start at  23:12:45\n\n   Duration  13.82s (transform 8.48s, setup 0ms, collect 13.19s, tests 10.24s, environment 8ms, prepare 25.43s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 12 }, "start": { "column": 23, "line": 12 } }
				},
				{
					"id": "4",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 150ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 271ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 200ms\n\n     → expected '' to be 'DENY' // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 88ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 82ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 47ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 83ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7590ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2568ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1621ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 674ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nAssertionError: expected '' to be 'DENY' // Object.is equality\n\n- Expected\n+ Received\n\n- DENY\n\n ❯ tests/unit/lib/security-headers.test.ts:13:52\n\n     11|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     12| \n     13|    expect(response.headers.get('X-Frame-Options')).toBe('DENY');\n       |                                                    ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:12:45\n\n   Duration  13.90s (transform 8.83s, setup 0ms, collect 12.25s, tests 10.38s, environment 21ms, prepare 26.62s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 11 }, "start": { "column": 42, "line": 11 } }
				},
				{
					"id": "7",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 90ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 202ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 237ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 359ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 348ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 29ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 139ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6851ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1833ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1652ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 871ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n\n   Start at  23:12:45\n\n   Duration  14.03s (transform 7.61s, setup 0ms, collect 13.12s, tests 10.00s, environment 12ms, prepare 20.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 13 }, "start": { "column": 23, "line": 13 } }
				},
				{
					"id": "10",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 49ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 47ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 151ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 256ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 45ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 87ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 238ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 73ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 99ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7407ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2389ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1602ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 825ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:02\n\n   Duration  14.11s (transform 7.90s, setup 0ms, collect 13.96s, tests 10.29s, environment 18ms, prepare 21.82s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 16 }, "start": { "column": 3, "line": 16 } }
				},
				{
					"id": "9",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 166ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 45ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 119ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 335ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 199ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 120ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 7ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 213ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 48ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 238ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 17ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1554ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 808ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8076ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3060ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n\n   Start at  23:13:02\n\n   Duration  13.99s (transform 8.16s, setup 0ms, collect 14.66s, tests 11.03s, environment 10ms, prepare 23.39s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 15 }, "start": { "column": 3, "line": 15 } }
				},
				{
					"id": "8",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 207ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 183ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 239ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 398ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 77ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 24ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 140ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 29ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1444ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 830ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8544ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3527ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:02\n\n   Duration  14.63s (transform 10.15s, setup 0ms, collect 13.55s, tests 11.69s, environment 44ms, prepare 22.50s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 13 }, "start": { "column": 42, "line": 13 } }
				},
				{
					"id": "11",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 104ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 66ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 188ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 95ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 98ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 5 failed) 210ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 200ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 194ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 59ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 83ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 20ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7707ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2685ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 17ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1576ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 715ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n\n   Start at  23:13:03\n\n   Duration  13.43s (transform 8.78s, setup 0ms, collect 14.41s, tests 10.68s, environment 14ms, prepare 21.31s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 21 }, "start": { "column": 3, "line": 21 } }
				},
				{
					"id": "12",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 253ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 283ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 393ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 342ms\n\n     → expected '' to contain 'default-src \\'self\\''\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 25ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6924ms\n\n   × Theme Store > Store Structure > should have subscribe method 5048ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1859ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1843ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 890ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nAssertionError: expected '' to contain 'default-src \\'self\\''\n\n\n- Expected\n+ Received\n\n- default-src 'self'\n\n\n ❯ tests/unit/lib/security-headers.test.ts:32:16\n\n     30|    const csp = response.headers.get('Content-Security-Policy');\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n       |                ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:13:19\n\n   Duration  13.70s (transform 7.46s, setup 0ms, collect 12.98s, tests 10.28s, environment 11ms, prepare 22.78s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 32 }, "start": { "column": 3, "line": 22 } }
				},
				{
					"id": "13",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 32ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 166ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 28ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 114ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 418ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 12ms\n\n     → expected '; script-src \\'self\\' \\'unsafe-inline…' to contain 'default-src \\'self\\''\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 54ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 89ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6100ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1076ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 139ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1453ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 705ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nAssertionError: expected '; script-src \\'self\\' \\'unsafe-inline…' to contain 'default-src \\'self\\''\n\n\nExpected: \"default-src 'self'\"\nReceived: \"; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:32:16\n\n     30|    const csp = response.headers.get('Content-Security-Policy');\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n       |                ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:13:19\n   Duration  13.42s (transform 6.83s, setup 0ms, collect 12.03s, tests 9.04s, environment 35ms, prepare 23.62s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 23 }, "start": { "column": 4, "line": 23 } }
				},
				{
					"id": "14",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 374ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 210ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 259ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 27ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 252ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 104ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 39ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 22ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 139ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5483ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 460ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 152ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 112ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1572ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 808ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:19\n\n   Duration  13.93s (transform 7.82s, setup 0ms, collect 13.30s, tests 9.12s, environment 9ms, prepare 19.52s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 39, "line": 24 }, "start": { "column": 4, "line": 24 } }
				},
				{
					"id": "15",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 31ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 52ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 30ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 52ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 411ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 379ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 30ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 198ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 109ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 68ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6280ms\n   × Theme Store > Store Structure > should have subscribe method 5141ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1112ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 566ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 519 passed (520)\n   Start at  23:13:21\n   Duration  12.68s (transform 7.17s, setup 0ms, collect 13.12s, tests 8.07s, environment 12ms, prepare 21.27s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 38, "line": 25 }, "start": { "column": 4, "line": 25 } }
				},
				{
					"id": "17",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 20ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 202ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 403ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 36ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 70ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 273ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 29ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6789ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1767ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1346ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 514ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:36\n\n   Duration  12.29s (transform 7.79s, setup 0ms, collect 9.98s, tests 9.63s, environment 10ms, prepare 20.58s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 27 }, "start": { "column": 4, "line": 27 } }
				},
				{
					"id": "16",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 41ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 79ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 233ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 271ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 86ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 74ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 46ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7152ms\n\n   × Theme Store > Store Structure > should have subscribe method 5019ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2120ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1154ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 678ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:36\n\n   Duration  12.56s (transform 8.35s, setup 0ms, collect 11.08s, tests 9.60s, environment 12ms, prepare 21.26s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 32, "line": 26 }, "start": { "column": 4, "line": 26 } }
				},
				{
					"id": "18",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 138ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 241ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 22ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 111ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 345ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 99ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 177ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 26ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6934ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1918ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1493ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 709ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:37\n\n   Duration  12.32s (transform 7.71s, setup 0ms, collect 13.10s, tests 9.99s, environment 10ms, prepare 18.68s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 28 }, "start": { "column": 4, "line": 28 } }
				},
				{
					"id": "19",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 29 }, "start": { "column": 4, "line": 29 } }
				},
				{
					"id": "21",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 184ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 50ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 122ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 90ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 107ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 257ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 46ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 149ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5700ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 674ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 160ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1519ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 920ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n   Start at  23:13:53\n   Duration  12.30s (transform 6.20s, setup 0ms, collect 9.10s, tests 8.76s, environment 10ms, prepare 19.43s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 31 }, "start": { "column": 4, "line": 31 } }
				},
				{
					"id": "20",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 28ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 61ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 248ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 100ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 193ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 77ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 33ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 20ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 117ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 52ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1936ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 859ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6727ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1705ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 79ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 519 passed (520)\n   Start at  23:13:53\n   Duration  12.36s (transform 7.66s, setup 0ms, collect 11.37s, tests 10.08s, environment 15ms, prepare 18.44s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 30 }, "start": { "column": 4, "line": 30 } }
				},
				{
					"id": "22",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 158ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 108ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 243ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 328ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 62ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 133ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 155ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 144ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5431ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 397ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1747ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 919ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:13:54\n\n   Duration  11.95s (transform 6.11s, setup 0ms, collect 8.71s, tests 8.95s, environment 29ms, prepare 20.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 14, "line": 32 }, "start": { "column": 10, "line": 32 } }
				},
				{
					"id": "23",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 26ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 51ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 312ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 58ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 277ms\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 12ms\n     → expected 'max-age=31536000; includeSubDomains' to be null\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 54ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 73ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 22ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3058ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3011ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 451ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nAssertionError: expected 'max-age=31536000; includeSubDomains' to be null\n\n\n- Expected: \nnull\n\n+ Received: \n\"max-age=31536000; includeSubDomains\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:52:62\n\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                                                              ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:14:00\n\n   Duration  8.89s (transform 4.50s, setup 0ms, collect 9.11s, tests 4.77s, environment 11ms, prepare 14.51s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "24",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 35ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 31ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 137ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 52ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 67ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 51ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 211ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 12ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5687ms\n\n   × Theme Store > Store Structure > should have subscribe method 5015ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 597ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1672ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 826ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:10\n\n   Duration  11.03s (transform 6.91s, setup 0ms, collect 12.26s, tests 8.33s, environment 9ms, prepare 15.87s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "25",
					"mutatorName": "EqualityOperator",
					"replacement": "event.url.protocol !== 'https:'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 39ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 126ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 373ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 150ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 3ms\n     → expected 'max-age=31536000; includeSubDomains' to be null\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 157ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6334ms\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1313ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1561ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 776ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nAssertionError: expected 'max-age=31536000; includeSubDomains' to be null\n\n\n- Expected: \nnull\n\n+ Received: \n\"max-age=31536000; includeSubDomains\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:52:62\n\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                                                              ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n\n   Start at  23:14:10\n\n   Duration  12.24s (transform 9.57s, setup 0ms, collect 15.00s, tests 8.98s, environment 14ms, prepare 20.11s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "26",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 300ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 35ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 165ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 109ms\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 43ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 121ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 210ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 99ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6219ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1205ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1116ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 693ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 20ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 58ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:10\n\n   Duration  12.14s (transform 7.61s, setup 0ms, collect 12.20s, tests 8.73s, environment 15ms, prepare 19.39s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 29, "line": 36 } }
				},
				{
					"id": "27",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 52ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 206ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 290ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 28ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 18ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2847ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2835ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 424ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 519 passed (520)\n   Start at  23:14:17\n   Duration  8.50s (transform 4.29s, setup 0ms, collect 8.33s, tests 4.32s, environment 12ms, prepare 13.37s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 38 }, "start": { "column": 39, "line": 36 } }
				},
				{
					"id": "28",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 243ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 148ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 24ms\n\n     → Headers.set: \"\" is an invalid header name.\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 131ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 152ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5521ms\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 502ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1220ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 585ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 137ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 15ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:81:26\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:27\n\n   Duration  10.18s (transform 5.85s, setup 0ms, collect 9.30s, tests 8.01s, environment 15ms, prepare 14.54s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 51, "line": 37 }, "start": { "column": 24, "line": 37 } }
				},
				{
					"id": "29",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 29ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 34ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 223ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 403ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 362ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 9ms\n\n     → expected '' to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 184ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 181ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 17ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 20ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5614ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 597ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 171ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 824ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 502ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 33ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 16ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected '' to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected\n+ Received\n\n- max-age=31536000; includeSubDomains\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:27\n\n   Duration  11.39s (transform 5.77s, setup 0ms, collect 11.12s, tests 8.24s, environment 13ms, prepare 19.39s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 90, "line": 37 }, "start": { "column": 53, "line": 37 } }
				},
				{
					"id": "30",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 22ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 37ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 210ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 3 failed) 199ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 6ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 3ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 1ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 96ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 238ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 57ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 152ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6066ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1048ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1388ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 693ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:14:27\n\n   Duration  11.88s (transform 7.61s, setup 0ms, collect 9.61s, tests 8.72s, environment 17ms, prepare 18.18s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 61 }, "start": { "column": 68, "line": 46 } }
				},
				{
					"id": "31",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 61, "line": 47 }, "start": { "column": 42, "line": 47 } }
				},
				{
					"id": "32",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 53ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 110ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 238ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 59ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 3ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 31ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 82ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4837ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4825ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1277ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 639ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:43\n\n   Duration  9.76s (transform 5.28s, setup 0ms, collect 8.53s, tests 7.09s, environment 13ms, prepare 15.84s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "33",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 213ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 93ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 188ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 109ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5077ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 986ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 418ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:14:44\n\n   Duration  10.60s (transform 5.53s, setup 0ms, collect 9.69s, tests 7.06s, environment 14ms, prepare 16.51s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "34",
					"mutatorName": "LogicalOperator",
					"replacement": "process.env.NODE_ENV === 'production' || proto === 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 171ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 113ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 398ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 103ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 2ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 67ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 92ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 28ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 22ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 629ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 307ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5082ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 44ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 134ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\nAssertionError: expected \"spy\" to be called at least once\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n   Start at  23:14:45\n   Duration  10.60s (transform 7.86s, setup 0ms, collect 11.36s, tests 7.21s, environment 9ms, prepare 18.60s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "35",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 20ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 103ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 207ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 14ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 29ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 56ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 267ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2397ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2375ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:14:54\n\n   Duration  5.84s (transform 3.25s, setup 0ms, collect 5.50s, tests 3.54s, environment 9ms, prepare 9.34s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "36",
					"mutatorName": "EqualityOperator",
					"replacement": "process.env.NODE_ENV !== 'production'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 114ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 378ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 41ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 88ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 78ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6119ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1104ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1015ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 537ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 39ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n\n   Start at  23:14:59\n\n   Duration  10.07s (transform 5.32s, setup 0ms, collect 7.80s, tests 8.25s, environment 10ms, prepare 15.97s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "37",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 31ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 20ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 64ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 26ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 59ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 342ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 116ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 45ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 48ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 101ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 24ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 62ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 185ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 41ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 135ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5634ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 620ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 786ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 352ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:15:00\n\n   Duration  10.35s (transform 5.48s, setup 0ms, collect 9.07s, tests 7.94s, environment 10ms, prepare 15.20s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 31, "line": 50 } }
				},
				{
					"id": "38",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 36ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 66ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 403ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 306ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 333ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 23ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 23ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4856ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4839ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 39ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 628ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:15:01\n\n   Duration  9.81s (transform 6.10s, setup 0ms, collect 9.08s, tests 6.85s, environment 26ms, prepare 17.26s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "39",
					"mutatorName": "EqualityOperator",
					"replacement": "proto !== 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 82ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 58ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 101ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 59ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 46ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 198ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 7ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 9ms\n     → expected \"spy\" to be called at least once\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 83ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 131ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 354ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2667ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2654ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 18ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:15:12\n\n   Duration  5.94s (transform 3.45s, setup 0ms, collect 4.98s, tests 4.23s, environment 8ms, prepare 9.29s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "40",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 119ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 38ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 52ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 56ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 148ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 51ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 42ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 33ms\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5037ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1215ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 615ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 130ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 57ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:15:16\n\n   Duration  10.00s (transform 5.18s, setup 0ms, collect 7.77s, tests 7.34s, environment 31ms, prepare 15.00s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 57, "line": 50 } }
				},
				{
					"id": "41",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 75ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 461ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 381ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 72ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 320ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 157ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5653ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 637ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1073ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 544ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:15:17\n\n   Duration  9.89s (transform 6.00s, setup 0ms, collect 10.19s, tests 8.24s, environment 17ms, prepare 15.24s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 58 }, "start": { "column": 65, "line": 50 } }
				},
				{
					"id": "42",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 222ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 62ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 618ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 498ms\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 80ms\n     → expected 'https://http://example.com/path' to be 'https://example.com/path' // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 153ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 138ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 53ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 288ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4798ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4781ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 'https://http://example.com/path' to be 'https://example.com/path' // Object.is equality\n\nExpected: \"https://example.com/path\"\nReceived: \"https://http://example.com/path\"\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:15:19\n\n   Duration  9.65s (transform 6.29s, setup 0ms, collect 10.08s, tests 6.79s, environment 101ms, prepare 13.67s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 51 }, "start": { "column": 49, "line": 51 } }
				},
				{
					"id": "43",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 52ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 46ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 47ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 38ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 38ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 114ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 66ms\n\n     → expected 'example.com/path' to be 'https://example.com/path' // Object.is equality\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 33ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 26ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 308ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 19ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2786ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2773ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 'example.com/path' to be 'https://example.com/path' // Object.is equality\n\n\nExpected: \"https://example.com/path\"\nReceived: \"example.com/path\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:15:29\n\n   Duration  5.09s (transform 2.71s, setup 0ms, collect 4.51s, tests 3.92s, environment 19ms, prepare 7.00s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 70, "line": 51 }, "start": { "column": 60, "line": 51 } }
				},
				{
					"id": "44",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 94ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 41ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 44ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 35ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 52ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 184ms\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 13ms\n     → expected 200 to be 301 // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3904ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3893ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 260ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 219ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1076ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 437ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 200 to be 301 // Object.is equality\n\n- Expected\n+ Received\n\n- 301\n+ 200\n\n\n ❯ tests/unit/lib/security-headers.test.ts:69:28\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                            ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:15:33\n\n   Duration  9.71s (transform 5.97s, setup 0ms, collect 11.03s, tests 6.32s, environment 12ms, prepare 15.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 57 }, "start": { "column": 29, "line": 52 } }
				},
				{
					"id": "45",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 98ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 82ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 234ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 37ms\n\n     → expected null to be 'https://example.com/path' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 30ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 22ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4816ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4807ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 954ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 492ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\nAssertionError: expected null to be 'https://example.com/path' // Object.is equality\n\n- Expected: \n\"https://example.com/path\"\n\n+ Received: \nnull\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:15:33\n   Duration  9.71s (transform 6.04s, setup 0ms, collect 9.67s, tests 6.70s, environment 9ms, prepare 14.00s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 5, "line": 56 }, "start": { "column": 13, "line": 54 } }
				},
				{
					"id": "46",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 152ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 73ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 10ms\n     → expected undefined to be '' // Object.is equality\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n     → expected undefined to be 'test' // Object.is equality\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 2ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 1ms\n\n     → Cannot read properties of undefined (reading 'trim')\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 9 failed) 68ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 9ms\n\n     → expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected undefined to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 0ms\n\n     → expected undefined to be 'Hello World' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle empty string 0ms\n\n     → expected undefined to be '' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 440ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 389ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 79ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 174ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 55ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 36ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3538ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3520ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 465ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 27ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 20ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected undefined to be '' // Object.is equality\n\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/15]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nTypeError: Cannot read properties of undefined (reading 'trim')\n\n ❯ tests/unit/lib/security-complete.test.ts:55:18\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                  ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/15]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n- Expected: \n\"scriptalert(\\\"xss\\\")/script\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected undefined to be 'testtest' // Object.is equality\n\n\n- Expected: \n\"testtest\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/15]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected undefined to be 'Hello World' // Object.is equality\n\n\n- Expected: \n\"Hello World\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle empty string\n\nAssertionError: expected undefined to be '' // Object.is equality\n\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:43:30\n\n     41| \n     42|   it('should handle empty string', () => {\n     43|    expect(sanitizeInput('')).toBe('');\n       |                              ^\n     44|   });\n     45| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/15]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/15]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  15 failed | 505 passed (520)\n\n   Start at  23:15:37\n\n   Duration  8.92s (transform 5.21s, setup 0ms, collect 10.78s, tests 5.40s, environment 11ms, prepare 12.37s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 82 }, "start": { "column": 54, "line": 66 } }
				},
				{
					"id": "47",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 64ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 31ms\n\n     → expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n     → expected 'test<>test' to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 5ms\n\n     → expected '<script>alert(\"xss\")</script>' not to contain '<'\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 42ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 14ms\n\n     → expected '<' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 8ms\n\n     → expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 64ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 36ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 54ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 214ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 89ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 39ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 38ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 94ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1112ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 690ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4114ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4092ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<script>alert(1)</script>\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected 'test<>test' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"test<>test\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\nAssertionError: expected '<script>alert(\"xss\")</script>' not to contain '<'\n\nExpected: \"<\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:15:45\n\n   Duration  7.04s (transform 4.05s, setup 0ms, collect 5.36s, tests 6.32s, environment 8ms, prepare 11.14s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "49",
					"mutatorName": "Regex",
					"replacement": "/[^<>]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 41ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 54ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 77ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 10ms\n\n     → expected '<' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 4ms\n\n     → expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 8 failed) 87ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 12ms\n\n     → expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected '<>' to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 6ms\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 2ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 6ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 1ms\n\n     → expected '' to be 'Hello World' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 1ms\n\n     → expected '<><>' not to contain '<'\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 178ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 260ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 134ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 96ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 22ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5038ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1016ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 508ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 16ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 221ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 14 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/14]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected '<>' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"<>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected '' to be 'Hello World' // Object.is equality\n\n- Expected\n+ Received\n\n- Hello World\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected '<><>' not to contain '<'\n\n\nExpected: \"<\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/14]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/14]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  14 failed | 506 passed (520)\n\n   Start at  23:15:49\n\n   Duration  10.54s (transform 6.04s, setup 0ms, collect 9.56s, tests 7.60s, environment 13ms, prepare 17.22s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 61, "line": 70 }, "start": { "column": 54, "line": 70 } }
				},
				{
					"id": "50",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 112ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 74ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 67ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 40ms\n     → expected 'Stryker was here!' to be '' // Object.is equality\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 4ms\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 158ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 22ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 55ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 19ms\n\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 123ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3543ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3528ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 111ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 484ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected 'Stryker was here!' to be '' // Object.is equality\n\n- Expected\n+ Received\n\n+ Stryker was here!\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(1)Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(\"xss\")Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\nExpected: \"testtest\"\nReceived: \"testStryker was here!Stryker was here!test\"\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:15:54\n\n   Duration  8.40s (transform 4.69s, setup 0ms, collect 8.11s, tests 5.15s, environment 11ms, prepare 13.42s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 70 }, "start": { "column": 63, "line": 70 } }
				},
				{
					"id": "51",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 11ms\n     → expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 57ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 24ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 9ms\n     → expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 109ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 22ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 24ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 663ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 321ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4433ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4424ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptjavascript:alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n\n\nExpected: \"javascript:\"\nReceived: \"scriptjavascript:alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:51:23\n\n     49|    expect(result).not.toContain('<');\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n       |                       ^\n     52|    expect(result).not.toContain('onclick=');\n     53|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:16:03\n\n   Duration  7.37s (transform 4.34s, setup 0ms, collect 6.72s, tests 5.80s, environment 25ms, prepare 11.88s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "53",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 32ms\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 15ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 2ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 24ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 3 failed) 35ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 11ms\n\n     → expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected 'Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 1ms\n\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 188ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 71ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 95ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 518ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4750ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4737ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"Stryker was here!Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected 'Stryker was here!test' to be 'test' // Object.is equality\n\nExpected: \"test\"\nReceived: \"Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:16:11\n\n   Duration  8.81s (transform 5.74s, setup 0ms, collect 8.96s, tests 6.17s, environment 136ms, prepare 13.40s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 73, "line": 73 }, "start": { "column": 71, "line": 73 } }
				},
				{
					"id": "54",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 75, "line": 76 }, "start": { "column": 73, "line": 76 } }
				},
				{
					"id": "55",
					"mutatorName": "Regex",
					"replacement": "/\\son\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 37ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 14ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 45ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 19ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 4ms\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 79ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 211ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 163ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 36ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 27ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2758ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2746ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 353ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:16:26\n\n   Duration  6.10s (transform 3.27s, setup 0ms, collect 6.26s, tests 4.13s, environment 10ms, prepare 9.98s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "56",
					"mutatorName": "Regex",
					"replacement": "/\\S*on\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 57ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 60ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 40ms\n\n     → expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 121ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 133ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 64ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 129ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3622ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3611ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 555ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 519 passed (520)\n   Start at  23:16:31\n   Duration  7.26s (transform 4.99s, setup 0ms, collect 7.65s, tests 5.19s, environment 8ms, prepare 10.63s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "57",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 44ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 45ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 13ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 5ms\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 22ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 9ms\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 113ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 43ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2992ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2980ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 519ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:16:39\n\n   Duration  6.21s (transform 3.39s, setup 0ms, collect 6.68s, tests 4.24s, environment 11ms, prepare 9.46s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "58",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\W+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 29ms\n   × Security Extended Tests > sanitizeInput > should remove event handlers 14ms\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 129ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 36ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 15ms\n     → expected 'onclick=alert()' not to contain 'onclick='\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 2ms\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 246ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 49ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2942ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2933ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 380ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  4 failed | 516 passed (520)\n   Start at  23:16:45\n   Duration  6.60s (transform 3.50s, setup 0ms, collect 6.33s, tests 4.31s, environment 9ms, prepare 9.87s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "59",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\s=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 37ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 68ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 70ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 84ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 52ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 9ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 141ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 95ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 44ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 6ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 147ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 62ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 151ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3062ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3050ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 361ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:16:52\n\n   Duration  6.39s (transform 3.50s, setup 0ms, collect 5.98s, tests 4.68s, environment 10ms, prepare 9.71s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "60",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\S*=/gi",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "61",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 71ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 45ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 20ms\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 43ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 29ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 103ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 43ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2772ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2748ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 308ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:17:06\n   Duration  5.96s (transform 3.49s, setup 0ms, collect 5.39s, tests 3.88s, environment 65ms, prepare 9.32s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 79 }, "start": { "column": 50, "line": 79 } }
				},
				{
					"id": "62",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 36ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 13ms\n\n     → expected '   test   ' to be 'test' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 22ms\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 9ms\n\n     → expected '  test  ' to be 'test' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 70ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 19ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 63ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 122ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 35ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 179ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3094ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3078ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 23ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 522ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 303ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '   test   ' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"   test   \"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected '  test  ' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"  test  \"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:17:12\n\n   Duration  6.57s (transform 3.97s, setup 0ms, collect 6.15s, tests 4.43s, environment 8ms, prepare 10.29s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 81 }, "start": { "column": 9, "line": 81 } }
				},
				{
					"id": "63",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 65ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 37ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 11ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected undefined to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected undefined to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected undefined to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 26ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 63ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 25ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 6ms\n\n     → expected undefined to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected undefined to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 0ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 4ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 8ms\n\n     → expected undefined to be '_' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 3 failed) 233ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 10ms\n     → Cannot read properties of undefined (reading 'length')\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 4ms\n\n     → expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 1ms\n     → expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 81ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 60ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 52ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 6 failed) 201ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 8ms\n\n     → expected undefined to be 'document.pdf' // Object.is equality\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts 148ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal 3ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 2ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 95ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 75ms\n     → expected undefined to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected undefined to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 312ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 32ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 17ms\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected undefined to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 2ms\n     → expected undefined to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n     → expected undefined to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 7ms\n     → expected undefined to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n     → expected undefined to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 0ms\n     → Cannot read properties of undefined (reading 'length')\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3232ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3217ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 13ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 95ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 46ms\n     → expected undefined to be 'test.txt' // Object.is equality\n   × Security - Real Import Tests > sanitizeFilename > should remove path traversal 46ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 35 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected undefined to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/35]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected undefined to be 'file.txt' // Object.is equality\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/35]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-behavior.test.ts:38:18\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\nAssertionError: expected undefined to be 'a_b_c_d' // Object.is equality\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected undefined to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-complete.test.ts:79:18\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                  ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-complete.test.ts:85:18\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/35]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected undefined to be '_' // Object.is equality\n\n- Expected: \n\"_\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-comprehensive.test.ts:13:23\n     11|   it('should remove path traversal attempts', () => {\n     12|    const result = sanitizeFilename('../../../etc/passwd');\n     13|    expect(result).not.toContain('..');\n       |                       ^\n     14|   });\n     15| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-comprehensive.test.ts:18:23\n     16|   it('should handle nested path traversal', () => {\n     17|    const result = sanitizeFilename('../../.../../evil');\n     18|    expect(result).not.toContain('..');\n       |                       ^\n     19|   });\n     20| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/35]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-comprehensive.test.ts:33:23\n     31|   it('should handle multiple dangerous chars', () => {\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n       |                       ^\n     34|    expect(result).not.toContain('/');\n     35|    expect(result).not.toContain('\\\\');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/35]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-extended.test.ts:60:18\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/35]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected undefined to be 'file.tar.gz' // Object.is equality\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/35]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\nAssertionError: expected undefined to be '文件.pdf' // Object.is equality\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/35]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\nAssertionError: expected undefined to be 'my file.txt' // Object.is equality\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/35]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-headers.test.ts:115:18\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/35]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\nAssertionError: expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/35]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\nAssertionError: expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/35]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected undefined to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/35]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should remove path traversal\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-real-import.test.ts:14:23\n     12|   it('should remove path traversal', () => {\n     13|    const result = sanitizeFilename('../../../etc/passwd');\n     14|    expect(result).not.toContain('..');\n       |                       ^\n     15|   });\n     16|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:12:52\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:24:45\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security.test.ts:30:18\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/35]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:34:33\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/35]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n      Tests  35 failed | 485 passed (520)\n   Start at  23:17:19\n   Duration  7.96s (transform 3.93s, setup 0ms, collect 6.09s, tests 5.01s, environment 17ms, prepare 9.78s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 102 }, "start": { "column": 60, "line": 87 } }
				},
				{
					"id": "64",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 46ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 23ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 4ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 43ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 41ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 60ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 58ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 25ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 31ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 11ms\n\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2915ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2906ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 465ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 16ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 11ms\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  5 failed | 515 passed (520)\n   Start at  23:17:27\n   Duration  5.88s (transform 3.09s, setup 0ms, collect 5.59s, tests 4.11s, environment 25ms, prepare 9.38s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 46, "line": 89 }, "start": { "column": 44, "line": 89 } }
				},
				{
					"id": "65",
					"mutatorName": "Regex",
					"replacement": "/[^/\\\\]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 82ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 20ms\n\n     → expected '___' to be 'abc' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 3ms\n\n     → expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 6ms\n\n     → expected '______' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 4ms\n\n     → expected 279 to be less than or equal to 255\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected '/' to be '_' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 55ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 67ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 79ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 23ms\n\n     → expected 305 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 6ms\n\n     → expected '___________' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n     → expected '______' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected '___________' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 104ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 3 failed) 346ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 8ms\n\n     → expected 261 to be less than or equal to 255\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 37ms\n\n     → expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 49ms\n     → expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 146ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 81ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 106ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 65ms\n     → expected '____________' to be 'document.pdf' // Object.is equality\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 2ms\n\n     → expected '____/__/________' not to contain '/'\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 1ms\n\n     → expected '__\\_______\\________' not to contain '\\'\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 1ms\n\n     → expected '/____\\__///____' not to contain '/'\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 95ms\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 12ms\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected '____________' to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n     → expected 305 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 448ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 309ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3257ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3242ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 17ms\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 13ms\n     → expected '________' to be 'test.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 6 failed) 37ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 28ms\n     → expected '_/_' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n     → expected '_\\_' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n     → expected '///' to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n     → expected '________' to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n     → expected 305 to be less than or equal to 255\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 28 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected '_/_' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"_/_\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected '_\\_' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"_\\_\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/28]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected '///' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"///\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected '________' to be 'file.txt' // Object.is equality\n\n\nExpected: \"file.txt\"\nReceived: \"________\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/28]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 305 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/28]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '___' to be 'abc' // Object.is equality\n\n\nExpected: \"abc\"\nReceived: \"___\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:63:40\n\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n       |                                        ^\n     64|   });\n     65| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/28]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"_/_/_/_\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected '______' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"______\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/28]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 279 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/28]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '/' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"/\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/28]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/28]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\n\nAssertionError: expected '____/__/________' not to contain '/'\n\n\nExpected: \"/\"\nReceived: \"____/__/________\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/28]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\n\nAssertionError: expected '__\\_______\\________' not to contain '\\'\n\n\nExpected: \"\\\"\nReceived: \"__\\_______\\________\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/28]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\n\nAssertionError: expected '/____\\__///____' not to contain '/'\n\n\nExpected: \"/\"\nReceived: \"/____\\__///____\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:34:23\n\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n     34|    expect(result).not.toContain('/');\n       |                       ^\n     35|    expect(result).not.toContain('\\\\');\n     36|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 305 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected '___________' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"___________\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/28]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '______' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"______\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/28]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected '___________' to be 'my file.txt' // Object.is equality\n\n\nExpected: \"my file.txt\"\nReceived: \"___________\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/28]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/28]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/28]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"_______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/28]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected '________' to be 'test.txt' // Object.is equality\n\n\nExpected: \"test.txt\"\nReceived: \"________\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"____/__/________\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"____\\__\\________\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 305 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/28]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n      Tests  28 failed | 492 passed (520)\n   Start at  23:17:33\n   Duration  7.21s (transform 4.43s, setup 0ms, collect 7.71s, tests 5.28s, environment 10ms, prepare 10.58s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 92 }, "start": { "column": 32, "line": 92 } }
				},
				{
					"id": "66",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 47ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 26ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 10ms\n     → expected 'abcd' to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 44ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 152ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 211ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 46ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 39ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 72ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 34ms\n\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 21ms\n\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3022ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3006ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 386ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 4 failed) 41ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 27ms\n     → expected 'ab' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 5ms\n     → expected 'ab' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected 'unnamed_file' to be '___' // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 14ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 9 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/9]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/9]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\nAssertionError: expected 'abcd' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"abcd\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/9]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/9]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/9]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  9 failed | 511 passed (520)\n\n   Start at  23:17:41\n\n   Duration  6.05s (transform 3.39s, setup 0ms, collect 6.00s, tests 4.46s, environment 14ms, prepare 9.15s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 92 }, "start": { "column": 42, "line": 92 } }
				},
				{
					"id": "67",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 36ms\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 18ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 3ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 47ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 52ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 13ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n\n     → expected 255 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected '_._' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 105ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 40ms\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 63ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 19ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 85ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 60ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 12ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 2ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 7 failed) 60ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 51ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected '___.___' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 433ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 16ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 12ms\n\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3073ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3061ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 23 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/23]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/23]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/23]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/23]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/23]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 255 to be 254 // Object.is equality\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/23]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '_._' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"_._\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/23]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/23]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/23]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/23]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/23]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa..txt\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/23]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/23]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/23]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/23]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/23]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/23]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/23]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  23 failed | 497 passed (520)\n\n   Start at  23:17:47\n\n   Duration  5.98s (transform 3.63s, setup 0ms, collect 5.83s, tests 4.39s, environment 10ms, prepare 9.07s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "68",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 36ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 15ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 57ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 35ms\n     → expected 278 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 31ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 106ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 67ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 11ms\n     → expected 260 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 40ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 31ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 22ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 81ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 90ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 8ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3533ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3522ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 29ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 16ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 456ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nAssertionError: expected 278 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\nAssertionError: expected 260 to be less than or equal to 255\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  5 failed | 515 passed (520)\n   Start at  23:17:53\n   Duration  7.07s (transform 4.17s, setup 0ms, collect 7.96s, tests 4.99s, environment 22ms, prepare 10.34s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "69",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length >= 255",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "70",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length <= 255",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 54ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 88ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 67ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 19ms\n\n     → expected 304 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 5ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 83ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 35ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 14ms\n     → expected 255 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n     → expected 278 to be less than or equal to 255\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected '_._' to be '_' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 52ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 147ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 225ms\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 17ms\n     → expected 260 to be less than or equal to 255\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 4ms\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 21ms\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 12ms\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 35ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 18ms\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 5ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n\n     → expected 304 to be less than or equal to 255\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 3ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 301ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3053ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3042ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 20ms\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 8ms\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 53ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 12ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected '___.___' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 28 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/28]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\nAssertionError: expected 255 to be 254 // Object.is equality\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nAssertionError: expected 278 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/28]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected '_._' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"_._\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/28]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/28]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/28]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\nAssertionError: expected 260 to be less than or equal to 255\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/28]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa..txt\"\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/28]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/28]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n ❯ tests/unit/lib/security.test.ts:12:52\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/28]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/28]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/28]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n ❯ tests/unit/lib/security.test.ts:24:45\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/28]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\nAssertionError: expected 304 to be less than or equal to 255\n ❯ tests/unit/lib/security.test.ts:30:26\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/28]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n ❯ tests/unit/lib/security.test.ts:34:33\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/28]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  28 failed | 492 passed (520)\n\n   Start at  23:18:06\n\n   Duration  6.78s (transform 3.86s, setup 0ms, collect 6.26s, tests 4.58s, environment 12ms, prepare 9.60s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "71",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 26ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 9ms\n\n     → expected 278 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 74ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 28ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 12ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 47ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 68ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 234ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 10ms\n\n     → expected 260 to be less than or equal to 255\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 26ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 53ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 70ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 52ms\n\n     → expected 304 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 362ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 40ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 33ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3367ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3353ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 260 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:18:13\n\n   Duration  6.72s (transform 3.37s, setup 0ms, collect 5.79s, tests 4.77s, environment 10ms, prepare 10.63s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 99 }, "start": { "column": 30, "line": 95 } }
				},
				{
					"id": "72",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 32ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 15ms\n\n     → expected '.true' to contain '.txt'\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 61ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 86ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 63ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 26ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 29ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2775ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2761ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 67ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 57ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 475ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected '.true' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \".true\"\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:18:20\n   Duration  6.14s (transform 3.39s, setup 0ms, collect 6.11s, tests 4.06s, environment 11ms, prepare 9.39s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "73",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 9ms\n\n     → expected '.false' to contain '.txt'\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 84ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 189ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 48ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 330ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 16ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3047ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3035ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\nAssertionError: expected '.false' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \".false\"\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:18:27\n\n   Duration  5.91s (transform 3.08s, setup 0ms, collect 5.26s, tests 4.21s, environment 9ms, prepare 9.31s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "74",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized.split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 167ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 60ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 45ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 60ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 39ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 207ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 82ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 56ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 31ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 39ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 24ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3573ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3557ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 18ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 12ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 575ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:18:32\n\n   Duration  7.12s (transform 4.55s, setup 0ms, collect 7.62s, tests 5.33s, environment 12ms, prepare 10.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "75",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 34ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 21ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 91ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 47ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2206ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2195ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 27ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 26ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 488ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 27ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.t\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:18:40\n\n   Duration  5.56s (transform 2.77s, setup 0ms, collect 4.79s, tests 3.45s, environment 17ms, prepare 8.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 34, "line": 96 }, "start": { "column": 31, "line": 96 } }
				},
				{
					"id": "48",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/[<>]/g, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "76",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 45, "line": 96 } }
				},
				{
					"id": "77",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 21ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 33ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 14ms\n\n     → expected 296 to be less than or equal to 255\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 131ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 263ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 131ms\n\n     → expected 264 to be less than or equal to 255\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 35ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 20ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 50ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 39ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 26ms\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3756ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3744ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 110ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 148ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 142ms\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 938ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 565ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 296 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 264 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:18:52\n\n   Duration  7.35s (transform 4.16s, setup 0ms, collect 6.93s, tests 5.94s, environment 17ms, prepare 12.17s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 70, "line": 97 }, "start": { "column": 26, "line": 97 } }
				},
				{
					"id": "78",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 - ext.length + 1",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 84ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 199ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 45ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 15ms\n\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 51ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 19ms\n     → expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 222ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 13ms\n\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 47ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 99ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 26ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 16ms\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 65ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 55ms\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4344ms\n   ✓ Theme Store > Store Structure > should have subscribe method 4318ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 872ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 442ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:18:54\n\n   Duration  8.91s (transform 5.25s, setup 0ms, collect 8.85s, tests 6.44s, environment 17ms, prepare 13.91s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 69, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "52",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/javascript:/gi, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "79",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 + ext.length",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 29ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 48ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 36ms\n\n     → expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 33ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 15ms\n\n     → expected 289 to be less than or equal to 255\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 111ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 1 failed) 236ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 81ms\n\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 24ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 8ms\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 400ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 22ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 15ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 7ms\n\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3138ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3123ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 289 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:19:00\n\n   Duration  6.60s (transform 3.66s, setup 0ms, collect 6.49s, tests 4.49s, environment 23ms, prepare 9.93s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "80",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 40ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 54ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 23ms\n\n     → expected 'unnamed_file' to contain '.txt'\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 76ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 94ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 86ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3502ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3491ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 746ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 412ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 217ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 210ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:19:07\n\n   Duration  7.18s (transform 3.28s, setup 0ms, collect 5.59s, tests 5.31s, environment 9ms, prepare 11.66s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 98 }, "start": { "column": 15, "line": 98 } }
				},
				{
					"id": "81",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 39ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 12ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected true to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected true to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n\n     → expected undefined to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected true to be '_' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 29ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 9ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected true to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected true to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected true to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 138ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 22ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 3 failed) 266ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 13ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 59ms\n\n     → expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 1ms\n\n     → expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 28ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 10ms\n     → expected true to be 'document.pdf' // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 30ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 11ms\n\n     → expected true to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 3ms\n\n     → expected true to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected true to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected true to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 4ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 697ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 335ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4370ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4349ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 30ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 11ms\n     → expected true to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected true to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 2ms\n\n     → expected true to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 9ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 2ms\n     → expected true to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 40ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 10ms\n     → expected true to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 29 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected true to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected true to be 'file.txt' // Object.is equality\n\n- Expected: \n\"file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nTypeError: actual value must be number or bigint, received \"undefined\"\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/29]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/29]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected true to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected true to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/29]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\nAssertionError: expected undefined to be 254 // Object.is equality\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected true to be '_' // Object.is equality\n\n- Expected: \n\"_\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/29]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/29]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected true to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected true to be '文件.pdf' // Object.is equality\n\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected true to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/29]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/29]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\nAssertionError: expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/29]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/29]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected true to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/29]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  29 failed | 491 passed (520)\n   Start at  23:19:09\n\n   Duration  9.03s (transform 4.50s, setup 0ms, collect 7.36s, tests 6.13s, environment 55ms, prepare 13.59s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "82",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 49ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 8ms\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected false to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected false to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n\n     → expected undefined to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 4ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n\n     → expected false to be '_' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 112ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 75ms\n   × Security Extended Tests > filename edge cases > should handle very long filenames 46ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n     → expected false to be 'file.tar.gz' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle unicode characters 2ms\n     → expected false to be '文件.pdf' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n     → expected false to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 121ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 3 failed) 308ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 11ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 94ms\n\n     → expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 1ms\n\n     → expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 33ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 18ms\n     → expected false to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 82ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 42ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 11ms\n     → expected false to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 9ms\n     → expected false to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected false to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 3ms\n     → expected false to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 9ms\n\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 2ms\n     → expected false to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 584ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 346ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 21ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 12ms\n     → expected false to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n     → expected false to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected false to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected false to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected false to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 2ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected false to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4848ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4835ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 87ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 10ms\n     → expected false to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 29 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected false to be '___' // Object.is equality\n\n- Expected: \n\"___\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/29]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected false to be 'file.txt' // Object.is equality\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/29]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected false to be 'a_b_c_d' // Object.is equality\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected false to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/29]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\nAssertionError: expected undefined to be 254 // Object.is equality\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/29]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected false to be '_' // Object.is equality\n\n- Expected: \n\"_\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/29]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/29]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected false to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected false to be '文件.pdf' // Object.is equality\n\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/29]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected false to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/29]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/29]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\nAssertionError: expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/29]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\nAssertionError: expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/29]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected false to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security.test.ts:16:49\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/29]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/29]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/29]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  29 failed | 491 passed (520)\n\n   Start at  23:19:13\n\n   Duration  9.07s (transform 4.58s, setup 0ms, collect 7.41s, tests 6.80s, environment 12ms, prepare 15.26s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "83",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized && 'unnamed_file'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 33ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 9ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 4ms\n\n     → expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'unnamed_file' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n\n     → expected 12 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 45ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 18ms\n\n     → expected 'unnamed_file' to contain '.txt'\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 4ms\n\n     → expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 6ms\n\n     → expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 3ms\n\n     → expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 117ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-headers.test.ts (11 tests | 2 failed) 226ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 33ms\n\n     → expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 3ms\n\n     → expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 29ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 16ms\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 33ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 17ms\n\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 2ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3229ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3219ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 351ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 21ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 11ms\n     → expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 27ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 14ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 4ms\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n     → expected 'unnamed_file' to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n     → expected 'unnamed_file' to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 26 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/26]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'unnamed_file' to be 'file.txt' // Object.is equality\n\nExpected: \"file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/26]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected 'unnamed_file' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 12 to be 254 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 254\n+ 12\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/26]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/26]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/26]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\nExpected: \"文件.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/26]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/26]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/26]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/26]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\nExpected: \"test.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/26]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/26]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/26]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  26 failed | 494 passed (520)\n\n   Start at  23:19:16\n\n   Duration  7.73s (transform 3.92s, setup 0ms, collect 7.25s, tests 4.58s, environment 11ms, prepare 11.43s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "84",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 56ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 41ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 62ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 26ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 9ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 64ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 83ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 39ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 65ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 22ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 59ms\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 43ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3909ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3891ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 719ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 440ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 68ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 38ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 4ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:19:23\n\n   Duration  7.54s (transform 4.08s, setup 0ms, collect 6.80s, tests 5.61s, environment 9ms, prepare 11.45s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 22, "line": 101 }
					}
				},
				{
					"id": "85",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 126ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 77ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 104ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 76ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 13ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected undefined to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 7 failed) 138ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 98ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 3ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 8ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 229ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 181ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 49ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 29ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 97ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 36ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 182ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 23ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 8ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > isValidMimeType > should validate exact match 2ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 143ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 102ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 1ms\n     → expected undefined to be false // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n     → expected undefined to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 62ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3609ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3598ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 593ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 22ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 14ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 22 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/22]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/22]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/22]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/22]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/22]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  22 failed | 498 passed (520)\n\n   Start at  23:19:25\n\n   Duration  7.98s (transform 3.62s, setup 0ms, collect 7.39s, tests 5.88s, environment 25ms, prepare 12.78s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 119 },
						"start": { "column": 84, "line": 107 }
					}
				},
				{
					"id": "86",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 55ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 9ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 67ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 55ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 19ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 36ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 47ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 10ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 178ms\n\n   × Security Utils > isValidMimeType > should validate exact match 65ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 2ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 101ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4370ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4360ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 765ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 431ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 80ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 507 passed (520)\n\n   Start at  23:19:31\n\n   Duration  8.44s (transform 4.61s, setup 0ms, collect 8.66s, tests 6.14s, environment 18ms, prepare 13.46s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "87",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 103ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 224ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 83ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 63ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 11ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 128ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 407ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 356ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 48ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 28ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 19ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 39ms\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 26ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 408ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 70ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 34ms\n     → expected false to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 2ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4780ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4756ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:66:51\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  6 failed | 514 passed (520)\n   Start at  23:19:33\n   Duration  8.24s (transform 5.21s, setup 0ms, collect 6.82s, tests 6.71s, environment 14ms, prepare 11.53s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "88",
					"mutatorName": "EqualityOperator",
					"replacement": "allowedTypes.length !== 0",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 44ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 3ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 2ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 77ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 41ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 15ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 209ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 143ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 31ms\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 15ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 2ms\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 20ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate exact match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 119ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 751ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 401ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4661ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4647ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 21ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 12ms\n     → expected false to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 18 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/18]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/18]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/18]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/18]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/18]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/18]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/18]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/18]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/18]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/18]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/18]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/18]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/18]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/18]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  18 failed | 502 passed (520)\n\n   Start at  23:19:40\n\n   Duration  8.48s (transform 5.14s, setup 0ms, collect 7.53s, tests 6.54s, environment 8ms, prepare 11.80s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "89",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 85ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 31ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 18ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 57ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 276ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 62ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 51ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 86ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 64ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 89ms\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 10ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4276ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4264ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 194ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 185ms\n\n     → expected false to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1007ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 498ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n\n   Start at  23:19:42\n\n   Duration  8.73s (transform 4.07s, setup 0ms, collect 8.45s, tests 6.69s, environment 15ms, prepare 15.00s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 109 },
						"start": { "column": 40, "line": 109 }
					}
				},
				{
					"id": "90",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 32ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 12ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 4ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 31ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 11ms\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 41ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 90ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 53ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 156ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 146ms\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 170ms\n\n   × Security Utils > isValidMimeType > should validate exact match 159ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 524ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 347ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3739ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3728ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 53ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 507 passed (520)\n\n   Start at  23:19:48\n\n   Duration  7.79s (transform 4.52s, setup 0ms, collect 6.79s, tests 5.32s, environment 9ms, prepare 11.66s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "91",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 99ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 51ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 18ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 3ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 18ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 131ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 200ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 181ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 44ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 77ms\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 53ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 5ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 137ms\n\n   × Security Utils > isValidMimeType > should validate exact match 9ms\n\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 9ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 392ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3636ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3624ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  7 failed | 513 passed (520)\n\n   Start at  23:19:51\n\n   Duration  7.08s (transform 4.23s, setup 0ms, collect 5.93s, tests 5.19s, environment 82ms, prepare 11.14s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "92",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 36ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 45ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 20ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 55ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 33ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 80ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 197ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 28ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 207ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 195ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 60ms\n\n   × Security Utils > isValidMimeType > should validate exact match 28ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3357ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3346ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 507ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 14ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 31ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 13ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  7 failed | 513 passed (520)\n\n   Start at  23:19:57\n\n   Duration  7.13s (transform 3.02s, setup 0ms, collect 5.81s, tests 5.03s, environment 9ms, prepare 13.00s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 50, "line": 112 },
						"start": { "column": 46, "line": 112 }
					}
				},
				{
					"id": "93",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 42ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 17ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 82ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 65ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 173ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 59ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 162ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 45ms\n   × Security Utils > isValidMimeType > should validate wildcard match 8ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 24ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3868ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3858ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 454ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 15ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:19:59\n\n   Duration  8.13s (transform 4.98s, setup 0ms, collect 8.38s, tests 5.36s, environment 9ms, prepare 11.74s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 115 },
						"start": { "column": 34, "line": 115 }
					}
				},
				{
					"id": "94",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 49ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 24ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 86ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 61ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 5ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 108ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 134ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 17ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 49ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 22ms\n\n   × Security Utils > isValidMimeType > should validate exact match 11ms\n\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 38ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 26ms\n\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 624ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 446ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 15ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4695ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4685ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 126ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 507 passed (520)\n\n   Start at  23:20:05\n\n   Duration  8.14s (transform 4.63s, setup 0ms, collect 7.31s, tests 6.40s, environment 13ms, prepare 11.51s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "95",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 35ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 55ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 49ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 42ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 22ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 57ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 35ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 127ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 151ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 45ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 51ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 37ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 57ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 42ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 5ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 24ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 21ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3763ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3753ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 606ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 348ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 37ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:20:08\n\n   Duration  7.41s (transform 4.87s, setup 0ms, collect 7.08s, tests 5.49s, environment 10ms, prepare 13.32s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "96",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 10ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 82ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 30ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 38ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 23ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 147ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 24ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 52ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 174ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 30ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 81ms\n   × Security Utils > isValidMimeType > should validate wildcard match 68ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4871ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4858ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 574ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 23ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:20:14\n\n   Duration  9.47s (transform 5.34s, setup 0ms, collect 7.49s, tests 6.58s, environment 20ms, prepare 14.93s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 43, "line": 116 },
						"start": { "column": 28, "line": 116 }
					}
				},
				{
					"id": "97",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 41ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 19ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 46ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 22ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 50ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 68ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 48ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 338ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 32ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 58ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 48ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 45ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 60ms\n   × Security Utils > isValidMimeType > should validate wildcard match 42ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 374ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5499ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 475ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:83:51\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  6 failed | 514 passed (520)\n   Start at  23:20:15\n   Duration  9.13s (transform 5.07s, setup 0ms, collect 7.93s, tests 7.07s, environment 18ms, prepare 15.33s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 57, "line": 116 },
						"start": { "column": 53, "line": 116 }
					}
				},
				{
					"id": "98",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 57ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 46ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 10ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 57ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 13ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 104ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 47ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 105ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 184ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 21ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 107ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 31ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 65ms\n\n   × Security Utils > isValidMimeType > should validate exact match 51ms\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 559ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 318ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4804ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4791ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 507 passed (520)\n   Start at  23:20:23\n\n   Duration  7.72s (transform 5.00s, setup 0ms, collect 7.55s, tests 6.41s, environment 20ms, prepare 11.89s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 14, "line": 118 },
						"start": { "column": 9, "line": 118 }
					}
				},
				{
					"id": "99",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 7 failed) 35ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 18ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe image formats 1ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe document formats 1ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats 1ms\n     → expected undefined to be false // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 21 failed) 58ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 13ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 2ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 5ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected undefined to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension 0ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 32ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 53ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 120ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 132ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 263ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 50ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 13 failed) 84ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 7ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 60ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 0ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions 1ms\n     → expected undefined to be false // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension 1ms\n     → expected undefined to be false // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 29ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 14ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should allow .pdf files 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should allow .jpg files 1ms\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 3ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 18ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 321ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3538ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3527ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 18ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 8ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Real Import Tests > hasDangerousExtension > should allow .txt 3ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 49 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/49]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:177:49\n    175| \n    176|   it('should handle no extension', () => {\n    177|    expect(hasDangerousExtension('noextension')).toBe(false);\n       |                                                 ^\n    178|   });\n    179|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:85:50\n     83| \n     84|   it('should allow safe extensions', () => {\n     85|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     86|    expect(hasDangerousExtension('image.png')).toBe(false);\n     87|    expect(hasDangerousExtension('data.json')).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:91:44\n     89| \n     90|   it('should handle files without extension', () => {\n     91|    expect(hasDangerousExtension('README')).toBe(false);\n       |                                            ^\n     92|   });\n     93| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/49]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe image formats\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:94:47\n     92|   it('should allow safe image formats', () => {\n     93|    // Function already imported\n     94|    expect(hasDangerousExtension('photo.png')).toBe(false);\n       |                                               ^\n     95|    expect(hasDangerousExtension('image.gif')).toBe(false);\n     96|    expect(hasDangerousExtension('pic.webp')).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe document formats\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:101:51\n     99|   it('should allow safe document formats', () => {\n    100|    // Function already imported\n    101|    expect(hasDangerousExtension('document.docx')).toBe(false);\n       |                                                   ^\n    102|    expect(hasDangerousExtension('sheet.xlsx')).toBe(false);\n    103|    expect(hasDangerousExtension('presentation.pptx')).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:108:48\n    106|   it('should allow safe archive formats', () => {\n    107|    // Function already imported\n    108|    expect(hasDangerousExtension('archive.7z')).toBe(false);\n       |                                                ^\n    109|    expect(hasDangerousExtension('files.rar')).toBe(false);\n    110|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/49]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/49]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/49]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should allow .txt\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:38:19\n     36|   it('should allow .txt', () => {\n     37|    const result = hasDangerousExtension('safe.txt');\n     38|    expect(result).toBe(false);\n       |                   ^\n     39|   });\n     40|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:48:48\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .pdf files\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:52:50\n     50| \n     51|   it('should allow .pdf files', () => {\n     52|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     53|   });\n     54| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/49]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .jpg files\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:56:47\n     54| \n     55|   it('should allow .jpg files', () => {\n     56|    expect(hasDangerousExtension('photo.jpg')).toBe(false);\n       |                                               ^\n     57|   });\n     58| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/49]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/49]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  49 failed | 471 passed (520)\n   Start at  23:20:26\n\n   Duration  7.36s (transform 3.97s, setup 0ms, collect 6.07s, tests 5.14s, environment 9ms, prepare 11.71s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 150 },
						"start": { "column": 66, "line": 124 }
					}
				},
				{
					"id": "100",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 43ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 37ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 19ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 114ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 82ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 26ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 5ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 4ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 8ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 3ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 3ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 79ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 64ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 53ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 85ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 27ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 296ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 205ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 56ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 27ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 10ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 764ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 324ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 74ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 64ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4745ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4732ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:48:48\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  40 failed | 480 passed (520)\n\n   Start at  23:20:32\n\n   Duration  8.30s (transform 4.02s, setup 0ms, collect 6.08s, tests 6.84s, environment 10ms, prepare 12.63s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 146 },
						"start": { "column": 20, "line": 125 }
					}
				},
				{
					"id": "101",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 11ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 37ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 5ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 83ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 140ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 36ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 55ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 72ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 71ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 134ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 83ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 19ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 79ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 66ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 593ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 313ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 17ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 12ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4415ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4402ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 10 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/10]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/10]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/10]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/10]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/10]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/10]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/10]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/10]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/10]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/10]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  10 failed | 510 passed (520)\n\n   Start at  23:20:33\n\n   Duration  8.36s (transform 5.06s, setup 0ms, collect 8.26s, tests 6.20s, environment 15ms, prepare 11.96s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 126 }, "start": { "column": 3, "line": 126 } }
				},
				{
					"id": "102",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 32ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 30ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 47ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 41ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 77ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 59ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 141ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 60ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 22ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 9ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 53ms\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 44ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 399ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3762ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3750ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:20:40\n\n   Duration  7.26s (transform 3.73s, setup 0ms, collect 6.04s, tests 5.06s, environment 16ms, prepare 11.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 127 }, "start": { "column": 3, "line": 127 } }
				},
				{
					"id": "103",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 61ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 107ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 36ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 81ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 110ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 67ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2898ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2885ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 26ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 12ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 32ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 19ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 335ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n\n   Start at  23:20:42\n\n   Duration  7.56s (transform 3.87s, setup 0ms, collect 7.08s, tests 4.17s, environment 38ms, prepare 10.79s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 128 }, "start": { "column": 3, "line": 128 } }
				},
				{
					"id": "104",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 31ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 13ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 37ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 14ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 63ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 214ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 228ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 125ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 10ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 833ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 450ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5082ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 516 passed (520)\n\n   Start at  23:20:49\n\n   Duration  9.78s (transform 6.96s, setup 0ms, collect 10.22s, tests 7.05s, environment 12ms, prepare 14.34s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 129 }, "start": { "column": 3, "line": 129 } }
				},
				{
					"id": "105",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 192ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 28ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 17ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 44ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 33ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 229ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 22ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 21ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 18ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 736ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 332ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4810ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4793ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 132ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:20:49\n\n   Duration  9.29s (transform 4.99s, setup 0ms, collect 9.87s, tests 6.69s, environment 9ms, prepare 13.20s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 130 }, "start": { "column": 3, "line": 130 } }
				},
				{
					"id": "106",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 50ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 19ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 35ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 18ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 129ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 47ms\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 162ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 37ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 24ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 607ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 315ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3332ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3321ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n\n   Start at  23:20:58\n\n   Duration  7.16s (transform 3.55s, setup 0ms, collect 6.00s, tests 4.87s, environment 9ms, prepare 11.32s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 131 }, "start": { "column": 3, "line": 131 } }
				},
				{
					"id": "107",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 67ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 50ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 39ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 15ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 155ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 294ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 54ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 26ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2735ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2720ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 336ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 16ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 517 passed (520)\n\n   Start at  23:21:01\n\n   Duration  6.75s (transform 2.99s, setup 0ms, collect 6.34s, tests 4.23s, environment 10ms, prepare 8.97s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 132 }, "start": { "column": 3, "line": 132 } }
				},
				{
					"id": "109",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 37ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 133ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 105ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 165ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 135ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 151ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 216ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 26ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3498ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3479ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 871ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 436ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:21:07\n\n   Duration  8.57s (transform 4.45s, setup 0ms, collect 6.99s, tests 5.57s, environment 14ms, prepare 14.56s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 134 }, "start": { "column": 3, "line": 134 } }
				},
				{
					"id": "108",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 50ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 34ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 67ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 45ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 98ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 72ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 213ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 160ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3751ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3739ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 926ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 448ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:21:07\n   Duration  8.47s (transform 5.22s, setup 0ms, collect 9.64s, tests 5.77s, environment 25ms, prepare 14.06s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 133 }, "start": { "column": 3, "line": 133 } }
				},
				{
					"id": "110",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 48ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 53ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 34ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 84ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 27ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 254ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 208ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 19ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4302ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4288ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 758ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:21:15\n\n   Duration  7.60s (transform 4.88s, setup 0ms, collect 6.99s, tests 6.05s, environment 22ms, prepare 11.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 135 }, "start": { "column": 3, "line": 135 } }
				},
				{
					"id": "111",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 55ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 95ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 290ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 43ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 320ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3910ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3899ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:21:17\n\n   Duration  7.82s (transform 5.48s, setup 0ms, collect 8.94s, tests 5.22s, environment 13ms, prepare 11.39s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 136 }, "start": { "column": 3, "line": 136 } }
				},
				{
					"id": "112",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 53ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 62ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 23ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 56ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 17ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 170ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 19ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3900ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3882ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 585ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 340ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 132ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 11ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 518 passed (520)\n   Start at  23:21:24\n   Duration  7.89s (transform 3.75s, setup 0ms, collect 6.68s, tests 5.48s, environment 9ms, prepare 13.66s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 137 }, "start": { "column": 3, "line": 137 } }
				},
				{
					"id": "113",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 26ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 12ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 89ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 242ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 86ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 661ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 323ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4444ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4433ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:21:24\n\n   Duration  8.47s (transform 4.61s, setup 0ms, collect 7.10s, tests 6.03s, environment 10ms, prepare 12.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 138 },
						"start": { "column": 3, "line": 138 }
					}
				},
				{
					"id": "114",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 25ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 2ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 33ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 13ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 60ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 78ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 99ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 18ms\n   × Security Utils > hasDangerousExtension > should detect .sh files 8ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3010ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2997ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 818ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 472ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 515 passed (520)\n\n   Start at  23:21:32\n\n   Duration  6.61s (transform 3.21s, setup 0ms, collect 5.69s, tests 4.60s, environment 11ms, prepare 10.49s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 139 }, "start": { "column": 3, "line": 139 } }
				},
				{
					"id": "115",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 38ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 32ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 144ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 146ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 52ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 134ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 22ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 19ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 415ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 25ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4032ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4015ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:21:33\n\n   Duration  7.86s (transform 4.82s, setup 0ms, collect 7.45s, tests 5.48s, environment 15ms, prepare 11.82s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 140 },
						"start": { "column": 3, "line": 140 }
					}
				},
				{
					"id": "116",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 49ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 38ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 142ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 195ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 31ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3878ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3867ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 707ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 334ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:21:40\n\n   Duration  8.37s (transform 4.53s, setup 0ms, collect 8.16s, tests 5.49s, environment 28ms, prepare 13.59s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 141 }, "start": { "column": 3, "line": 141 } }
				},
				{
					"id": "117",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 55ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 130ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 63ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 25ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 69ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 25ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 13ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 624ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4054ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4016ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:21:40\n\n   Duration  8.28s (transform 4.35s, setup 0ms, collect 7.56s, tests 5.50s, environment 9ms, prepare 12.72s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 142 }, "start": { "column": 3, "line": 142 } }
				},
				{
					"id": "118",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 44ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 73ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 46ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 132ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 48ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 194ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 45ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 53ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 33ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n ✓ tests/unit/lib/auth.test.ts (11 tests) 683ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 327ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 24ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4340ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4326ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 518 passed (520)\n\n   Start at  23:21:48\n\n   Duration  7.55s (transform 4.44s, setup 0ms, collect 6.22s, tests 6.06s, environment 45ms, prepare 10.78s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 143 }, "start": { "column": 3, "line": 143 } }
				},
				{
					"id": "119",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 28ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 13ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 52ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 72ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 131ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 257ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 22ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3136ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3124ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 432ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 519 passed (520)\n\n   Start at  23:21:49\n\n   Duration  7.32s (transform 3.85s, setup 0ms, collect 6.06s, tests 4.44s, environment 11ms, prepare 11.90s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 144 }, "start": { "column": 3, "line": 144 } }
				},
				{
					"id": "120",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 89ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 41ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 21ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 49ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 40ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 153ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 343ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 300ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 593ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4672ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4627ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 519 passed (520)\n   Start at  23:21:56\n   Duration  8.41s (transform 5.18s, setup 0ms, collect 7.91s, tests 6.43s, environment 21ms, prepare 14.90s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 145 }, "start": { "column": 3, "line": 145 } }
				},
				{
					"id": "121",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 94ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 20ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 31ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 122ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 87ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 67ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 114ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 157ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 94ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 68ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 109ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 81ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3983ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3972ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 18ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 207ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 198ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 741ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 377ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:44:47\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:48:48\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  40 failed | 480 passed (520)\n   Start at  23:21:57\n\n   Duration  8.22s (transform 4.60s, setup 0ms, collect 6.86s, tests 6.13s, environment 11ms, prepare 13.62s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "122",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 43ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 26ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 10ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 4ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 55ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 18ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 7ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 6ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 229ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 204ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 26ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 14ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 220ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 138ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 57ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 22ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 883ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 351ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 16ms\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 9ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4634ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4619ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  40 failed | 480 passed (520)\n\n   Start at  23:22:05\n\n   Duration  7.19s (transform 3.77s, setup 0ms, collect 4.88s, tests 6.65s, environment 17ms, prepare 11.33s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "123",
					"mutatorName": "LogicalOperator",
					"replacement": "filename.toLowerCase().split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 71ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 123ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 43ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 18ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 2ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 54ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 23ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 3ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 184ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 237ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 100ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 32ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 80ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 37ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 15ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 124ms\n   × Security Utils > hasDangerousExtension > should detect .exe files 104ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 9ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4071ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4057ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 467ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 39ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 18ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  40 failed | 480 passed (520)\n\n   Start at  23:22:06\n\n   Duration  7.83s (transform 3.95s, setup 0ms, collect 6.96s, tests 6.00s, environment 12ms, prepare 10.97s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "125",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 46ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 17ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 8ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 3ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 46ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 47ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 16ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 4ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 0ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 168ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 40ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 124ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 128ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 140ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 61ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 19ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 36ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 96ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 72ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 25ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 707ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 384ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4329ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4316ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 108ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 99ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:44:47\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  40 failed | 480 passed (520)\n\n   Start at  23:22:13\n\n   Duration  8.19s (transform 5.14s, setup 0ms, collect 7.44s, tests 6.45s, environment 10ms, prepare 13.01s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 46, "line": 148 },
						"start": { "column": 43, "line": 148 }
					}
				},
				{
					"id": "124",
					"mutatorName": "MethodExpression",
					"replacement": "filename.toUpperCase()",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 26ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 46ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 22ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 134ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 49ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 66ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 159ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 16ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 76ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 22ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 12ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 166ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 192ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 60ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 97ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 6ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 9ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 136ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 94ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 23ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 123ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 785ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 560ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 21ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 13ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4602ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4590ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:44:47\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:48:48\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  40 failed | 480 passed (520)\n   Start at  23:22:13\n   Duration  8.21s (transform 4.67s, setup 0ms, collect 7.01s, tests 6.91s, environment 17ms, prepare 13.16s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "126",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 57, "line": 148 }
					}
				},
				{
					"id": "127",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-YinFAW\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 101ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 26ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 26ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 6ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 2ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 56ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 89ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 36ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 3ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 98ms\n\n ✓ tests/unit/lib/security-headers.test.ts (11 tests) 55ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 101ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 32ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 161ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 10ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 134ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 18ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 111ms\n   × Security Utils > hasDangerousExtension > should detect .exe files 58ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 8ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 17ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 4ms\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 352ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 26ms\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 15ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4330ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4316ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  40 failed | 480 passed (520)\n\n   Start at  23:22:23\n\n   Duration  7.33s (transform 4.67s, setup 0ms, collect 6.39s, tests 5.96s, environment 27ms, prepare 11.82s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 149 },
						"start": { "column": 28, "line": 149 }
					}
				}
			],
			"source": "import type { Handle } from '@sveltejs/kit';\n\n/**\n * Security middleware for HTTP headers and request validation\n */\nexport const securityHeaders: Handle = async ({ event, resolve }) => {\n\tconst response = await resolve(event);\n\n\t// Security headers\n\tresponse.headers.set('X-Content-Type-Options', 'nosniff');\n\tresponse.headers.set('X-Frame-Options', 'DENY');\n\tresponse.headers.set('X-XSS-Protection', '1; mode=block');\n\tresponse.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n\tresponse.headers.set(\n\t\t'Permissions-Policy',\n\t\t'camera=(), microphone=(), geolocation=(), interest-cohort=()'\n\t);\n\n\t// Content Security Policy\n\tresponse.headers.set(\n\t\t'Content-Security-Policy',\n\t\t[\n\t\t\t\"default-src 'self'\",\n\t\t\t\"script-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"style-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"img-src 'self' data: blob:\",\n\t\t\t\"font-src 'self' data:\",\n\t\t\t\"connect-src 'self'\",\n\t\t\t\"frame-ancestors 'none'\",\n\t\t\t\"base-uri 'self'\",\n\t\t\t\"form-action 'self'\"\n\t\t].join('; ')\n\t);\n\n\t// HSTS (HTTP Strict Transport Security) - only in production with HTTPS\n\tif (event.url.protocol === 'https:') {\n\t\tresponse.headers.set('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');\n\t}\n\n\treturn response;\n};\n\n/**\n * Enforce HTTPS in production\n */\nexport const httpsRedirect: Handle = async ({ event, resolve }) => {\n\tconst proto = event.request.headers.get('x-forwarded-proto');\n\n\t// In production, redirect HTTP to HTTPS\n\tif (process.env.NODE_ENV === 'production' && proto === 'http') {\n\t\tconst httpsUrl = event.url.toString().replace('http://', 'https://');\n\t\treturn new Response(null, {\n\t\t\tstatus: 301,\n\t\t\theaders: {\n\t\t\t\tlocation: httpsUrl\n\t\t\t}\n\t\t});\n\t}\n\n\treturn resolve(event);\n};\n\n/**\n * Sanitize user input to prevent XSS\n */\nexport function sanitizeInput(input: string): string {\n\tlet sanitized = input;\n\n\t// Remove dangerous characters - loop to handle nested attempts\n\twhile (sanitized !== (sanitized = sanitized.replace(/[<>]/g, '')));\n\n\t// Remove javascript: protocol - loop to handle obfuscation like jajavascript:vascript:\n\twhile (sanitized !== (sanitized = sanitized.replace(/javascript:/gi, '')));\n\n\t// Remove all URL schemes that could be dangerous\n\tsanitized = sanitized.replace(/\\b(javascript|data|vbscript|about):/gi, '');\n\n\t// Remove event handlers - more comprehensive\n\tsanitized = sanitized.replace(/\\s*on\\w+\\s*=/gi, '');\n\n\treturn sanitized.trim();\n}\n\n/**\n * Validate filename for security\n */\nexport function sanitizeFilename(filename: string): string {\n\t// Remove path traversal attempts\n\tlet sanitized = filename.replace(/\\.\\./g, '');\n\n\t// Remove potentially dangerous characters\n\tsanitized = sanitized.replace(/[/\\\\]/g, '_');\n\n\t// Limit length\n\tif (sanitized.length > 255) {\n\t\tconst ext = sanitized.split('.').pop() || '';\n\t\tconst nameWithoutExt = sanitized.substring(0, 255 - ext.length - 1);\n\t\tsanitized = `${nameWithoutExt}.${ext}`;\n\t}\n\n\treturn sanitized || 'unnamed_file';\n}\n\n/**\n * Validate MIME type against whitelist\n */\nexport function isValidMimeType(mimeType: string, allowedTypes: string[]): boolean {\n\t// If no restrictions, allow all\n\tif (allowedTypes.length === 0) return true;\n\n\t// Exact match\n\tif (allowedTypes.includes(mimeType)) return true;\n\n\t// Wildcard match (e.g., image/*)\n\tconst category = mimeType.split('/')[0];\n\tif (allowedTypes.includes(`${category}/*`)) return true;\n\n\treturn false;\n}\n\n/**\n * Detect potentially dangerous file extensions\n */\nexport function hasDangerousExtension(filename: string): boolean {\n\tconst dangerous = [\n\t\t'.exe',\n\t\t'.bat',\n\t\t'.cmd',\n\t\t'.com',\n\t\t'.pif',\n\t\t'.scr',\n\t\t'.vbs',\n\t\t'.js',\n\t\t'.jse',\n\t\t'.wsf',\n\t\t'.wsh',\n\t\t'.ps1',\n\t\t'.psm1',\n\t\t'.sh',\n\t\t'.bash',\n\t\t'.csh',\n\t\t'.jar',\n\t\t'.app',\n\t\t'.deb',\n\t\t'.rpm'\n\t];\n\n\tconst ext = filename.toLowerCase().split('.').pop() || '';\n\treturn dangerous.includes(`.${ext}`);\n}\n"
		}
	},
	"schemaVersion": "1.0",
	"thresholds": { "high": 80, "low": 60, "break": 50 },
	"testFiles": { "": { "tests": [{ "id": "0", "name": "All tests" }] } },
	"projectRoot": "/Users/fred/Code/PrivaSend",
	"config": {
		"$schema": "./node_modules/@stryker-mutator/core/schema/stryker-schema.json",
		"packageManager": "npm",
		"testRunner": "command",
		"commandRunner": { "command": "npm test -- --run" },
		"checkers": [],
		"mutate": ["src/lib/server/security.ts"],
		"reporters": ["progress", "clear-text", "html", "json"],
		"htmlReporter": { "fileName": "mutation-report.html" },
		"jsonReporter": { "fileName": "mutation-report.json" },
		"coverageAnalysis": "off",
		"thresholds": { "high": 80, "low": 60, "break": 50 },
		"timeoutMS": 180000,
		"concurrency": 4,
		"ignorePatterns": ["dist", "build", ".svelte-kit", "node_modules", "coverage"],
		"allowConsoleColors": true,
		"checkerNodeArgs": [],
		"clearTextReporter": {
			"allowColor": true,
			"allowEmojis": false,
			"logTests": true,
			"maxTestsToLog": 3,
			"reportTests": true,
			"reportMutants": true,
			"reportScoreTable": true,
			"skipFull": false
		},
		"dashboard": {
			"baseUrl": "https://dashboard.stryker-mutator.io/api/reports",
			"reportType": "full"
		},
		"dryRunOnly": false,
		"eventReporter": { "baseDir": "reports/mutation/events" },
		"ignoreStatic": false,
		"incremental": false,
		"incrementalFile": "reports/stryker-incremental.json",
		"force": false,
		"fileLogLevel": "off",
		"inPlace": false,
		"logLevel": "info",
		"maxConcurrentTestRunners": 9007199254740991,
		"maxTestRunnerReuse": 0,
		"mutator": { "plugins": null, "excludedMutations": [] },
		"plugins": ["@stryker-mutator/*"],
		"appendPlugins": [],
		"disableTypeChecks": true,
		"symlinkNodeModules": true,
		"tempDirName": ".stryker-tmp",
		"cleanTempDir": true,
		"testRunnerNodeArgs": [],
		"timeoutFactor": 1.5,
		"dryRunTimeoutMinutes": 5,
		"tsconfigFile": "tsconfig.json",
		"warnings": true,
		"disableBail": false,
		"allowEmpty": false,
		"ignorers": [],
		"typescriptChecker": { "prioritizePerformanceOverAccuracy": true },
		"vitest": { "related": true }
	},
	"framework": {
		"name": "StrykerJS",
		"version": "9.4.0",
		"branding": {
			"homepageUrl": "https://stryker-mutator.io",
			"imageUrl": "data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"
		},
		"dependencies": { "@stryker-mutator/typescript-checker": "9.4.0", "typescript": "5.9.3" }
	}
}
