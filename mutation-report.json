{
	"files": {
		"src/lib/server/audit.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "7",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 142ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 196ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 110ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 519ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 340ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 150ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 672ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 632ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 94ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 46ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 189ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 24ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 111ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 177ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10311ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2338ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1319ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 275ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 163ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:56:45\n\n   Duration  22.48s (transform 15.54s, setup 0ms, collect 27.16s, tests 15.74s, environment 49ms, prepare 38.04s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 67 }, "start": { "column": 10, "line": 55 } }
				},
				{
					"id": "1",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 45ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 47ms\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 49ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 41ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 42ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 57ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 188ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 241ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 572ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 501ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 128ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 45ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10725ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 712ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 185ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3312ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1813ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n   Start at  22:56:45\n   Duration  23.04s (transform 13.45s, setup 0ms, collect 21.07s, tests 16.02s, environment 54ms, prepare 39.69s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 26 }, "start": { "column": 20, "line": 21 } }
				},
				{
					"id": "0",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 162ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 203ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 449ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 146ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 657ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 541ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 176ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 197ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 110ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 73ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 108ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10389ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 371ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 381ms\n\n   ✓ Config - Real Import Tests > should have auth configuration 315ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3221ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1420ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:56:45\n\n   Duration  22.05s (transform 10.63s, setup 0ms, collect 17.17s, tests 16.51s, environment 66ms, prepare 37.21s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 29 }, "start": { "column": 76, "line": 19 } }
				},
				{
					"id": "2",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 43ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 138ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 281ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 653ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 420ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 225ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 184ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 142ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 46ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9857ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 4729ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 160ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 163ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2810ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1544ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:56:45\n\n   Duration  22.64s (transform 11.62s, setup 0ms, collect 19.39s, tests 14.98s, environment 18ms, prepare 41.32s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 46 }, "start": { "column": 10, "line": 36 } }
				},
				{
					"id": "3",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 70ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 104ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 423ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 163ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 213ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 567ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 552ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 108ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 153ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 226ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 69ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 157ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11690ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1579ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2289ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1074ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 29ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 29ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 181ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:56:45\n\n   Duration  23.07s (transform 14.58s, setup 0ms, collect 24.51s, tests 16.63s, environment 8ms, prepare 36.30s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 45 }, "start": { "column": 12, "line": 37 } }
				},
				{
					"id": "4",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 147ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 97ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 463ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 322ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 203ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 45ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 613ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 332ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 38ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 37ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 33ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9858ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 4839ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 17ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 67ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3065ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1541ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:56:45\n\n   Duration  23.60s (transform 13.89s, setup 0ms, collect 22.87s, tests 15.07s, environment 19ms, prepare 37.70s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 31, "line": 38 }, "start": { "column": 15, "line": 38 } }
				},
				{
					"id": "6",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 76ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 128ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 90ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 422ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 318ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 156ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 496ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 462ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 151ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 203ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 120ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10827ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 813ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 31ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3266ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1278ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 155ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 58ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  22:56:45\n   Duration  23.19s (transform 16.33s, setup 0ms, collect 23.08s, tests 16.37s, environment 10ms, prepare 34.85s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 43 }, "start": { "column": 18, "line": 43 } }
				},
				{
					"id": "5",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 47ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 112ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 88ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 373ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 360ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 403ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 381ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 55ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 21ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 90ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 88ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 23ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 62ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10853ms\n\n   × Theme Store > Store Structure > should have subscribe method 5086ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 742ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 46ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1926ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 850ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 17ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n   Start at  22:56:46\n   Duration  22.42s (transform 18.66s, setup 0ms, collect 31.12s, tests 14.58s, environment 18ms, prepare 37.50s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 39 }, "start": { "column": 14, "line": 39 } }
				},
				{
					"id": "8",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 131ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 143ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 142ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 71ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 54ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 645ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 451ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 581ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 539ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n ✓ tests/unit/lib/audit.test.ts (28 tests) 43ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 139ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 298ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 43ms\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 32ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 24ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 55ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 26ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 33ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 41ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10653ms\n\n   × Theme Store > Store Structure > should have subscribe method 5013ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 619ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 282ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2992ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1598ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 24ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 104ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:13\n\n   Duration  22.42s (transform 19.19s, setup 0ms, collect 27.42s, tests 16.72s, environment 20ms, prepare 37.51s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 66 }, "start": { "column": 12, "line": 56 } }
				},
				{
					"id": "14",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 134ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 374ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 595ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 496ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 56ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 691ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 493ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 250ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 202ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 63ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 77ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 69ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 17ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9566ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4548ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3131ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1478ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 66ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 167ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 14ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  22:57:13\n   Duration  23.27s (transform 12.14s, setup 0ms, collect 22.48s, tests 16.14s, environment 18ms, prepare 36.85s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 30, "line": 77 }, "start": { "column": 15, "line": 77 } }
				},
				{
					"id": "12",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 98ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 101ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 131ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 541ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 329ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 491ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 455ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 230ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 216ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 49ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 40ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10742ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 718ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 130ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 31ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2984ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1523ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:13\n\n   Duration  23.67s (transform 14.24s, setup 0ms, collect 25.71s, tests 16.14s, environment 46ms, prepare 40.44s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 86 }, "start": { "column": 10, "line": 75 } }
				},
				{
					"id": "9",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 83ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 568ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 306ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 370ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 96ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 585ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 337ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 51ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 221ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 21ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10409ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 386ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 482ms\n\n   ✓ CleanupService > cleanup intervals > should calculate correct interval 464ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 152ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2880ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1614ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:13\n\n   Duration  23.85s (transform 16.61s, setup 0ms, collect 27.87s, tests 16.31s, environment 178ms, prepare 39.60s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 57 }, "start": { "column": 15, "line": 57 } }
				},
				{
					"id": "10",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 129ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 213ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 512ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 346ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 689ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 534ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 103ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 18ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 133ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 88ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 12703ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 2684ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 29ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 191ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2928ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1450ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:14\n\n   Duration  23.18s (transform 12.31s, setup 0ms, collect 18.87s, tests 18.47s, environment 46ms, prepare 39.41s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 58 }, "start": { "column": 14, "line": 58 } }
				},
				{
					"id": "11",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 106ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 242ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 451ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 734ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 818ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 439ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 40ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 66ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 213ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 179ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10878ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 840ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 184ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 24ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3153ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1407ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:14\n\n   Duration  23.33s (transform 15.77s, setup 0ms, collect 24.60s, tests 17.36s, environment 17ms, prepare 36.15s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 61 }, "start": { "column": 18, "line": 61 } }
				},
				{
					"id": "13",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 106ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 188ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 653ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 382ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 348ms\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 317ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 622ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 550ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 97ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 24ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11365ms\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1333ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 68ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3028ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1314ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:13\n\n   Duration  23.70s (transform 19.28s, setup 0ms, collect 30.25s, tests 17.19s, environment 42ms, prepare 37.50s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 85 }, "start": { "column": 12, "line": 76 } }
				},
				{
					"id": "15",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 57ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 34ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 284ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 558ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 235ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 958ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 591ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 70ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 195ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 51ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 221ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10439ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 395ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 89ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1097ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 313ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:17\n\n   Duration  21.17s (transform 15.87s, setup 0ms, collect 22.32s, tests 14.48s, environment 151ms, prepare 38.06s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 78 }, "start": { "column": 14, "line": 78 } }
				},
				{
					"id": "16",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 25ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 224ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 499ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 422ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 84ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 157ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 189ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 730ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 613ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 108ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 186ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 211ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 39ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9356ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4338ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2958ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1277ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 32ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:57:41\n\n   Duration  20.96s (transform 14.92s, setup 0ms, collect 24.74s, tests 14.98s, environment 73ms, prepare 36.00s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 80 }, "start": { "column": 18, "line": 80 } }
				},
				{
					"id": "19",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 143ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 160ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 147ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 177ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 496ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 539ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 523ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 55ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 274ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 43ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 37ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 52ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11670ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1648ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2336ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 908ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:41\n\n   Duration  20.87s (transform 15.31s, setup 0ms, collect 21.83s, tests 16.35s, environment 14ms, prepare 36.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 107 }, "start": { "column": 10, "line": 95 } }
				},
				{
					"id": "21",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 185ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 96ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 409ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 316ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 246ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 47ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 497ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 376ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 134ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 98ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 149ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 213ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 26ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11765ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1747ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2976ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1561ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 35ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 162ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:42\n\n   Duration  22.12s (transform 14.86s, setup 0ms, collect 19.09s, tests 17.50s, environment 8ms, prepare 35.92s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 97 }, "start": { "column": 15, "line": 97 } }
				},
				{
					"id": "17",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 80ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 356ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 37ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 195ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 472ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 30ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 203ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 27ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 25ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9579ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4564ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2835ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1213ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:57:42\n\n   Duration  22.30s (transform 13.76s, setup 0ms, collect 26.44s, tests 14.10s, environment 11ms, prepare 35.81s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 20, "line": 82 }, "start": { "column": 12, "line": 82 } }
				},
				{
					"id": "20",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 367ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 342ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 38ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 274ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 107ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 34ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 623ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 417ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 190ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 72ms\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 205ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10089ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2848ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1102ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:42\n\n   Duration  21.45s (transform 11.05s, setup 0ms, collect 20.51s, tests 15.21s, environment 19ms, prepare 34.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 106 }, "start": { "column": 12, "line": 96 } }
				},
				{
					"id": "18",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 296ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 129ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 133ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 77ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 316ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 30ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 28ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 598ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 567ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 153ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 213ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 42ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 28ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11939ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1923ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2938ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1494ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 17ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:42\n\n   Duration  22.75s (transform 16.40s, setup 0ms, collect 20.57s, tests 17.12s, environment 7ms, prepare 38.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 39, "line": 84 }, "start": { "column": 13, "line": 84 } }
				},
				{
					"id": "22",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 102ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 207ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 43ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 607ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 453ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 451ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 440ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 45ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 186ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 70ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10499ms\n\n   × Theme Store > Store Structure > should have subscribe method 5025ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 456ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1960ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 760ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:57:43\n\n   Duration  21.92s (transform 16.46s, setup 0ms, collect 25.50s, tests 14.43s, environment 83ms, prepare 36.80s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 22, "line": 98 }, "start": { "column": 14, "line": 98 } }
				},
				{
					"id": "23",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 102ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 64ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 410ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 312ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 623ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 597ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 35ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 57ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 241ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 245ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 24ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8381ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3352ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 663ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 313ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:57:47\n\n   Duration  19.07s (transform 15.65s, setup 0ms, collect 23.23s, tests 11.12s, environment 13ms, prepare 30.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 24, "line": 101 },
						"start": { "column": 18, "line": 101 }
					}
				},
				{
					"id": "25",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 156ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 437ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 624ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 463ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 405ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 382ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 99ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 100ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 72ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11068ms\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1043ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 52ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3320ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1542ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:09\n\n   Duration  23.01s (transform 13.23s, setup 0ms, collect 22.19s, tests 16.78s, environment 8ms, prepare 32.29s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 4, "line": 118 },
						"start": { "column": 12, "line": 110 }
					}
				},
				{
					"id": "24",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 38ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 136ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 86ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 128ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 530ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 496ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 352ms\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 163ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 138ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 197ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 137ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 27ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 135ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 77ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 43ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 35ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 21ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2914ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1438ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 13912ms\n   × Theme Store > Store Structure > should have subscribe method 5063ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 3832ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:09\n\n   Duration  23.53s (transform 14.22s, setup 0ms, collect 21.67s, tests 19.37s, environment 31ms, prepare 36.37s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 119 },
						"start": { "column": 78, "line": 109 }
					}
				},
				{
					"id": "27",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 83ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 116ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 90ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 42ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 558ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 55ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 589ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 570ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 87ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 146ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 325ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 89ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 71ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 28ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 156ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11525ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1508ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 36ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 4803ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 2897ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  22:58:10\n\n   Duration  24.68s (transform 13.90s, setup 0ms, collect 19.08s, tests 18.95s, environment 96ms, prepare 37.00s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 21, "line": 112 },
						"start": { "column": 14, "line": 112 }
					}
				},
				{
					"id": "26",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 533ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 329ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 253ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 613ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 602ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 38ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 46ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 68ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 251ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 70ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 245ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n ✓ tests/unit/lib/config.test.ts (11 tests) 52ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 701ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 4500ms\n\n   ✓ AuthService > Configuration > should respect AUTH_ENABLED flag 423ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1859ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 14960ms\n   × Theme Store > Store Structure > should have subscribe method 5019ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 4649ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  22:58:10\n   Duration  24.78s (transform 18.59s, setup 0ms, collect 24.98s, tests 22.82s, environment 10ms, prepare 43.51s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 23, "line": 111 },
						"start": { "column": 15, "line": 111 }
					}
				},
				{
					"id": "28",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 595ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 362ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 87ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 125ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 443ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 301ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 472ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 409ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 247ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 138ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 68ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11149ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1133ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 4309ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 2586ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 14ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:10\n\n   Duration  25.36s (transform 10.44s, setup 0ms, collect 18.81s, tests 18.13s, environment 45ms, prepare 44.60s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 18, "line": 115 },
						"start": { "column": 12, "line": 115 }
					}
				},
				{
					"id": "29",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 193ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 61ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 415ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 443ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 508ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 453ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 137ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 22ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 1484ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 273ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 3 failed) 15205ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have set method 5075ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 4446ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 2735ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have set method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  22:58:10\n\n   Duration  25.58s (transform 15.72s, setup 0ms, collect 24.96s, tests 23.61s, environment 9ms, prepare 42.80s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 21, "line": 116 },
						"start": { "column": 12, "line": 116 }
					}
				},
				{
					"id": "30",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 24ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 251ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 429ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 102ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 540ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 525ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 70ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 200ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 128ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 34ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 13398ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 3381ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1642ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 526ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 60ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:12\n\n   Duration  24.23s (transform 21.67s, setup 0ms, collect 33.84s, tests 17.23s, environment 11ms, prepare 43.45s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 21, "line": 117 },
						"start": { "column": 13, "line": 117 }
					}
				},
				{
					"id": "31",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 103ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 634ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 172ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 257ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 482ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 357ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 257ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 1200ms\n   ✓ Global Navigation > Visibility > should show on authenticated pages 651ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 207ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 24ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11476ms\n   × Theme Store > Store Structure > should have subscribe method 5020ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 1436ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 957ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 384ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:15\n\n   Duration  21.25s (transform 18.10s, setup 0ms, collect 25.21s, tests 16.48s, environment 9ms, prepare 35.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 123 },
						"start": { "column": 55, "line": 121 }
					}
				},
				{
					"id": "32",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 20ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 99ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 324ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 238ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 231ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 60ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 53ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 63ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 54ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 276ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3446ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1746ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 17ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 14322ms\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 4301ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:39\n\n   Duration  18.93s (transform 15.23s, setup 0ms, collect 17.92s, tests 19.45s, environment 14ms, prepare 30.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 127 },
						"start": { "column": 79, "line": 125 }
					}
				},
				{
					"id": "33",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 40ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 50ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 187ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 533ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 392ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 165ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 186ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 185ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 18ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 38ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3353ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1912ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 3 failed) 15060ms\n\n   × Theme Store > Store Structure > should have subscribe method 5028ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have set method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have set method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  3 failed | 523 passed (526)\n   Start at  22:58:39\n\n   Duration  21.36s (transform 13.24s, setup 0ms, collect 16.73s, tests 20.07s, environment 18ms, prepare 35.31s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 131 },
						"start": { "column": 72, "line": 129 }
					}
				},
				{
					"id": "34",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 85ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 466ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 334ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 122ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 696ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 606ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 200ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 219ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 448ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 274ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 249ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 52ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 50ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 153ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 12489ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 2463ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 85ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 13ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 170ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2837ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1270ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 8ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:41\n\n   Duration  23.40s (transform 14.16s, setup 0ms, collect 22.63s, tests 18.79s, environment 11ms, prepare 40.96s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 135 },
						"start": { "column": 80, "line": 133 }
					}
				},
				{
					"id": "35",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 510ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 313ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 301ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 58ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 185ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 558ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 185ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 119ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 221ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 233ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11462ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1443ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2562ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1296ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 256ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:42\n\n   Duration  24.04s (transform 19.00s, setup 0ms, collect 32.48s, tests 16.89s, environment 41ms, prepare 39.79s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 139 },
						"start": { "column": 55, "line": 137 }
					}
				}
			],
			"source": "import { database } from './database';\n\nexport interface AuditLog {\n\tid?: number;\n\ttimestamp: number;\n\teventType: string;\n\tuserType: 'admin' | 'public';\n\tipAddress: string;\n\tuserAgent?: string;\n\tresourceType?: 'file' | 'link' | 'session';\n\tresourceId?: string;\n\taction: 'create' | 'read' | 'delete' | 'login' | 'logout';\n\tstatus: 'success' | 'failure';\n\tdetails?: Record<string, unknown>;\n\tcreatedAt: number;\n}\n\nexport class AuditService {\n\tstatic log(entry: Omit<AuditLog, 'id' | 'timestamp' | 'createdAt'>): void {\n\t\tconst now = Date.now();\n\t\tconst auditLog = {\n\t\t\t...entry,\n\t\t\ttimestamp: now,\n\t\t\tcreatedAt: now,\n\t\t\tdetails: entry.details ? JSON.stringify(entry.details) : undefined\n\t\t};\n\n\t\tdatabase.createAuditLog(auditLog);\n\t}\n\n\tstatic logAuth(\n\t\taction: 'login' | 'logout',\n\t\tstatus: 'success' | 'failure',\n\t\tipAddress: string,\n\t\tdetails?: Record<string, unknown>\n\t): void {\n\t\tthis.log({\n\t\t\teventType: 'authentication',\n\t\t\tuserType: 'admin',\n\t\t\tipAddress,\n\t\t\taction,\n\t\t\tstatus,\n\t\t\tresourceType: 'session',\n\t\t\tdetails\n\t\t});\n\t}\n\n\tstatic logUpload(\n\t\taction: 'create' | 'delete',\n\t\tstatus: 'success' | 'failure',\n\t\tfileId: string,\n\t\tipAddress: string,\n\t\tuserAgent?: string,\n\t\tdetails?: Record<string, unknown>\n\t): void {\n\t\tthis.log({\n\t\t\teventType: 'upload',\n\t\t\tuserType: 'admin',\n\t\t\tipAddress,\n\t\t\tuserAgent,\n\t\t\tresourceType: 'file',\n\t\t\tresourceId: fileId,\n\t\t\taction,\n\t\t\tstatus,\n\t\t\tdetails\n\t\t});\n\t}\n\n\tstatic logLinkCreation(\n\t\tstatus: 'success' | 'failure',\n\t\tlinkToken: string,\n\t\tsourceType: 'upload' | 'shared',\n\t\tipAddress: string,\n\t\tdetails?: Record<string, unknown>\n\t): void {\n\t\tthis.log({\n\t\t\teventType: 'link_creation',\n\t\t\tuserType: 'admin',\n\t\t\tipAddress,\n\t\t\tresourceType: 'link',\n\t\t\tresourceId: linkToken,\n\t\t\taction: 'create',\n\t\t\tstatus,\n\t\t\tdetails: { ...details, sourceType }\n\t\t});\n\t}\n\n\tstatic logDownload(\n\t\taction: 'read',\n\t\tstatus: 'success' | 'failure',\n\t\tlinkToken: string,\n\t\tipAddress: string,\n\t\tuserAgent?: string,\n\t\tdetails?: Record<string, unknown>\n\t): void {\n\t\tthis.log({\n\t\t\teventType: 'download',\n\t\t\tuserType: 'public',\n\t\t\tipAddress,\n\t\t\tuserAgent,\n\t\t\tresourceType: 'link',\n\t\t\tresourceId: linkToken,\n\t\t\taction,\n\t\t\tstatus,\n\t\t\tdetails\n\t\t});\n\t}\n\n\tstatic logBrowse(ipAddress: string, path: string, userAgent?: string): void {\n\t\tthis.log({\n\t\t\teventType: 'browse',\n\t\t\tuserType: 'admin',\n\t\t\tipAddress,\n\t\t\tuserAgent,\n\t\t\taction: 'read',\n\t\t\tstatus: 'success',\n\t\t\tdetails: { path }\n\t\t});\n\t}\n\n\tstatic getRecentLogs(limit: number = 100): unknown[] {\n\t\treturn database.getRecentAuditLogs(limit);\n\t}\n\n\tstatic getLogsByEventType(eventType: string, limit: number = 100): unknown[] {\n\t\treturn database.getAuditLogsByEventType(eventType, limit);\n\t}\n\n\tstatic getLogsByIp(ipAddress: string, limit: number = 100): unknown[] {\n\t\treturn database.getAuditLogsByIp(ipAddress, limit);\n\t}\n\n\tstatic getLogsByResource(resourceType: string, resourceId: string): unknown[] {\n\t\treturn database.getAuditLogsByResource(resourceType, resourceId);\n\t}\n\n\tstatic cleanupOldLogs(retentionDays: number): number {\n\t\treturn database.cleanupOldAuditLogs(retentionDays);\n\t}\n}\n"
		},
		"src/lib/server/auth.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "37",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 50ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 296ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 878ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 523ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 408ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 366ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 71ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 251ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 103ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 167ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 215ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 38ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 27ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 138ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 387ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 29ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11694ms\n\n   × Theme Store > Store Structure > should have subscribe method 5023ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5018ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1641ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 339ms\n\n   ✓ Version API > should return version information 337ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:58:41\n\n   Duration  23.57s (transform 17.69s, setup 0ms, collect 31.53s, tests 15.31s, environment 14ms, prepare 38.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 26 }, "start": { "column": 43, "line": 8 } }
				},
				{
					"id": "36",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 30ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 76ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 307ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 366ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 385ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 720ms\n\n   ✓ File Management (/admin/files) > Delete Operation > should call DELETE API 305ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 68ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 120ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 131ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 31ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 28ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 44ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 69ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 23ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 12233ms\n\n   × Theme Store > Store Structure > should have subscribe method 5014ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 2203ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n   Start at  22:58:42\n\n   Duration  24.08s (transform 20.22s, setup 0ms, collect 31.48s, tests 14.98s, environment 21ms, prepare 38.20s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 36, "line": 6 }, "start": { "column": 31, "line": 6 } }
				},
				{
					"id": "38",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 186ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 23ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 813ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 722ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 120ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 241ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 232ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 816ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 795ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 218ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 212ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 216ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 10014ms\n\n   × Theme Store > Store Structure > should have subscribe method 5023ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4978ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 45ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:58:44\n\n   Duration  22.80s (transform 18.02s, setup 0ms, collect 29.70s, tests 13.40s, environment 9ms, prepare 36.46s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 9 }, "start": { "column": 7, "line": 9 } }
				},
				{
					"id": "39",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 22ms\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 202ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 119ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 703ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 433ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 706ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 394ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 193ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 228ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 44ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 30ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9942ms\n\n   × Theme Store > Store Structure > should have subscribe method 5075ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4768ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Initialization > should initialize without error when auth disabled\nHashing admin password...\n\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Initialization > should initialize without error when auth disabled\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2145ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 701ms\n\n   ✓ AuthService > Initialization > should initialize without error when auth disabled 361ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  22:58:44\n\n   Duration  22.78s (transform 17.01s, setup 0ms, collect 31.64s, tests 14.63s, environment 59ms, prepare 37.22s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 9 }, "start": { "column": 7, "line": 9 } }
				},
				{
					"id": "40",
					"mutatorName": "BooleanLiteral",
					"replacement": "config.auth.enabled",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 48ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 48ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 294ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 39ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 176ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 97ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 40ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication disabled\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8231ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3211ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 76ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 22ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:09\n\n   Duration  14.23s (transform 8.55s, setup 0ms, collect 11.42s, tests 9.39s, environment 8ms, prepare 21.51s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 11 }, "start": { "column": 7, "line": 11 } }
				},
				{
					"id": "41",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 140ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 273ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 143ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 459ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 364ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 216ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 256ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 279ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication disabled\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10464ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 445ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 59ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:59:10\n\n   Duration  16.64s (transform 9.10s, setup 0ms, collect 13.23s, tests 12.73s, environment 16ms, prepare 28.27s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 11 }, "start": { "column": 7, "line": 11 } }
				},
				{
					"id": "42",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 112ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 183ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 159ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 817ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 798ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 25ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 213ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 249ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 155ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10238ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2518ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1194ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 47ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:59:11\n\n   Duration  19.12s (transform 12.70s, setup 0ms, collect 18.10s, tests 15.12s, environment 33ms, prepare 35.13s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 11 }, "start": { "column": 7, "line": 11 } }
				},
				{
					"id": "43",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 37ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 66ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 308ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 687ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 401ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 847ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 328ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 29ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 194ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 209ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 89ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9814ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 4798ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 21ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2585ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1316ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:12\n\n   Duration  20.19s (transform 12.92s, setup 0ms, collect 22.58s, tests 15.15s, environment 8ms, prepare 28.76s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 15 }, "start": { "column": 29, "line": 11 } }
				},
				{
					"id": "45",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 89ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 731ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 482ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 559ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 538ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 100ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 189ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 174ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8563ms\n\n   × Theme Store > Store Structure > should have subscribe method 5014ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3524ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1963ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 884ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:13\n\n   Duration  19.96s (transform 14.63s, setup 0ms, collect 26.10s, tests 12.63s, environment 8ms, prepare 32.45s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 13 }, "start": { "column": 23, "line": 13 } }
				},
				{
					"id": "44",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 232ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 85ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 43ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 331ms\n   ✓ AuditService > RGPD Compliance > should use configurable retention 307ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 835ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 575ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 108ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 164ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 308ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7553ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2540ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1421ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 807ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:14\n\n   Duration  19.42s (transform 10.87s, setup 0ms, collect 21.12s, tests 11.52s, environment 82ms, prepare 33.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 12 }, "start": { "column": 16, "line": 12 } }
				},
				{
					"id": "46",
					"mutatorName": "BooleanLiteral",
					"replacement": "config.auth.adminPassword",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 212ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 351ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 810ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 566ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 296ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 639ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 386ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 65ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 83ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 200ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 73ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7977ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2962ms\n\n ❯ tests/unit/lib/auth.test.ts (11 tests | 11 skipped) 98ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 17ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/auth.test.ts > AuthService\n\nError: ADMIN_PASSWORD must be set when AUTH_ENABLED=true\n ❯ Function.initialize src/lib/server/auth.ts:74:17\n\n     72|         } else {\n     73|           stryCov_9fa48(\"49\");\n     74|           throw new Error(stryMutAct_9fa48(\"50\") ? \"\" : (stryCov_9fa48…\n       |                 ^\n     75|         }\n     76|       }\n\n ❯ tests/unit/lib/auth.test.ts:9:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  1 failed | 514 passed | 11 skipped (526)\n\n   Start at  22:59:15\n\n   Duration  19.02s (transform 11.71s, setup 0ms, collect 22.61s, tests 11.01s, environment 8ms, prepare 32.03s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 17 }, "start": { "column": 7, "line": 17 } }
				},
				{
					"id": "47",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 67ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 187ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 266ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 269ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 530ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 271ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 669ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 626ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 247ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 207ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 166ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ❯ tests/unit/lib/auth.test.ts (11 tests | 11 skipped) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7846ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2804ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 23ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/auth.test.ts > AuthService\n\nError: ADMIN_PASSWORD must be set when AUTH_ENABLED=true\n ❯ Function.initialize src/lib/server/auth.ts:74:17\n\n     72|         } else {\n     73|           stryCov_9fa48(\"49\");\n     74|           throw new Error(stryMutAct_9fa48(\"50\") ? \"\" : (stryCov_9fa48…\n       |                 ^\n     75|         }\n     76|       }\n\n ❯ tests/unit/lib/auth.test.ts:9:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  1 failed | 514 passed | 11 skipped (526)\n\n   Start at  22:59:16\n\n   Duration  18.07s (transform 12.58s, setup 0ms, collect 20.31s, tests 10.96s, environment 25ms, prepare 31.32s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 17 }, "start": { "column": 7, "line": 17 } }
				},
				{
					"id": "48",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 72ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 31ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 365ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 351ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 172ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 264ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 28ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 138ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 207ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2776ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1047ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 18ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10276ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 66ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:59:36\n\n   Duration  15.17s (transform 8.90s, setup 0ms, collect 10.92s, tests 14.63s, environment 25ms, prepare 23.04s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 17 }, "start": { "column": 7, "line": 17 } }
				},
				{
					"id": "49",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 46ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 102ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 224ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 390ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 375ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 41ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 114ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 26ms\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 27ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 152ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 181ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 41ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 49ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 51ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10429ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 409ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 13ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3639ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 2165ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n   Start at  22:59:37\n\n   Duration  18.43s (transform 10.11s, setup 0ms, collect 15.11s, tests 15.67s, environment 14ms, prepare 30.04s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 19 }, "start": { "column": 35, "line": 17 } }
				},
				{
					"id": "50",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 204ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 89ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 39ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 73ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 645ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 603ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 37ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 68ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 158ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 196ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 91ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 19ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 26ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 87ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 29ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 12183ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 2162ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2834ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1187ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 34ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:59:39\n\n   Duration  21.75s (transform 15.23s, setup 0ms, collect 22.84s, tests 16.99s, environment 132ms, prepare 35.72s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 71, "line": 18 }, "start": { "column": 20, "line": 18 } }
				},
				{
					"id": "51",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 201ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 210ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 86ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 254ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 431ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 469ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 333ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 928ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 823ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 60ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 73ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 224ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 64ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 168ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10793ms\n   × Theme Store > Store Structure > should have subscribe method 5046ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 723ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 39ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1909ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 932ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 18ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  22:59:42\n\n   Duration  23.78s (transform 16.43s, setup 0ms, collect 25.45s, tests 16.42s, environment 28ms, prepare 39.09s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 42, "line": 22 }, "start": { "column": 15, "line": 22 } }
				},
				{
					"id": "52",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 17ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 103ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 154ms\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 390ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 371ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 295ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 436ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 109ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 733ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 615ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 27ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 244ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 142ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 237ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 34ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 184ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 37ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\n\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11036ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1020ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2353ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1111ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 54ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  22:59:42\n\n   Duration  24.06s (transform 16.95s, setup 0ms, collect 25.18s, tests 16.78s, environment 80ms, prepare 36.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 67, "line": 24 }, "start": { "column": 15, "line": 24 } }
				},
				{
					"id": "55",
					"mutatorName": "BooleanLiteral",
					"replacement": "this.initialized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 131ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 269ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 708ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 544ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 393ms\n\n   ✓ Config > storage > should have storage configuration 377ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9739ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4719ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2389ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1065ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 14ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:45\n\n   Duration  21.00s (transform 11.53s, setup 0ms, collect 16.38s, tests 14.14s, environment 14ms, prepare 37.30s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 29 }, "start": { "column": 7, "line": 29 } }
				},
				{
					"id": "54",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 242ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 205ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 309ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 662ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 407ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 917ms\n   ✓ Admin Dashboard (/admin) > Stats Cards > should display total links 369ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 499ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 111ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 258ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 221ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9374ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4305ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 958ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 382ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  22:59:45\n   Duration  21.00s (transform 11.18s, setup 0ms, collect 20.57s, tests 14.01s, environment 15ms, prepare 33.48s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 38 }, "start": { "column": 66, "line": 28 } }
				},
				{
					"id": "53",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 49ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 58ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 458ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 302ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 328ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 812ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 558ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 44ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 206ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 117ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 256ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 211ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 46ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 120ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 197ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 344ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 46ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9735ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4715ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Password Verification (when enabled) > should reject empty password\nHashing admin password...\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Password Verification (when enabled) > should reject empty password\nAuthentication enabled - Admin password configured\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Initialization > should initialize without error when auth disabled\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService > Initialization > should initialize without error when auth disabled\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2289ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1306ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  22:59:45\n\n   Duration  21.81s (transform 14.84s, setup 0ms, collect 22.66s, tests 15.76s, environment 11ms, prepare 36.31s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 26, "line": 25 }, "start": { "column": 22, "line": 25 } }
				},
				{
					"id": "56",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 101ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 24ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 44ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 84ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 199ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 48ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 45ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 52ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 29ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 47ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7947ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2838ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 87ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3220ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1740ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:00:08\n   Duration  17.22s (transform 8.61s, setup 0ms, collect 16.68s, tests 12.33s, environment 30ms, prepare 25.87s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 29 }, "start": { "column": 7, "line": 29 } }
				},
				{
					"id": "57",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 53ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 48ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 36ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 207ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 62ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 572ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 336ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 121ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 296ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11742ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5026ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1679ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3332ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1363ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 31ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:00:09\n\n   Duration  18.25s (transform 11.78s, setup 0ms, collect 15.43s, tests 16.94s, environment 7ms, prepare 29.91s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 29 }, "start": { "column": 7, "line": 29 } }
				},
				{
					"id": "58",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 345ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 350ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 363ms\n   ✓ Database Audit Methods > createAuditLog > should accept valid audit log entry 351ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 232ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 239ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 62ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 32ms\n ✓ tests/unit/lib/session.test.ts (16 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 117ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 195ms\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 30ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 129ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2907ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1251ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 13823ms\n\n   × Theme Store > Store Structure > should have subscribe method 5025ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 3778ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:00:13\n\n   Duration  22.16s (transform 14.09s, setup 0ms, collect 20.69s, tests 19.21s, environment 11ms, prepare 35.09s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 31 }, "start": { "column": 26, "line": 29 } }
				},
				{
					"id": "59",
					"mutatorName": "BooleanLiteral",
					"replacement": "this.passwordHash",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 46ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 84ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 197ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 717ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 467ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 171ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 672ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 448ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 258ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 215ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 255ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10638ms\n\n   × Theme Store > Store Structure > should have subscribe method 5014ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 603ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1306ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 242ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 34ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 24ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:00:15\n\n   Duration  24.52s (transform 18.08s, setup 0ms, collect 32.06s, tests 15.13s, environment 42ms, prepare 37.72s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 33 }, "start": { "column": 7, "line": 33 } }
				},
				{
					"id": "60",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 437ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 153ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 208ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 621ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 722ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 350ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 190ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 73ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9379ms\n\n   × Theme Store > Store Structure > should have subscribe method 5013ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4346ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1222ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:00:17\n\n   Duration  23.02s (transform 13.57s, setup 0ms, collect 23.81s, tests 13.25s, environment 9ms, prepare 37.66s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 33 }, "start": { "column": 7, "line": 33 } }
				},
				{
					"id": "61",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 125ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 422ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 410ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 127ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 98ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 73ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 499ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 485ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 254ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 137ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 225ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 272ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 163ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9425ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 4401ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 124ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2028ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 810ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:00:18\n\n   Duration  21.58s (transform 12.70s, setup 0ms, collect 21.51s, tests 14.35s, environment 32ms, prepare 33.72s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 33 }, "start": { "column": 7, "line": 33 } }
				},
				{
					"id": "62",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 705ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 145ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 319ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 278ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 566ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 545ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 50ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 240ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 62ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 156ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8189ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3172ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1673ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 869ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 12ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:00:19\n\n   Duration  21.67s (transform 17.49s, setup 0ms, collect 26.65s, tests 12.63s, environment 28ms, prepare 35.58s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 35 }, "start": { "column": 27, "line": 33 } }
				},
				{
					"id": "63",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 143ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 99ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 633ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 374ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 264ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 613ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 556ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 78ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 86ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 275ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 202ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 22ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9485ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4446ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1611ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 756ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 53ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:00:21\n\n   Duration  19.91s (transform 12.90s, setup 0ms, collect 22.24s, tests 13.83s, environment 24ms, prepare 32.46s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 34 }, "start": { "column": 20, "line": 34 } }
				},
				{
					"id": "64",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 128ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 68ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 39ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5067ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/auth.test.ts (11 tests | 1 failed) 1251ms\n\n   × AuthService > Configuration > should respect AUTH_ENABLED flag 9ms\n     → expected undefined to be true // Object.is equality\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 582ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/auth.test.ts > AuthService > Configuration > should respect AUTH_ENABLED flag\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/auth.test.ts:14:36\n\n     12|  describe('Configuration', () => {\n     13|   it('should respect AUTH_ENABLED flag', () => {\n     14|    expect(AuthService.isEnabled()).toBe(config.auth.enabled);\n       |                                    ^\n     15|   });\n     16| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:00:42\n\n   Duration  11.57s (transform 5.76s, setup 0ms, collect 11.16s, tests 7.08s, environment 21ms, prepare 19.29s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 42 }, "start": { "column": 30, "line": 40 } }
				}
			],
			"source": "import bcrypt from 'bcrypt';\nimport { config } from './config';\n\nexport class AuthService {\n\tprivate static passwordHash: string | null = null;\n\tprivate static initialized = false;\n\n\tstatic async initialize(): Promise<void> {\n\t\tif (this.initialized) return;\n\n\t\tif (!config.auth.enabled) {\n\t\t\tconsole.log('Authentication disabled');\n\t\t\tthis.initialized = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (!config.auth.adminPassword) {\n\t\t\tthrow new Error('ADMIN_PASSWORD must be set when AUTH_ENABLED=true');\n\t\t}\n\n\t\t// Hash password at startup\n\t\tconsole.log('Hashing admin password...');\n\t\tthis.passwordHash = await bcrypt.hash(config.auth.adminPassword, 10);\n\t\tconsole.log('Authentication enabled - Admin password configured');\n\t\tthis.initialized = true;\n\t}\n\n\tstatic async verifyPassword(password: string): Promise<boolean> {\n\t\tif (!this.initialized) {\n\t\t\tawait this.initialize();\n\t\t}\n\n\t\tif (!this.passwordHash) {\n\t\t\tthrow new Error('Authentication not initialized');\n\t\t}\n\n\t\treturn bcrypt.compare(password, this.passwordHash);\n\t}\n\n\tstatic isEnabled(): boolean {\n\t\treturn config.auth.enabled;\n\t}\n}\n"
		},
		"src/lib/server/security.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "65",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 87ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 262ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 98ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 1ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 78ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Cannot read properties of undefined (reading 'headers')\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 70ms\n     → Cannot read properties of undefined (reading 'headers')\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 357ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 338ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 170ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 83ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 29ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 139ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 49ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 105ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 890ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 400ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5343ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 305ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n\n ❯ tests/unit/lib/security-headers.test.ts:13:20\n\n     11|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     12| \n     13|    expect(response.headers.get('X-Frame-Options')).toBe('DENY');\n       |                    ^\n     14|   });\n     15| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\nTypeError: Cannot read properties of undefined (reading 'headers')\n ❯ tests/unit/lib/security-headers.test.ts:22:20\n\n     20|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     21| \n     22|    expect(response.headers.get('X-Content-Type-Options')).toBe('nosnif…\n       |                    ^\n     23|   });\n     24| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n\n ❯ tests/unit/lib/security-headers.test.ts:30:25\n\n     28| \n     29|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     30|    const csp = response.headers.get('Content-Security-Policy');\n       |                         ^\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n\n ❯ tests/unit/lib/security-headers.test.ts:41:20\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                    ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n\n ❯ tests/unit/lib/security-headers.test.ts:52:20\n\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                    ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nTypeError: Cannot read properties of undefined (reading 'headers')\n\n ❯ tests/unit/lib/security-headers.test.ts:142:25\n\n    140|     resolve: mockResolve\n    141|    });\n    142|    const csp = response.headers.get('Content-Security-Policy');\n       |                         ^\n    143| \n    144|    expect(csp).toContain(\"frame-ancestors 'none'\");\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:00:43\n\n   Duration  10.76s (transform 5.73s, setup 0ms, collect 8.99s, tests 7.87s, environment 16ms, prepare 17.77s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 41 }, "start": { "column": 70, "line": 6 } }
				},
				{
					"id": "66",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 20ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 338ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 67ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 3ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 2ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 228ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 34ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 537ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 461ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 163ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 147ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 145ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 80ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 184ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 228ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7415ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2387ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 46ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 21ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2829ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1494ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:64:22\n     62| \n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  7 failed | 519 passed (526)\n   Start at  23:00:48\n   Duration  16.84s (transform 7.89s, setup 0ms, collect 16.11s, tests 12.40s, environment 10ms, prepare 27.99s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 10 }, "start": { "column": 23, "line": 10 } }
				},
				{
					"id": "67",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 107ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 367ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 161ms\n\n     → expected '' to be 'nosniff' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 270ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 454ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 633ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 609ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 195ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 135ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 220ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9416ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4236ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2698ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1482ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 146ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nAssertionError: expected '' to be 'nosniff' // Object.is equality\n\n\n- Expected\n+ Received\n\n- nosniff\n\n\n ❯ tests/unit/lib/security-headers.test.ts:22:59\n\n     20|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     21| \n     22|    expect(response.headers.get('X-Content-Type-Options')).toBe('nosnif…\n       |                                                           ^\n     23|   });\n     24| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:00:51\n\n   Duration  19.59s (transform 11.36s, setup 0ms, collect 18.53s, tests 14.90s, environment 11ms, prepare 32.94s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 10 }, "start": { "column": 49, "line": 10 } }
				},
				{
					"id": "68",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 99ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 107ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 126ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 574ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 414ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 9ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 13ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 10ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 1026ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should show success/failure status 370ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 430ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 314ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 32ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 106ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 48ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8967ms\n\n   × Theme Store > Store Structure > should have subscribe method 5017ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3933ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2923ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1564ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:65:22\n\n     63|     // Security headers\n     64|     response.headers.set(stryMutAct_9fa48(\"66\") ? \"\" : (stryCov_9fa48(…\n     65|     response.headers.set(stryMutAct_9fa48(\"68\") ? \"\" : (stryCov_9fa48(…\n       |                      ^\n     66|     response.headers.set(stryMutAct_9fa48(\"70\") ? \"\" : (stryCov_9fa48(…\n     67|     response.headers.set(stryMutAct_9fa48(\"72\") ? \"\" : (stryCov_9fa48(…\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:00:53\n\n   Duration  18.79s (transform 8.43s, setup 0ms, collect 15.82s, tests 14.54s, environment 10ms, prepare 33.57s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 11 }, "start": { "column": 23, "line": 11 } }
				},
				{
					"id": "69",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 99ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 98ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 264ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 307ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 653ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 369ms\n\n     → expected '' to be 'DENY' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 134ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 605ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 464ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 43ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 314ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 191ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10260ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2079ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1037ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nAssertionError: expected '' to be 'DENY' // Object.is equality\n\n\n- Expected\n+ Received\n\n- DENY\n\n\n ❯ tests/unit/lib/security-headers.test.ts:13:52\n\n     11|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     12| \n     13|    expect(response.headers.get('X-Frame-Options')).toBe('DENY');\n       |                                                    ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:00:54\n\n   Duration  19.46s (transform 11.96s, setup 0ms, collect 20.98s, tests 15.27s, environment 19ms, prepare 28.68s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 11 }, "start": { "column": 42, "line": 11 } }
				},
				{
					"id": "70",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 540ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 316ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 1ms\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 45ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 284ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 70ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 781ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 438ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 217ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 307ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 228ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 236ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8647ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3632ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1905ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 879ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:66:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:00:55\n\n   Duration  18.40s (transform 14.14s, setup 0ms, collect 20.35s, tests 13.50s, environment 12ms, prepare 33.28s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 12 }, "start": { "column": 23, "line": 12 } }
				},
				{
					"id": "71",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 60ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 741ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 345ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 359ms\n\n   ✓ Audit Log Fields > Optional Fields > should allow null details 337ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 597ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 329ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 205ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8560ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3523ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1299ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 594ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:00:56\n\n   Duration  17.91s (transform 15.13s, setup 0ms, collect 22.45s, tests 12.74s, environment 14ms, prepare 29.54s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 12 }, "start": { "column": 43, "line": 12 } }
				},
				{
					"id": "72",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 87ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 36ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 25ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 8ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 338ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 323ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 34ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 30ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 54ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 118ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4417ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4405ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1430ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 690ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 61ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 17ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:67:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:01:14\n\n   Duration  10.45s (transform 4.88s, setup 0ms, collect 8.77s, tests 7.06s, environment 9ms, prepare 16.94s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 13 }, "start": { "column": 23, "line": 13 } }
				},
				{
					"id": "73",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 75, "line": 13 }, "start": { "column": 42, "line": 13 } }
				},
				{
					"id": "74",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 180ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 217ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 400ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 229ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 143ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 4ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 2ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 447ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 423ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 32ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 23ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2896ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1668ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 46ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10725ms\n\n   × Theme Store > Store Structure > should have subscribe method 5015ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 641ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 23ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 8 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/8]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/8]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/8]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/8]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/8]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:68:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/8]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/8]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  8 failed | 518 passed (526)\n\n   Start at  23:01:20\n\n   Duration  19.57s (transform 11.68s, setup 0ms, collect 18.56s, tests 15.46s, environment 9ms, prepare 31.39s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 23, "line": 15 }, "start": { "column": 3, "line": 15 } }
				},
				{
					"id": "75",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 27ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 223ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 306ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 641ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 374ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 204ms\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 28ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 282ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 185ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 245ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10940ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 921ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 173ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2556ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1089ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 386ms\n   ✓ Theme Store - Real Tests > should have subscribe method 378ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:01:23\n\n   Duration  20.04s (transform 11.30s, setup 0ms, collect 19.70s, tests 16.57s, environment 22ms, prepare 30.81s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 16 }, "start": { "column": 3, "line": 16 } }
				},
				{
					"id": "76",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 169ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 356ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 87ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff 2ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 2ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 1ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 1ms\n     → Headers.set: \"\" is an invalid header name.\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 2ms\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 243ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 255ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 737ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 400ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 204ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 193ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 239ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9137ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4115ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 147ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 254ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 13ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1870ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1133ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 92ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:11:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set X-Content-Type-Options to nosniff\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:20:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:29:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nTypeError: Headers.set: \"\" is an invalid header name.\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:50:21\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:71:22\n\n\n\n ❯ tests/unit/lib/security-headers.test.ts:138:21\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n   Start at  23:01:26\n\n   Duration  20.09s (transform 11.34s, setup 0ms, collect 19.07s, tests 14.11s, environment 12ms, prepare 32.28s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 21 }, "start": { "column": 3, "line": 21 } }
				},
				{
					"id": "77",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 175ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 115ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 120ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 348ms\n\n   ✓ Audit Logs Database > Table Structure > should have required columns 323ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 709ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 393ms\n\n     → expected '' to contain 'default-src \\'self\\''\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 4ms\n     → expected '' to contain 'frame-ancestors \\'none\\''\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 277ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 1046ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 962ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 191ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 46ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 148ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7569ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2553ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 32ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 23ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 18ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1813ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 854ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nAssertionError: expected '' to contain 'default-src \\'self\\''\n\n- Expected\n+ Received\n\n- default-src 'self'\n\n ❯ tests/unit/lib/security-headers.test.ts:32:16\n\n     30|    const csp = response.headers.get('Content-Security-Policy');\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n       |                ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nAssertionError: expected '' to contain 'frame-ancestors \\'none\\''\n\n\n- Expected\n+ Received\n\n- frame-ancestors 'none'\n\n\n ❯ tests/unit/lib/security-headers.test.ts:144:16\n\n    142|    const csp = response.headers.get('Content-Security-Policy');\n    143| \n    144|    expect(csp).toContain(\"frame-ancestors 'none'\");\n       |                ^\n    145|   });\n    146|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:01:28\n\n   Duration  19.22s (transform 14.35s, setup 0ms, collect 23.06s, tests 12.98s, environment 9ms, prepare 32.96s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 32 }, "start": { "column": 3, "line": 22 } }
				},
				{
					"id": "78",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 128ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 299ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 24ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 249ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 65ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self 11ms\n\n     → expected '; script-src \\'self\\' \\'unsafe-inline…' to contain 'default-src \\'self\\''\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 447ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 978ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 750ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 254ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 190ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 197ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 16ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8241ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3225ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1906ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 843ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set CSP default-src to self\n\nAssertionError: expected '; script-src \\'self\\' \\'unsafe-inline…' to contain 'default-src \\'self\\''\n\n\nExpected: \"default-src 'self'\"\nReceived: \"; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:32:16\n\n     30|    const csp = response.headers.get('Content-Security-Policy');\n     31| \n     32|    expect(csp).toContain(\"default-src 'self'\");\n       |                ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:01:28\n\n   Duration  19.69s (transform 10.65s, setup 0ms, collect 18.26s, tests 13.24s, environment 43ms, prepare 32.08s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 23 }, "start": { "column": 4, "line": 23 } }
				},
				{
					"id": "79",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 466ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 47ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 508ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 795ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 306ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 40ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 212ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 327ms\n\n   ✓ RateLimiter > check > should reset after window expires 309ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 35ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7281ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2266ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1279ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 660ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:01:29\n\n   Duration  19.54s (transform 14.70s, setup 0ms, collect 28.58s, tests 11.25s, environment 26ms, prepare 29.57s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 39, "line": 24 }, "start": { "column": 4, "line": 24 } }
				},
				{
					"id": "80",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 70ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 98ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 287ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 30ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 80ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 100ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 96ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 44ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 48ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 24ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 72ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7447ms\n\n   × Theme Store > Store Structure > should have subscribe method 5014ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2421ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2031ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 728ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:01:47\n\n   Duration  13.12s (transform 7.38s, setup 0ms, collect 11.61s, tests 10.78s, environment 77ms, prepare 20.93s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 38, "line": 25 }, "start": { "column": 4, "line": 25 } }
				},
				{
					"id": "81",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 100ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 222ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 283ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 60ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 112ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 132ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 29ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1700ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 996ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7324ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 2298ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 43ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 17ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:01:49\n\n   Duration  12.82s (transform 5.94s, setup 0ms, collect 10.48s, tests 10.30s, environment 9ms, prepare 22.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 32, "line": 26 }, "start": { "column": 4, "line": 26 } }
				},
				{
					"id": "82",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 27ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 77ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 398ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 147ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 132ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 245ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 60ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 65ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 46ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 48ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 28ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 45ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6743ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1729ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 28ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2258ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1215ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:01:55\n\n   Duration  15.96s (transform 10.29s, setup 0ms, collect 16.64s, tests 10.70s, environment 86ms, prepare 23.75s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 27, "line": 27 }, "start": { "column": 4, "line": 27 } }
				},
				{
					"id": "83",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 50ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 226ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 111ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 161ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 293ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 88ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 84ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8195ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3176ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1881ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 948ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 84ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:01:59\n\n   Duration  16.43s (transform 9.60s, setup 0ms, collect 15.21s, tests 11.58s, environment 9ms, prepare 28.28s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 28 }, "start": { "column": 4, "line": 28 } }
				},
				{
					"id": "84",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 130ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 594ms\n\n   × Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none 105ms\n\n     → expected 'default-src \\'self\\'; script-src \\'se…' to contain 'frame-ancestors \\'none\\''\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 282ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 906ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 538ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 150ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 91ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 63ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 70ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6975ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1962ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2098ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1071ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > CSP frame-ancestors > should set frame-ancestors to none\n\nAssertionError: expected 'default-src \\'self\\'; script-src \\'se…' to contain 'frame-ancestors \\'none\\''\n\n\nExpected: \"frame-ancestors 'none'\"\nReceived: \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'; ; base-uri 'self'; form-action 'self'\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:144:16\n\n    142|    const csp = response.headers.get('Content-Security-Policy');\n    143| \n    144|    expect(csp).toContain(\"frame-ancestors 'none'\");\n       |                ^\n    145|   });\n    146|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:01\n\n   Duration  15.60s (transform 7.48s, setup 0ms, collect 13.52s, tests 11.74s, environment 9ms, prepare 27.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 29 }, "start": { "column": 4, "line": 29 } }
				},
				{
					"id": "85",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 11ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 131ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 433ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 162ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 660ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 631ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 47ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 78ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6807ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1792ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 154ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1427ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 803ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:02:03\n   Duration  15.96s (transform 10.98s, setup 0ms, collect 18.20s, tests 10.31s, environment 8ms, prepare 28.66s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 30 }, "start": { "column": 4, "line": 30 } }
				},
				{
					"id": "87",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 19ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 46ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 120ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 39ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 530ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 284ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 540ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 502ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 166ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 92ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5612ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 585ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 137ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1430ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 727ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 159ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:02:05\n\n   Duration  15.05s (transform 9.21s, setup 0ms, collect 16.04s, tests 9.56s, environment 18ms, prepare 25.91s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 14, "line": 32 }, "start": { "column": 10, "line": 32 } }
				},
				{
					"id": "86",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 113ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 241ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 474ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 358ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 69ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 140ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 241ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 43ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 211ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 51ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6202ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1180ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1368ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 674ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:02:04\n\n   Duration  15.57s (transform 11.62s, setup 0ms, collect 19.98s, tests 9.86s, environment 17ms, prepare 25.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 31 }, "start": { "column": 4, "line": 31 } }
				},
				{
					"id": "88",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 83ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 8ms\n\n     → expected 'max-age=31536000; includeSubDomains' to be null\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 39ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 314ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4238ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4226ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1165ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 584ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nAssertionError: expected 'max-age=31536000; includeSubDomains' to be null\n\n\n- Expected: \nnull\n\n+ Received: \n\"max-age=31536000; includeSubDomains\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:52:62\n\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                                                              ^\n     53|   });\n     54|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:02:19\n\n   Duration  8.43s (transform 4.61s, setup 0ms, collect 6.80s, tests 6.34s, environment 9ms, prepare 15.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "89",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 153ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 19ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 111ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 295ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 132ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 66ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4021ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4009ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 902ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 461ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 26ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 14ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:02:21\n\n   Duration  9.02s (transform 4.04s, setup 0ms, collect 5.92s, tests 6.10s, environment 12ms, prepare 16.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "90",
					"mutatorName": "EqualityOperator",
					"replacement": "event.url.protocol !== 'https:'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 311ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 120ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP 2ms\n\n     → expected 'max-age=31536000; includeSubDomains' to be null\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 239ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 486ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 383ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 24ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 70ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4827ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4818ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 11ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 289ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2460ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1299ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should NOT set HSTS when using HTTP\n\nAssertionError: expected 'max-age=31536000; includeSubDomains' to be null\n\n\n- Expected: \nnull\n\n+ Received: \n\"max-age=31536000; includeSubDomains\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:52:62\n\n     50|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     51| \n     52|    expect(response.headers.get('Strict-Transport-Security')).toBeNull(…\n       |                                                              ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:25\n\n   Duration  11.68s (transform 5.21s, setup 0ms, collect 9.46s, tests 9.17s, environment 9ms, prepare 21.11s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 6, "line": 36 } }
				},
				{
					"id": "91",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 147ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 13ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 88ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 81ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 575ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 523ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 90ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 31ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 194ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 92ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 256ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 168ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 21ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7562ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2545ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1766ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 887ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 11ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:28\n\n   Duration  15.07s (transform 8.83s, setup 0ms, collect 15.43s, tests 11.27s, environment 17ms, prepare 24.79s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 36 }, "start": { "column": 29, "line": 36 } }
				},
				{
					"id": "92",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 74ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 23ms\n\n     → expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 53ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 167ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 340ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 304ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 243ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 266ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 29ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 23ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 33ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7354ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2339ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 79ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2375ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1027ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected null to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected: \n\"max-age=31536000; includeSubDomains\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:29\n\n   Duration  15.02s (transform 7.05s, setup 0ms, collect 12.78s, tests 11.26s, environment 33ms, prepare 24.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 38 }, "start": { "column": 39, "line": 36 } }
				},
				{
					"id": "93",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 124ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 273ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 466ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 333ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 13ms\n\n     → Headers.set: \"\" is an invalid header name.\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 175ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 686ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 548ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 203ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 230ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 176ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 43ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 21ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 27ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1279ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 586ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6686ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1667ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nTypeError: Headers.set: \"\" is an invalid header name.\n\n ❯ Module.securityHeaders src/lib/server/security.ts:81:26\n\n\n ❯ tests/unit/lib/security-headers.test.ts:39:21\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:31\n\n   Duration  14.86s (transform 8.24s, setup 0ms, collect 15.11s, tests 10.59s, environment 10ms, prepare 23.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 51, "line": 37 }, "start": { "column": 24, "line": 37 } }
				},
				{
					"id": "94",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 124ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 655ms\n\n   × Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS 60ms\n\n     → expected '' to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 297ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 412ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 399ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 123ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 96ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5242ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 974ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 572ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > securityHeaders middleware > should set HSTS when using HTTPS\n\nAssertionError: expected '' to be 'max-age=31536000; includeSubDomains' // Object.is equality\n\n\n- Expected\n+ Received\n\n- max-age=31536000; includeSubDomains\n\n\n ❯ tests/unit/lib/security-headers.test.ts:41:62\n\n     39|    const response = await securityHeaders({ event: mockEvent, resolve:…\n     40| \n     41|    expect(response.headers.get('Strict-Transport-Security')).toBe(\n       |                                                              ^\n     42|     'max-age=31536000; includeSubDomains'\n     43|    );\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:33\n\n   Duration  14.20s (transform 7.76s, setup 0ms, collect 15.23s, tests 8.32s, environment 15ms, prepare 23.65s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 90, "line": 37 }, "start": { "column": 53, "line": 37 } }
				},
				{
					"id": "95",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 40ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 4 failed) 586ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 216ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 68ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 2ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 1ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 254ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 352ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 619ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 539ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 142ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6518ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1496ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1251ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 601ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:02:33\n\n   Duration  14.70s (transform 11.60s, setup 0ms, collect 18.84s, tests 10.16s, environment 12ms, prepare 25.09s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 61 }, "start": { "column": 68, "line": 46 } }
				},
				{
					"id": "96",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 121ms\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 15ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 93ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 148ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3072ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3052ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 891ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 428ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 11ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:02:46\n\n   Duration  8.31s (transform 3.60s, setup 0ms, collect 7.13s, tests 4.79s, environment 9ms, prepare 14.56s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 61, "line": 47 }, "start": { "column": 42, "line": 47 } }
				},
				{
					"id": "97",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 33ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 122ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 31ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 1ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 125ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 247ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 70ms\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 142ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4023ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4015ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1051ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 724ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:48\n\n   Duration  9.00s (transform 4.72s, setup 0ms, collect 8.82s, tests 6.25s, environment 7ms, prepare 16.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "98",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 318ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 102ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 120ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 144ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 145ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 79ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5173ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 286ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1864ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1073ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:02:51\n\n   Duration  11.80s (transform 6.19s, setup 0ms, collect 11.72s, tests 8.43s, environment 14ms, prepare 19.76s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "99",
					"mutatorName": "LogicalOperator",
					"replacement": "process.env.NODE_ENV === 'production' || proto === 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 35ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 215ms\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 65ms\n     → expected \"spy\" to be called at least once\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 6ms\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 434ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 420ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 71ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 90ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 24ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 264ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n ✓ tests/unit/lib/security.test.ts (16 tests) 113ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7646ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2625ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 24ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 25ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1886ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 998ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:02:55\n\n   Duration  15.19s (transform 7.83s, setup 0ms, collect 12.25s, tests 11.23s, environment 51ms, prepare 26.65s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "100",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 109ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 314ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 35ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 311ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 191ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 192ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 132ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 70ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 216ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 17ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8425ms\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3404ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1871ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 944ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 215ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:02:55\n\n   Duration  15.89s (transform 10.41s, setup 0ms, collect 15.29s, tests 12.31s, environment 150ms, prepare 26.70s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "101",
					"mutatorName": "EqualityOperator",
					"replacement": "process.env.NODE_ENV !== 'production'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 20ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 39ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 37ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 3 failed) 397ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 6ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development 192ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 1ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 153ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 105ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 504ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 388ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 107ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6764ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1746ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 160ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1016ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 543ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect in development\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:105:24\n\n    103|    await httpsRedirect({ event: mockEvent, resolve: mockResolve });\n    104| \n    105|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n    106| \n    107|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:02:59\n\n   Duration  15.34s (transform 11.73s, setup 0ms, collect 20.57s, tests 9.67s, environment 138ms, prepare 26.22s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 6, "line": 50 } }
				},
				{
					"id": "103",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 351ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 15ms\n\n     → expected \"spy\" to be called at least once\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 487ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 373ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 16ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 56ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 23ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 65ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6844ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1824ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1315ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 601ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:03:00\n\n   Duration  15.64s (transform 12.91s, setup 0ms, collect 16.60s, tests 9.60s, environment 7ms, prepare 26.36s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "102",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 168ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 373ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 592ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 342ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 159ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 66ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 327ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 212ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 97ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 296ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 36ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 72ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 180ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6067ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1011ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 19ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1466ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 777ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:03:01\n\n   Duration  14.67s (transform 8.85s, setup 0ms, collect 15.47s, tests 10.16s, environment 10ms, prepare 22.78s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 43, "line": 50 }, "start": { "column": 31, "line": 50 } }
				},
				{
					"id": "104",
					"mutatorName": "EqualityOperator",
					"replacement": "proto !== 'http'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 32ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 32ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 3 failed) 349ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 10ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS 10ms\n\n     → expected \"spy\" to be called at least once\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 112ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 120ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 115ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 193ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3571ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3562ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1407ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 700ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should NOT redirect when already HTTPS\n\nAssertionError: expected \"spy\" to be called at least once\n\n ❯ tests/unit/lib/security-headers.test.ts:88:24\n\n     86|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     87| \n     88|    expect(mockResolve).toHaveBeenCalled();\n       |                        ^\n     89| \n     90|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:03:13\n\n   Duration  8.95s (transform 4.12s, setup 0ms, collect 8.42s, tests 6.23s, environment 8ms, prepare 14.75s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 47, "line": 50 } }
				},
				{
					"id": "105",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 36ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 43ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 106ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 18ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 47ms\n\n     → Cannot read properties of undefined (reading 'status')\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 326ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 52ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 172ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4371ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4361ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 986ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 495ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 210ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:03:16\n\n   Duration  8.58s (transform 4.60s, setup 0ms, collect 7.88s, tests 6.67s, environment 8ms, prepare 14.21s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 63, "line": 50 }, "start": { "column": 57, "line": 50 } }
				},
				{
					"id": "106",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 49ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 36ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 52ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 6ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 1ms\n\n     → Cannot read properties of undefined (reading 'status')\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 249ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 166ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 22ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3853ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3844ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1405ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 883ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:69:20\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                    ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nTypeError: Cannot read properties of undefined (reading 'status')\n\n ❯ tests/unit/lib/security-headers.test.ts:161:20\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                    ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:03:19\n\n   Duration  9.91s (transform 4.27s, setup 0ms, collect 8.88s, tests 6.25s, environment 11ms, prepare 17.76s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 58 }, "start": { "column": 65, "line": 50 } }
				},
				{
					"id": "107",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 104ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 301ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 26ms\n\n     → expected 'https://http://example.com/path' to be 'https://example.com/path' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 38ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 259ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 509ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 470ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 44ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 49ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 40ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 23ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6627ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1607ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1774ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 782ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 155ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 'https://http://example.com/path' to be 'https://example.com/path' // Object.is equality\n\n\nExpected: \"https://example.com/path\"\nReceived: \"https://http://example.com/path\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:03:23\n\n   Duration  13.95s (transform 8.05s, setup 0ms, collect 13.45s, tests 10.30s, environment 25ms, prepare 21.61s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 58, "line": 51 }, "start": { "column": 49, "line": 51 } }
				},
				{
					"id": "108",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 34ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 229ms\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 35ms\n     → expected 'example.com/path' to be 'https://example.com/path' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 280ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 83ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 53ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 78ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6352ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1338ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 80ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1915ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 781ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 'example.com/path' to be 'https://example.com/path' // Object.is equality\n\n\nExpected: \"https://example.com/path\"\nReceived: \"example.com/path\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:03:25\n\n   Duration  13.63s (transform 8.34s, setup 0ms, collect 15.10s, tests 9.54s, environment 8ms, prepare 23.47s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 70, "line": 51 }, "start": { "column": 60, "line": 51 } }
				},
				{
					"id": "109",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 62ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 62ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 45ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 313ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 77ms\n\n     → expected 200 to be 301 // Object.is equality\n\n   × Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header 2ms\n\n     → expected 200 to be 301 // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 216ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 571ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 376ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 192ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 26ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 145ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 41ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6843ms\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1829ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 99ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1283ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 640ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected 200 to be 301 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 301\n+ 200\n\n\n ❯ tests/unit/lib/security-headers.test.ts:69:28\n\n     67|    const response = await httpsRedirect({ event: mockEvent, resolve: m…\n     68| \n     69|    expect(response.status).toBe(301);\n       |                            ^\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > HTTPS redirect header check > should check x-forwarded-proto header\n\nAssertionError: expected 200 to be 301 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 301\n+ 200\n\n\n ❯ tests/unit/lib/security-headers.test.ts:161:28\n\n    159| \n    160|    const response = await httpsRedirect({ event: mockEvent as unknown,…\n    161|    expect(response.status).toBe(301);\n       |                            ^\n    162| \n    163|    process.env.NODE_ENV = originalEnv;\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:03:27\n\n   Duration  14.81s (transform 10.49s, setup 0ms, collect 17.11s, tests 10.10s, environment 10ms, prepare 25.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 57 }, "start": { "column": 29, "line": 52 } }
				},
				{
					"id": "110",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 114ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 99ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 525ms\n\n   × Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 195ms\n\n     → expected null to be 'https://example.com/path' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 251ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 402ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 119ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 173ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 113ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6319ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1264ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1643ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 724ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 39ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production\n\nAssertionError: expected null to be 'https://example.com/path' // Object.is equality\n\n\n- Expected: \n\"https://example.com/path\"\n\n+ Received: \nnull\n\n\n ❯ tests/unit/lib/security-headers.test.ts:70:45\n\n     68| \n     69|    expect(response.status).toBe(301);\n     70|    expect(response.headers.get('location')).toBe('https://example.com/…\n       |                                             ^\n     71|    expect(mockResolve).not.toHaveBeenCalled();\n     72| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  23:03:28\n\n   Duration  14.85s (transform 10.41s, setup 0ms, collect 17.01s, tests 10.19s, environment 8ms, prepare 25.04s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 5, "line": 56 }, "start": { "column": 13, "line": 54 } }
				},
				{
					"id": "111",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 184ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 313ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 220ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 17ms\n\n     → expected undefined to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 3ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 1ms\n\n     → Cannot read properties of undefined (reading 'trim')\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 436ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 9 failed) 124ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 11ms\n\n     → expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected undefined to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 1ms\n\n     → expected undefined to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 1ms\n\n     → expected undefined to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 1ms\n\n     → expected undefined to be 'Hello World' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle empty string 0ms\n\n     → expected undefined to be '' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 407ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 55ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 25ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 30ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 21ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6042ms\n\n   × Theme Store > Store Structure > should have subscribe method 5019ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1010ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1529ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 806ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 83ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 16 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected undefined to be '' // Object.is equality\n\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/16]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/16]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/16]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/16]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/16]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nTypeError: Cannot read properties of undefined (reading 'trim')\n\n ❯ tests/unit/lib/security-complete.test.ts:55:18\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                  ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/16]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected undefined to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\n- Expected: \n\"scriptalert(\\\"xss\\\")/script\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/16]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected undefined to be 'testtest' // Object.is equality\n\n- Expected: \n\"testtest\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/16]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/16]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/16]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected undefined to be 'alert(1)' // Object.is equality\n\n- Expected: \n\"alert(1)\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/16]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected undefined to be 'test' // Object.is equality\n\n\n- Expected: \n\"test\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/16]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected undefined to be 'Hello World' // Object.is equality\n\n\n- Expected: \n\"Hello World\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/16]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle empty string\n\nAssertionError: expected undefined to be '' // Object.is equality\n\n\n- Expected: \n\"\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:43:30\n\n     41| \n     42|   it('should handle empty string', () => {\n     43|    expect(sanitizeInput('')).toBe('');\n       |                              ^\n     44|   });\n     45| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/16]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/16]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/16]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  16 failed | 510 passed (526)\n\n   Start at  23:03:29\n\n   Duration  14.17s (transform 8.19s, setup 0ms, collect 14.26s, tests 9.83s, environment 113ms, prepare 22.13s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 82 }, "start": { "column": 54, "line": 66 } }
				},
				{
					"id": "112",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 25ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 11ms\n\n     → expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected 'test<>test' to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 1ms\n\n     → expected '<script>alert(\"xss\")</script>' not to contain '<'\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 27ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 8ms\n\n     → expected '<' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 6ms\n\n     → expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 34ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 385ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 144ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 338ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 324ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 35ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3671ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3656ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1248ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 591ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 32ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<script>alert(1)</script>' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<script>alert(1)</script>\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected '<script>alert(\"xss\")</script>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected 'test<>test' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"test<>test\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected '<script>alert(\"xss\")</script>' not to contain '<'\n\n\nExpected: \"<\"\nReceived: \"<script>alert(\"xss\")</script>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:03:40\n\n   Duration  9.54s (transform 5.43s, setup 0ms, collect 10.42s, tests 6.32s, environment 11ms, prepare 16.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "114",
					"mutatorName": "Regex",
					"replacement": "/[^<>]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 124ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 138ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 11ms\n\n     → expected '<' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 2ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected '' to be 'test' // Object.is equality\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 1ms\n     → expected '' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 60ms\n\n     → expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 8 failed) 72ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 29ms\n\n     → expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected '<>' to be 'testtest' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 1ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 1ms\n\n     → expected '' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 1ms\n\n     → expected '' to be 'test' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle normal text 1ms\n\n     → expected '' to be 'Hello World' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 1ms\n\n     → expected '<><>' not to contain '<'\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 177ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 305ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4043ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4023ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 20ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1602ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 776ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected '<' to be '' // Object.is equality\n\n\n- Expected\n+ Received\n\n+ <\n\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected '<><>' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"<><>\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\nAssertionError: expected '<><>' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"<><>\"\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\n\nAssertionError: expected '<>' to be 'testtest' // Object.is equality\n\n\nExpected: \"testtest\"\nReceived: \"<>\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected '' to be 'alert(1)' // Object.is equality\n\n\n- Expected\n+ Received\n\n- alert(1)\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected '' to be 'test' // Object.is equality\n\n- Expected\n+ Received\n\n- test\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle normal text\n\nAssertionError: expected '' to be 'Hello World' // Object.is equality\n\n- Expected\n+ Received\n\n- Hello World\n\n\n ❯ tests/unit/lib/security-extended.test.ts:39:41\n\n     37| \n     38|   it('should handle normal text', () => {\n     39|    expect(sanitizeInput('Hello World')).toBe('Hello World');\n       |                                         ^\n     40|   });\n     41| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected '<><>' not to contain '<'\n\nExpected: \"<\"\nReceived: \"<><>\"\n\n ❯ tests/unit/lib/security-extended.test.ts:49:23\n\n     47|    const malicious = '<script>javascript:onclick=alert(\"xss\")</script>…\n     48|    const result = sanitizeInput(malicious);\n     49|    expect(result).not.toContain('<');\n       |                       ^\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  13 failed | 513 passed (526)\n\n   Start at  23:03:46\n\n   Duration  10.60s (transform 5.17s, setup 0ms, collect 9.77s, tests 6.90s, environment 9ms, prepare 17.39s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 61, "line": 70 }, "start": { "column": 54, "line": 70 } }
				},
				{
					"id": "115",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 50ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 148ms\n\n   × Security Extended Tests > sanitizeInput > should remove HTML tags 41ms\n\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should remove angle brackets 2ms\n\n     → expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 70ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or > 17ms\n\n     → expected 'Stryker was here!' to be '' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 4ms\n\n     → expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 317ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 367ms\n\n   ✓ RateLimiter - Complete Coverage > getClientId > should extract IP from x-forwarded-for 342ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 202ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 451ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 437ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 259ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7323ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2308ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 20ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2086ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 909ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 41ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 14ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with only < or >\n\nAssertionError: expected 'Stryker was here!' to be '' // Object.is equality\n\n- Expected\n+ Received\n\n+ Stryker was here!\n\n ❯ tests/unit/lib/security-complete.test.ts:15:31\n\n     13|  describe('sanitizeInput - all branches', () => {\n     14|   it('should handle strings with only < or >', () => {\n     15|    expect(sanitizeInput('<')).toBe('');\n       |                               ^\n     16|    expect(sanitizeInput('>')).toBe('');\n     17|    expect(sanitizeInput('<><><>')).toBe('');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(1)Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove HTML tags\n\nAssertionError: expected 'Stryker was here!scriptStryker was he…' to be 'scriptalert(\"xss\")/script' // Object.is equality\n\n\nExpected: \"scriptalert(\"xss\")/script\"\nReceived: \"Stryker was here!scriptStryker was here!alert(\"xss\")Stryker was here!/scriptStryker was here!\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:13:59\n\n     11|  describe('sanitizeInput', () => {\n     12|   it('should remove HTML tags', () => {\n     13|    expect(sanitizeInput('<script>alert(\"xss\")</script>')).toBe('script…\n       |                                                           ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove angle brackets\nAssertionError: expected 'testStryker was here!Stryker was here…' to be 'testtest' // Object.is equality\n\nExpected: \"testtest\"\nReceived: \"testStryker was here!Stryker was here!test\"\n\n ❯ tests/unit/lib/security-extended.test.ts:17:40\n     15| \n     16|   it('should remove angle brackets', () => {\n     17|    expect(sanitizeInput('test<>test')).toBe('testtest');\n       |                                        ^\n     18|   });\n     19| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  5 failed | 521 passed (526)\n   Start at  23:03:51\n\n   Duration  15.51s (transform 8.98s, setup 0ms, collect 14.64s, tests 11.56s, environment 26ms, prepare 26.04s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 70 }, "start": { "column": 63, "line": 70 } }
				},
				{
					"id": "116",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 233ms\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 16ms\n\n     → expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 150ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 32ms\n\n     → expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 191ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 330ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 631ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 444ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 106ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 21ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7363ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2345ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 182ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 32ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1977ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 772ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptjavascript:alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptjavascript:alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptjavascript:alert(\"xss\")/script' not to contain 'javascript:'\n\nExpected: \"javascript:\"\nReceived: \"scriptjavascript:alert(\"xss\")/script\"\n\n ❯ tests/unit/lib/security-extended.test.ts:51:23\n\n     49|    expect(result).not.toContain('<');\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n       |                       ^\n     52|    expect(result).not.toContain('onclick=');\n     53|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  3 failed | 523 passed (526)\n   Start at  23:03:52\n\n   Duration  14.69s (transform 7.87s, setup 0ms, collect 13.46s, tests 11.64s, environment 18ms, prepare 24.26s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "118",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 3 failed) 292ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times 59ms\n\n     → expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript 1ms\n\n     → expected 'Stryker was here!test' to be 'test' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 1ms\n\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 436ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 301ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 119ms\n\n   × Security Extended Tests > sanitizeInput > should remove javascript protocol 34ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should be case insensitive for javascript 1ms\n\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 217ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 387ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 371ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 28ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6489ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1471ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1559ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 521ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle strings with javascript: multiple times\n\nAssertionError: expected 'Stryker was here!Stryker was here!test' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"Stryker was here!Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:21:56\n\n     19| \n     20|   it('should handle strings with javascript: multiple times', () => {\n     21|    expect(sanitizeInput('javascript:javascript:test')).toBe('test');\n       |                                                        ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle mixed case javascript\n\nAssertionError: expected 'Stryker was here!test' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"Stryker was here!test\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:25:45\n\n     23| \n     24|   it('should handle mixed case javascript', () => {\n     25|    expect(sanitizeInput('JAVASCRIPT:test')).toBe('test');\n       |                                             ^\n     26|    expect(sanitizeInput('JavaScript:test')).toBe('test');\n     27|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove javascript protocol\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:21:49\n\n     19| \n     20|   it('should remove javascript protocol', () => {\n     21|    expect(sanitizeInput('javascript:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should be case insensitive for javascript\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:25:49\n\n     23| \n     24|   it('should be case insensitive for javascript', () => {\n     25|    expect(sanitizeInput('JaVaScRiPt:alert(1)')).toBe('alert(1)');\n       |                                                 ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:03:56\n\n   Duration  15.17s (transform 9.85s, setup 0ms, collect 14.41s, tests 9.95s, environment 35ms, prepare 27.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 73, "line": 73 }, "start": { "column": 71, "line": 73 } }
				},
				{
					"id": "119",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 208ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 95ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 652ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 401ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 324ms\n   ✓ Utility Functions > chunk calculations > should handle file smaller than chunk size 304ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 52ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6811ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1788ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1667ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 950ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:03:57\n\n   Duration  15.22s (transform 9.04s, setup 0ms, collect 15.67s, tests 10.24s, environment 18ms, prepare 25.86s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 75, "line": 76 }, "start": { "column": 73, "line": 76 } }
				},
				{
					"id": "120",
					"mutatorName": "Regex",
					"replacement": "/\\son\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 137ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 43ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 27ms\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 8ms\n     → expected 'onclick=alert()' not to contain 'onclick='\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 2ms\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 190ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 244ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 183ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3582ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3574ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 937ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 444ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:04:07\n\n   Duration  9.87s (transform 7.04s, setup 0ms, collect 11.72s, tests 5.58s, environment 10ms, prepare 16.85s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "121",
					"mutatorName": "Regex",
					"replacement": "/\\S*on\\w+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 149ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 41ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 52ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 9ms\n\n     → expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 164ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 140ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3259ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3249ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1348ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 614ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:04:14\n\n   Duration  7.89s (transform 4.18s, setup 0ms, collect 7.66s, tests 5.55s, environment 10ms, prepare 13.56s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "123",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\W+\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 52ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 48ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 18ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 19ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 50ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 10ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 6ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 275ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 179ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 70ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 26ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5721ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 707ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 89ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2115ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1032ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:04:19\n\n   Duration  12.81s (transform 8.09s, setup 0ms, collect 14.41s, tests 8.90s, environment 21ms, prepare 21.15s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "122",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w\\s*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 93ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 11ms\n\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 2ms\n\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 117ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 8ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 2ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 59ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 304ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 133ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 544ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 501ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 68ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 185ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6668ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1629ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1933ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 940ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:04:19\n\n   Duration  12.81s (transform 7.81s, setup 0ms, collect 11.77s, tests 10.48s, environment 23ms, prepare 20.83s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "125",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\S*=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 91ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 155ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 413ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 430ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 367ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 44ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 183ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6159ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1138ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1245ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 597ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 45ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:04:23\n\n   Duration  13.07s (transform 7.24s, setup 0ms, collect 13.94s, tests 9.07s, environment 8ms, prepare 22.86s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "124",
					"mutatorName": "Regex",
					"replacement": "/\\s*on\\w+\\s=/gi",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 117ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 99ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers 43ms\n\n     → expected 'onclick=alert()' not to contain 'onclick='\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 15ms\n\n     → expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 38ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 13ms\n     → expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n   × Security Extended Tests > sanitizeInput > should handle multiple threats at once 3ms\n     → expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 361ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 442ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 369ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 66ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 183ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5491ms\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 478ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1075ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 608ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 156ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle all event handlers\n\nAssertionError: expected 'onclick=alert()' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"onclick=alert()\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:43:24\n\n     41|    handlers.forEach((handler) => {\n     42|     const result = sanitizeInput(handler + 'alert()');\n     43|     expect(result).not.toContain(handler);\n       |                        ^\n     44|    });\n     45|   });\n\n ❯ tests/unit/lib/security-complete.test.ts:41:13\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptonclick=alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptonclick=alert(1)/script\"\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'onclick=alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"onclick=alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should handle multiple threats at once\n\nAssertionError: expected 'scriptonclick=alert(\"xss\")/script' not to contain 'onclick='\n\n\nExpected: \"onclick=\"\nReceived: \"scriptonclick=alert(\"xss\")/script\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:52:23\n\n     50|    expect(result).not.toContain('>');\n     51|    expect(result).not.toContain('javascript:');\n     52|    expect(result).not.toContain('onclick=');\n       |                       ^\n     53|   });\n     54|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:04:23\n\n   Duration  13.48s (transform 8.72s, setup 0ms, collect 13.17s, tests 8.26s, environment 9ms, prepare 22.59s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 48, "line": 79 }, "start": { "column": 32, "line": 79 } }
				},
				{
					"id": "126",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 18ms\n\n   × Security Extended Tests > sanitizeInput > should remove event handlers 7ms\n     → expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 42ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 41ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization 21ms\n\n     → expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 198ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 131ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3338ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3328ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 879ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 435ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should handle combined sanitization\n\nAssertionError: expected 'scriptStryker was here!alert(1)/script' to be 'scriptalert(1)/script' // Object.is equality\n\n\nExpected: \"scriptalert(1)/script\"\nReceived: \"scriptStryker was here!alert(1)/script\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:55:26\n\n     53|    const malicious = '  <script>javascript:onclick=alert(1)</script>  …\n     54|    const result = sanitizeInput(malicious);\n     55|    expect(result.trim()).toBe('scriptalert(1)/script');\n       |                          ^\n     56|   });\n     57|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should remove event handlers\n\nAssertionError: expected 'Stryker was here!alert(1)' to be 'alert(1)' // Object.is equality\n\n\nExpected: \"alert(1)\"\nReceived: \"Stryker was here!alert(1)\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:29:46\n\n     27| \n     28|   it('should remove event handlers', () => {\n     29|    expect(sanitizeInput('onclick=alert(1)')).toBe('alert(1)');\n       |                                              ^\n     30|    expect(sanitizeInput('onload=bad()')).toBe('bad()');\n     31|    expect(sanitizeInput('onerror=hack()')).toBe('hack()');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:04:32\n\n   Duration  9.26s (transform 6.41s, setup 0ms, collect 11.33s, tests 5.06s, environment 7ms, prepare 15.14s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 79 }, "start": { "column": 50, "line": 79 } }
				},
				{
					"id": "127",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 58ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 35ms\n\n   × Security Extended Tests > sanitizeInput > should trim whitespace 10ms\n\n     → expected '  test  ' to be 'test' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 23ms\n\n   × Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace 8ms\n\n     → expected '   test   ' to be 'test' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 146ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 157ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 252ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 15ms\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3955ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3940ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1304ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 808ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeInput - all branches > should trim leading and trailing whitespace\n\nAssertionError: expected '   test   ' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"   test   \"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:48:40\n\n     46| \n     47|   it('should trim leading and trailing whitespace', () => {\n     48|    expect(sanitizeInput('   test   ')).toBe('test');\n       |                                        ^\n     49|    expect(sanitizeInput('\\t\\ntest\\n\\t')).toBe('test');\n     50|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > sanitizeInput > should trim whitespace\n\nAssertionError: expected '  test  ' to be 'test' // Object.is equality\n\n\nExpected: \"test\"\nReceived: \"  test  \"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:35:38\n\n     33| \n     34|   it('should trim whitespace', () => {\n     35|    expect(sanitizeInput('  test  ')).toBe('test');\n       |                                      ^\n     36|   });\n     37| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:04:38\n\n   Duration  8.86s (transform 5.10s, setup 0ms, collect 8.61s, tests 6.31s, environment 9ms, prepare 14.22s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 81 }, "start": { "column": 9, "line": 81 } }
				},
				{
					"id": "128",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 54ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 10ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected undefined to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected undefined to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected undefined to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 101ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 42ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 3ms\n\n     → expected undefined to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected undefined to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 0ms\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 16ms\n\n     → expected undefined to be '_' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 7 failed) 475ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 58ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 68ms\n\n     → expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 4ms\n\n     → expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255 1ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 1ms\n\n     → Cannot read properties of undefined (reading 'length')\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 158ms\n\n     → expected undefined to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 1ms\n\n     → expected undefined to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 348ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 53ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 34ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 212ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 187ms\n     → expected undefined to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 11ms\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected undefined to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected undefined to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 0ms\n     → Cannot read properties of undefined (reading 'length')\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 6 failed) 80ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 59ms\n     → expected undefined to be 'document.pdf' // Object.is equality\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts 8ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 2ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 1ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6011ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 987ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 24ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 17ms\n     → expected undefined to be 'test.txt' // Object.is equality\n   × Security - Real Import Tests > sanitizeFilename > should remove path traversal 3ms\n\n     → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 282ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 117ms\n     → expected undefined to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 10ms\n\n     → expected undefined to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected undefined to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 135ms\n\n     → expected undefined to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 8ms\n\n     → expected undefined to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 8ms\n\n     → expected undefined to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected undefined to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n\n     → Cannot read properties of undefined (reading 'length')\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1845ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 869ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 20ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 40 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected undefined to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/40]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected undefined to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected undefined to be 'file.txt' // Object.is equality\n\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/40]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-behavior.test.ts:38:18\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected undefined to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected undefined to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-complete.test.ts:79:18\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                  ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-complete.test.ts:85:18\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/40]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected undefined to be '_' // Object.is equality\n\n\n- Expected: \n\"_\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove path traversal attempts\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:13:23\n\n     11|   it('should remove path traversal attempts', () => {\n     12|    const result = sanitizeFilename('../../../etc/passwd');\n     13|    expect(result).not.toContain('..');\n       |                       ^\n     14|   });\n     15| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle nested path traversal\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:18:23\n\n     16|   it('should handle nested path traversal', () => {\n     17|    const result = sanitizeFilename('../../.../../evil');\n     18|    expect(result).not.toContain('..');\n       |                       ^\n     19|   });\n     20| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/40]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/40]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:33:23\n\n     31|   it('should handle multiple dangerous chars', () => {\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n       |                       ^\n     34|    expect(result).not.toContain('/');\n     35|    expect(result).not.toContain('\\\\');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-extended.test.ts:60:18\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected undefined to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected undefined to be '文件.pdf' // Object.is equality\n\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/40]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected undefined to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-headers.test.ts:115:18\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected undefined to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/40]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255\nTypeError: Cannot read properties of undefined (reading 'length')\n ❯ tests/unit/lib/security-headers.test.ts:170:38\n\n    168|   it('should truncate ONLY when > 255', () => {\n    169|    const exactly255 = 'a'.repeat(251) + '.txt';\n    170|    expect(sanitizeFilename(exactly255).length).toBe(255);\n       |                                      ^\n    171|    expect(sanitizeFilename(exactly255)).toBe(exactly255);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security-headers.test.ts:177:18\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                  ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected undefined to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/40]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected undefined to be 'file.' // Object.is equality\n\n\n- Expected: \n\"file.\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\nAssertionError: expected undefined to be 'test.txt' // Object.is equality\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/40]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should remove path traversal\n\nAssertionError: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string\n ❯ tests/unit/lib/security-real-import.test.ts:14:23\n     12|   it('should remove path traversal', () => {\n     13|    const result = sanitizeFilename('../../../etc/passwd');\n     14|    expect(result).not.toContain('..');\n       |                       ^\n     15|   });\n     16|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\nAssertionError: expected undefined to be '___etc_passwd' // Object.is equality\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:12:52\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/40]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected undefined to be 'path_to_file.txt' // Object.is equality\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected undefined to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: Cannot read properties of undefined (reading 'length')\n\n ❯ tests/unit/lib/security.test.ts:30:18\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                  ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/40]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected undefined to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/40]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/40]⎯\n\n\n Test Files  8 failed | 24 passed (32)\n\n      Tests  40 failed | 486 passed (526)\n\n   Start at  23:04:43\n\n   Duration  12.70s (transform 7.64s, setup 0ms, collect 12.33s, tests 9.93s, environment 31ms, prepare 19.95s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 102 }, "start": { "column": 60, "line": 87 } }
				},
				{
					"id": "129",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 38ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 10ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 118ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 196ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 379ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 335ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 25ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 15ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 157ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 40ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 16ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 24ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 19ms\n\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5291ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 51ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 46ms\n\n     → expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n     → expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 142ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1512ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 633ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'Stryker was here!' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \"Stryker was here!\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'Stryker was here!_Stryker was here!_S…' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"Stryker was here!_Stryker was here!_Stryker was here!_etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:04:44\n\n   Duration  12.86s (transform 6.65s, setup 0ms, collect 14.22s, tests 8.20s, environment 12ms, prepare 24.36s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 46, "line": 89 }, "start": { "column": 44, "line": 89 } }
				},
				{
					"id": "130",
					"mutatorName": "Regex",
					"replacement": "/[^/\\\\]/g",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 65ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 33ms\n     → expected '___' to be 'abc' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n     → expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 6ms\n     → expected '______' to be 'README' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n     → expected 279 to be less than or equal to 255\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected '/' to be '_' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 7 failed) 644ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 11ms\n\n     → expected 261 to be less than or equal to 255\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 105ms\n\n     → expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 191ms\n\n     → expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255 3ms\n\n     → expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 2ms\n\n     → expected 257 to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 4ms\n\n     → expected '______' to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 44ms\n\n     → expected '_____' to be 'file.' // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 55ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 37ms\n\n     → expected 305 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 4ms\n\n     → expected '___________' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '______' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected '___________' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 83ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 82ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 387ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 365ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4743ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4731ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 113ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 18ms\n\n     → expected '____________' to be 'document.pdf' // Object.is equality\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes 2ms\n\n     → expected '____/__/________' not to contain '/'\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes 1ms\n\n     → expected '__\\_______\\________' not to contain '\\'\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars 12ms\n\n     → expected '/____\\__///____' not to contain '/'\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 195ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 30ms\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected '____________' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n\n     → expected 305 to be less than or equal to 255\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 6 failed) 305ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 200ms\n     → expected '_/_' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 2ms\n\n     → expected '_\\_' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n     → expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n     → expected '///' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 96ms\n\n     → expected '________' to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n\n     → expected 305 to be less than or equal to 255\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 213ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 8ms\n     → expected '________' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1398ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 623ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 32 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected '_/_' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"_/_\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected '_\\_' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"_\\_\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '///' to be '___' // Object.is equality\n\n\nExpected: \"___\"\nReceived: \"///\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected '________' to be 'file.txt' // Object.is equality\n\n\nExpected: \"file.txt\"\nReceived: \"________\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/32]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 305 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected '___' to be 'abc' // Object.is equality\n\nExpected: \"abc\"\nReceived: \"___\"\n\n ❯ tests/unit/lib/security-complete.test.ts:63:40\n\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n       |                                        ^\n     64|   });\n     65| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected '_/_/_/_' to be 'a_b_c_d' // Object.is equality\n\nExpected: \"a_b_c_d\"\nReceived: \"_/_/_/_\"\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected '______' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"______\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\nAssertionError: expected 279 to be less than or equal to 255\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\nAssertionError: expected '/' to be '_' // Object.is equality\n\nExpected: \"_\"\nReceived: \"/\"\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/32]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove forward slashes\n\nAssertionError: expected '____/__/________' not to contain '/'\n\n\nExpected: \"/\"\nReceived: \"____/__/________\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:23:23\n\n     21|   it('should remove forward slashes', () => {\n     22|    const result = sanitizeFilename('path/to/file.txt');\n     23|    expect(result).not.toContain('/');\n       |                       ^\n     24|   });\n     25| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should remove backslashes\n\nAssertionError: expected '__\\_______\\________' not to contain '\\'\n\nExpected: \"\\\"\nReceived: \"__\\_______\\________\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:28:23\n\n     26|   it('should remove backslashes', () => {\n     27|    const result = sanitizeFilename('C:\\\\Windows\\\\file.exe');\n     28|    expect(result).not.toContain('\\\\');\n       |                       ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/32]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should handle multiple dangerous chars\nAssertionError: expected '/____\\__///____' not to contain '/'\n\nExpected: \"/\"\nReceived: \"/____\\__///____\"\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:34:23\n\n     32|    const result = sanitizeFilename('../path\\\\to/../../file');\n     33|    expect(result).not.toContain('..');\n     34|    expect(result).not.toContain('/');\n       |                       ^\n     35|    expect(result).not.toContain('\\\\');\n     36|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 305 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/32]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected '___________' to be 'file.tar.gz' // Object.is equality\n\nExpected: \"file.tar.gz\"\nReceived: \"___________\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '______' to be '文件.pdf' // Object.is equality\n\nExpected: \"文件.pdf\"\nReceived: \"______\"\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected '___________' to be 'my file.txt' // Object.is equality\n\nExpected: \"my file.txt\"\nReceived: \"___________\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/32]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"_______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255\n\nAssertionError: expected '_____________________________________…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"_______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:171:41\n\n    169|    const exactly255 = 'a'.repeat(251) + '.txt';\n    170|    expect(sanitizeFilename(exactly255).length).toBe(255);\n    171|    expect(sanitizeFilename(exactly255)).toBe(exactly255);\n       |                                         ^\n    172|   });\n    173| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 257 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 257\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected '______' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"______\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected '_____' to be 'file.' // Object.is equality\n\n\nExpected: \"file.\"\nReceived: \"_____\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/32]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected '________' to be 'test.txt' // Object.is equality\n\n\nExpected: \"test.txt\"\nReceived: \"________\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '///___/______' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"///___/______\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected '____/__/________' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"____/__/________\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected '____\\__\\________' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"____\\__\\________\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected '____________' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"____________\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 305 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/32]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n\n      Tests  32 failed | 494 passed (526)\n\n   Start at  23:04:46\n\n   Duration  12.86s (transform 7.49s, setup 0ms, collect 12.94s, tests 8.64s, environment 14ms, prepare 22.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 40, "line": 92 }, "start": { "column": 32, "line": 92 } }
				},
				{
					"id": "131",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 123ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 11ms\n\n     → expected 'abcd' to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 82ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 422ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 152ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 320ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 590ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 360ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 118ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 156ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 260ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 113ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 29ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 92ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 24ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 13ms\n\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6302ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1285ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 4 failed) 223ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 7ms\n     → expected 'ab' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 6ms\n\n     → expected 'ab' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 205ms\n\n     → expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 2ms\n\n     → expected 'unnamed_file' to be '___' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1181ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 606ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 10 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/10]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'ab' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"ab\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/10]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/10]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/10]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'abcd' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"abcd\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/10]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/10]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'etcpasswd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"etcpasswd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/10]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/10]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\nAssertionError: expected 'pathtofile.txt' to be 'path_to_file.txt' // Object.is equality\n\nExpected: \"path_to_file.txt\"\nReceived: \"pathtofile.txt\"\n\n ❯ tests/unit/lib/security.test.ts:20:51\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/10]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/10]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  10 failed | 516 passed (526)\n\n   Start at  23:04:47\n\n   Duration  13.54s (transform 6.75s, setup 0ms, collect 10.48s, tests 10.46s, environment 19ms, prepare 20.79s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 92 }, "start": { "column": 42, "line": 92 } }
				},
				{
					"id": "132",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 34ms\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 8ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 3 failed) 188ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 19ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 1ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 3ms\n\n     → expected 'file..' to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 76ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 11ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 2ms\n\n     → expected 255 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 13ms\n\n     → expected '_._' to be '_' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 201ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 25ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 16ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 202ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 8ms\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 4ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 177ms\n\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3010ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2999ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 7 failed) 103ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 8ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 1ms\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 89ms\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n     → expected '___.___' to be '___' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 607ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 235ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 10ms\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 58ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 25 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/25]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/25]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/25]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/25]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/25]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 255 to be 254 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/25]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '_._' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"_._\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/25]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/25]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/25]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/25]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/25]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa..txt\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/25]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/25]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected 'file..' to be 'file.' // Object.is equality\n\nExpected: \"file.\"\nReceived: \"file..\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/25]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/25]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/25]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/25]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/25]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/25]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/25]⎯\n\n\n Test Files  7 failed | 25 passed (32)\n      Tests  25 failed | 501 passed (526)\n   Start at  23:04:56\n\n   Duration  8.36s (transform 5.01s, setup 0ms, collect 7.79s, tests 5.15s, environment 9ms, prepare 14.24s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "133",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 18ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 21ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 7ms\n\n     → expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 81ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 9ms\n\n     → expected 260 to be less than or equal to 255\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 23ms\n\n     → expected 256 to be 255 // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 33ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 287ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 73ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 6ms\n\n     → expected 304 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3602ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3589ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 21ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 15ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 775ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 400ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 260 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 256 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 256\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:05:02\n\n   Duration  9.27s (transform 6.10s, setup 0ms, collect 10.62s, tests 5.29s, environment 8ms, prepare 13.87s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "134",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length >= 255",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "135",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized.length <= 255",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 94ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 71ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 72ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 304 to be less than or equal to 255\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 2ms\n\n     → expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 189ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 10ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n\n     → expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 15ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 4ms\n\n     → expected 255 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n\n     → expected 278 to be less than or equal to 255\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 56ms\n\n     → expected '_._' to be '_' // Object.is equality\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 5 failed) 434ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 11ms\n\n     → expected 260 to be less than or equal to 255\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 4ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 2ms\n\n     → expected 256 to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 1ms\n\n     → expected 'README.README' to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 195ms\n\n     → expected 'file..' to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 276ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 27ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 105ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 400ms\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 97ms\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n     → expected 304 to be less than or equal to 255\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 85ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 131ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 118ms\n     → expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6413ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1399ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 238ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 8ms\n\n     → expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 125ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 22ms\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 6ms\n\n     → expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected '___.___' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 90ms\n\n     → expected '.' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 1ms\n\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2082ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 898ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 32 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'a_b.a_b' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"a_b.a_b\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected '___.___' to be '___' // Object.is equality\n\n\nExpected: \"___\"\nReceived: \"___.___\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'file.txt.txt' to be 'file.txt' // Object.is equality\n\n\nExpected: \"file.txt\"\nReceived: \"file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/32]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'a_b_c_d.a_b_c_d' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"a_b_c_d.a_b_c_d\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/32]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 255 to be 254 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 254\n+ 255\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/32]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '_._' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"_._\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/32]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'file.tar.gz.gz' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"file.tar.gz.gz\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected '文件.pdf.pdf' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"文件.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/32]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'my file.txt.txt' to be 'my file.txt' // Object.is equality\n\n\nExpected: \"my file.txt\"\nReceived: \"my file.txt.txt\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/32]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 260 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa..txt\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 256 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 256\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected 'README.README' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"README.README\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/32]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected 'file..' to be 'file.' // Object.is equality\n\n\nExpected: \"file.\"\nReceived: \"file..\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/32]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'test.txt.txt' to be 'test.txt' // Object.is equality\n\n\nExpected: \"test.txt\"\nReceived: \"test.txt.txt\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected '___etc_passwd.___etc_passwd' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"___etc_passwd.___etc_passwd\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/32]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'path_to_file.txt.txt' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"path_to_file.txt.txt\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'document.pdf.pdf' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"document.pdf.pdf\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/32]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '.' to be 'unnamed_file' // Object.is equality\n\n\nExpected: \"unnamed_file\"\nReceived: \".\"\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/32]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/32]⎯\n\n\n Test Files  8 failed | 24 passed (32)\n\n      Tests  32 failed | 494 passed (526)\n\n   Start at  23:05:08\n\n   Duration  14.58s (transform 9.29s, setup 0ms, collect 18.65s, tests 11.00s, environment 16ms, prepare 23.09s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 28, "line": 95 }, "start": { "column": 6, "line": 95 } }
				},
				{
					"id": "136",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 18ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 20ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 6ms\n\n     → expected 278 to be less than or equal to 255\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 64ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 106ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 422ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 87ms\n\n     → expected 260 to be less than or equal to 255\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 21ms\n\n     → expected 256 to be 255 // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 543ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 494ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 165ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 23ms\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 6ms\n     → expected 304 to be less than or equal to 255\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6715ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1701ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 17ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 12ms\n     → expected 304 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1539ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 759ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 278 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 260 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 256 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 256\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 304 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:05:09\n\n   Duration  13.88s (transform 8.56s, setup 0ms, collect 14.53s, tests 9.99s, environment 34ms, prepare 21.94s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 99 }, "start": { "column": 30, "line": 95 } }
				},
				{
					"id": "137",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 135ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 27ms\n\n     → expected '.true' to contain '.txt'\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 369ms\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 65ms\n\n     → expected 5 to be 255 // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 101ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 577ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 551ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 56ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 50ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 223ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6340ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1292ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 251ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 246ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1311ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 507ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected '.true' to contain '.txt'\n\nExpected: \".txt\"\nReceived: \".true\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 5 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 5\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:05:10\n\n   Duration  14.11s (transform 9.13s, setup 0ms, collect 15.46s, tests 9.79s, environment 9ms, prepare 23.32s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "138",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 99ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 30ms\n\n     → expected '.false' to contain '.txt'\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 288ms\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 102ms\n\n     → expected 6 to be 255 // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 124ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 268ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 73ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 14ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 8ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3576ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3559ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 902ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 349ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected '.false' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \".false\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 6 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 6\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:05:19\n\n   Duration  9.66s (transform 5.96s, setup 0ms, collect 12.18s, tests 5.74s, environment 7ms, prepare 14.95s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "139",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized.split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 25ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 11ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 117ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 118ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3650ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3636ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 65ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 59ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1082ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 541ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:05:27\n\n   Duration  8.54s (transform 3.79s, setup 0ms, collect 8.10s, tests 5.50s, environment 11ms, prepare 13.46s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 15, "line": 96 } }
				},
				{
					"id": "140",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 33ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 21ms\n\n     → expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 129ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 519ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 233ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 24ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 132ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 19ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5726ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 711ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 204ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 191ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 62ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1727ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 899ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.t\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:05:31\n\n   Duration  12.10s (transform 6.26s, setup 0ms, collect 11.48s, tests 9.13s, environment 8ms, prepare 21.08s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 34, "line": 96 }, "start": { "column": 31, "line": 96 } }
				},
				{
					"id": "141",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 44ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 24ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 180ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 78ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 49ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 33ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 65ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 54ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6031ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1018ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 19ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1476ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 677ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:05:33\n\n   Duration  13.44s (transform 10.32s, setup 0ms, collect 18.27s, tests 8.45s, environment 13ms, prepare 22.28s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 47, "line": 96 }, "start": { "column": 45, "line": 96 } }
				},
				{
					"id": "143",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 - ext.length + 1",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 23ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 9ms\n\n     → expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 40ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 7ms\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 231ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 299ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 53ms\n\n     → expected 257 to be less than or equal to 255\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 4ms\n     → expected 257 to be 255 // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 363ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 344ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 28ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 35ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 183ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 33ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 5ms\n\n     → expected 257 to be less than or equal to 255\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5733ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 716ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 112ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 105ms\n     → expected 257 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1987ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 918ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 109ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\nAssertionError: expected 257 to be less than or equal to 255\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\nAssertionError: expected 257 to be less than or equal to 255\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 257 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 257\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 257 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:05:34\n\n   Duration  13.91s (transform 9.49s, setup 0ms, collect 16.24s, tests 9.58s, environment 30ms, prepare 23.22s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 69, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "142",
					"mutatorName": "MethodExpression",
					"replacement": "sanitized",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 46ms\n   × Security Extended Tests > filename edge cases > should handle very long filenames 26ms\n     → expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 22ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 7ms\n\n     → expected 296 to be less than or equal to 255\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 140ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 132ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 282ms\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 51ms\n     → expected 264 to be less than or equal to 255\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 4ms\n\n     → expected 260 to be 255 // Object.is equality\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 233ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 584ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 527ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 124ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 23ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 179ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 36ms\n\n     → expected 308 to be less than or equal to 255\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 22ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 17ms\n     → expected 308 to be less than or equal to 255\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7300ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2286ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1561ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 678ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 296 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 264 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 260 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 260\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 308 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:05:34\n\n   Duration  14.33s (transform 8.76s, setup 0ms, collect 16.03s, tests 11.01s, environment 8ms, prepare 22.98s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 70, "line": 97 }, "start": { "column": 26, "line": 97 } }
				},
				{
					"id": "144",
					"mutatorName": "ArithmeticOperator",
					"replacement": "255 + ext.length",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 20ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 34ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 8ms\n\n     → expected 289 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 2 failed) 182ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 7ms\n\n     → expected 261 to be less than or equal to 255\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 4ms\n\n     → expected 260 to be 255 // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 38ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 39ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 123ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 236ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 48ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 48ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 30ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 76ms\n\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 8ms\n     → expected 261 to be less than or equal to 255\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 213ms\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 203ms\n     → expected 261 to be less than or equal to 255\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3630ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3617ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 780ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 393ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nAssertionError: expected 289 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 260 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 260\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nAssertionError: expected 261 to be less than or equal to 255\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n   Start at  23:05:44\n\n   Duration  9.64s (transform 6.14s, setup 0ms, collect 10.64s, tests 5.83s, environment 7ms, prepare 15.44s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 65, "line": 97 }, "start": { "column": 49, "line": 97 } }
				},
				{
					"id": "145",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 25ms\n   × Security Extended Tests > filename edge cases > should handle very long filenames 11ms\n     → expected 'unnamed_file' to contain '.txt'\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 1 failed) 85ms\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 9ms\n\n     → expected 12 to be 255 // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 166ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2503ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2493ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 1 failed) 285ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 273ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 165ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1614ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 875ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 12 to be 255 // Object.is equality\n\n- Expected\n+ Received\n\n- 255\n+ 12\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:05:51\n\n   Duration  9.48s (transform 4.30s, setup 0ms, collect 9.62s, tests 5.28s, environment 8ms, prepare 15.73s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 41, "line": 98 }, "start": { "column": 15, "line": 98 } }
				},
				{
					"id": "146",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 33ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 9ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 2ms\n\n     → expected true to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected true to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n\n     → expected undefined to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 1ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected true to be '_' // Object.is equality\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 7 failed) 265ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 37ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 102ms\n\n     → expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 2ms\n\n     → expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255 1ms\n\n     → expected undefined to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 1ms\n\n     → expected undefined to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 5ms\n\n     → expected true to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 1ms\n\n     → expected true to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 61ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 7ms\n\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n     → expected true to be 'file.tar.gz' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected true to be '文件.pdf' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle spaces 1ms\n     → expected true to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 58ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 168ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 367ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 353ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 24ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 15ms\n     → expected true to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 116ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 143ms\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 9ms\n     → expected true to be '___etc_passwd' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove forward slashes 1ms\n     → expected true to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected true to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n     → expected true to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 1ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n     → expected true to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6294ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1278ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 206ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 12ms\n\n     → expected true to be 'test.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 150ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 45ms\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 98ms\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected true to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected true to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected true to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected true to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 0ms\n\n     → expected true to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1849ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 886ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 34 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/34]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/34]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected true to be 'a_b' // Object.is equality\n\n- Expected: \n\"a_b\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected true to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/34]⎯\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected true to be 'file.txt' // Object.is equality\n\n\n- Expected: \n\"file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected true to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected true to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected undefined to be 254 // Object.is equality\n\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected true to be '_' // Object.is equality\n\n- Expected: \n\"_\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/34]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/34]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/34]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected true to be 'file.tar.gz' // Object.is equality\n\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/34]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected true to be '文件.pdf' // Object.is equality\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/34]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected true to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/34]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/34]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected true to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255\n\nAssertionError: expected undefined to be 255 // Object.is equality\n\n- Expected: \n255\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:170:48\n\n    168|   it('should truncate ONLY when > 255', () => {\n    169|    const exactly255 = 'a'.repeat(251) + '.txt';\n    170|    expect(sanitizeFilename(exactly255).length).toBe(255);\n       |                                                ^\n    171|    expect(sanitizeFilename(exactly255)).toBe(exactly255);\n    172|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/34]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected undefined to be 255 // Object.is equality\n\n- Expected: \n255\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected true to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected true to be 'file.' // Object.is equality\n\n\n- Expected: \n\"file.\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/34]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected true to be 'test.txt' // Object.is equality\n\n\n- Expected: \n\"test.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected true to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected true to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected true to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected true to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \ntrue\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/34]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/34]⎯\n\n\n Test Files  8 failed | 24 passed (32)\n\n      Tests  34 failed | 492 passed (526)\n\n   Start at  23:05:55\n\n   Duration  12.66s (transform 6.10s, setup 0ms, collect 11.16s, tests 10.12s, environment 15ms, prepare 21.71s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "147",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 422ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 51ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 35ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected false to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n     → expected false to be '文件.pdf' // Object.is equality\n   × Security Extended Tests > filename edge cases > should handle spaces 2ms\n     → expected false to be 'my file.txt' // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 6 failed) 126ms\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 8ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 1ms\n     → expected false to be 'a_b_c_d' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n     → expected false to be 'README' // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 1ms\n     → expected undefined to be 254 // Object.is equality\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension 2ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n\n     → expected false to be '_' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 307ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 7 failed) 644ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars 20ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 3ms\n     → expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 1ms\n\n     → expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255 143ms\n\n     → expected undefined to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 3ms\n\n     → expected undefined to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 1ms\n\n     → expected false to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 1ms\n\n     → expected false to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 318ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 305ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 26ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 126ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 134ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 97ms\n     → expected false to be 'document.pdf' // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 280ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 9ms\n     → expected false to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 202ms\n     → expected false to be 'path_to_file.txt' // Object.is equality\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n     → expected false to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected false to be 'document.pdf' // Object.is equality\n   × Security Utils > sanitizeFilename > should limit filename length to 255 chars 2ms\n     → actual value must be number or bigint, received \"undefined\"\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 1ms\n     → expected false to be 'unnamed_file' // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5407ms\n\n   × Theme Store > Store Structure > should have subscribe method 5018ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 381ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1434ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 761ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 63ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 26ms\n     → expected false to be 'unnamed_file' // Object.is equality\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 2ms\n\n     → expected false to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected false to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 1ms\n\n     → expected false to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected false to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected false to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected false to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 2ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 223ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 13ms\n\n     → expected false to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 34 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected false to be 'a_b' // Object.is equality\n\n\n- Expected: \n\"a_b\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected false to be '___' // Object.is equality\n\n\n- Expected: \n\"___\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected false to be 'file.txt' // Object.is equality\n\n- Expected: \n\"file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/34]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-behavior.test.ts:38:26\n\n     36|    const long = 'a'.repeat(300) + '.txt';\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     39|    expect(result.endsWith('.txt')).toBe(true);\n     40|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected false to be 'a_b_c_d' // Object.is equality\n\n\n- Expected: \n\"a_b_c_d\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/34]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\nAssertionError: expected false to be 'README' // Object.is equality\n\n- Expected: \n\"README\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected undefined to be 254 // Object.is equality\n\n\n- Expected: \n254\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filename > 255 with long extension\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-complete.test.ts:85:26\n\n     83|    const name = 'a'.repeat(260) + '.verylongextension';\n     84|    const result = sanitizeFilename(name);\n     85|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     86|   });\n     87| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/34]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected false to be '_' // Object.is equality\n\n\n- Expected: \n\"_\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/34]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/34]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-extended.test.ts:60:26\n\n     58|    const longName = 'a'.repeat(300) + '.txt';\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     61|    expect(result).toContain('.txt');\n     62|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/34]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\nAssertionError: expected false to be 'file.tar.gz' // Object.is equality\n\n- Expected: \n\"file.tar.gz\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/34]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected false to be '文件.pdf' // Object.is equality\n\n- Expected: \n\"文件.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/34]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected false to be 'my file.txt' // Object.is equality\n\n\n- Expected: \n\"my file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should truncate at exactly 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security-headers.test.ts:115:26\n\n    113|    const longName = 'a'.repeat(256) + '.txt';\n    114|    const result = sanitizeFilename(longName);\n    115|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n    116|   });\n    117| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected false to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\n- Expected: \n\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255\n\nAssertionError: expected undefined to be 255 // Object.is equality\n\n\n- Expected: \n255\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:170:48\n\n    168|   it('should truncate ONLY when > 255', () => {\n    169|    const exactly255 = 'a'.repeat(251) + '.txt';\n    170|    expect(sanitizeFilename(exactly255).length).toBe(255);\n       |                                                ^\n    171|    expect(sanitizeFilename(exactly255)).toBe(exactly255);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected undefined to be 255 // Object.is equality\n\n\n- Expected: \n255\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected false to be 'README' // Object.is equality\n\n\n- Expected: \n\"README\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/34]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected false to be 'file.' // Object.is equality\n\n- Expected: \n\"file.\"\n\n+ Received: \nfalse\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/34]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected false to be 'test.txt' // Object.is equality\n\n\n- Expected: \n\"test.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected false to be '___etc_passwd' // Object.is equality\n\n\n- Expected: \n\"___etc_passwd\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/34]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected false to be 'path_to_file.txt' // Object.is equality\n\n\n- Expected: \n\"path_to_file.txt\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected false to be 'document.pdf' // Object.is equality\n\n\n- Expected: \n\"document.pdf\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/34]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should limit filename length to 255 chars\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/security.test.ts:30:26\n\n     28|    const longName = 'a'.repeat(300) + '.txt';\n     29|    const result = sanitizeFilename(longName);\n     30|    expect(result.length).toBeLessThanOrEqual(255);\n       |                          ^\n     31|   });\n     32| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/34]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected false to be 'unnamed_file' // Object.is equality\n\n\n- Expected: \n\"unnamed_file\"\n\n+ Received: \nfalse\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/34]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/34]⎯\n\n\n Test Files  8 failed | 24 passed (32)\n\n      Tests  34 failed | 492 passed (526)\n\n   Start at  23:05:57\n\n   Duration  13.41s (transform 5.03s, setup 0ms, collect 10.89s, tests 9.91s, environment 27ms, prepare 23.00s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "149",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 41ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 8ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 1ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 303ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 123ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 186ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 311ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 546ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 430ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 28ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 51ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 185ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 47ms\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 35ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5358ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 343ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 12ms\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 2 failed) 170ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 7ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 3ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1476ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 679ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:91:35\n\n     89|    expect(sanitizeFilename('/')).toBe('_');\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     92|   });\n     93|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:06:00\n\n   Duration  13.44s (transform 7.41s, setup 0ms, collect 13.35s, tests 9.15s, environment 133ms, prepare 21.38s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 22, "line": 101 }
					}
				},
				{
					"id": "148",
					"mutatorName": "LogicalOperator",
					"replacement": "sanitized && 'unnamed_file'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 53ms\n\n   × Security Extended Tests > filename edge cases > should handle very long filenames 14ms\n\n     → expected 'unnamed_file' to contain '.txt'\n\n   × Security Extended Tests > filename edge cases > should handle multiple dots 3ms\n\n     → expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle unicode characters 1ms\n\n     → expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\n   × Security Extended Tests > filename edge cases > should handle spaces 5ms\n\n     → expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 123ms\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal 10ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes 5ms\n     → expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension 1ms\n\n     → expected 'unnamed_file' to be 'README' // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars 89ms\n\n     → expected 12 to be 254 // Object.is equality\n\n   × Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization 2ms\n\n     → expected 'unnamed_file' to be '_' // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 85ms\n\n ❯ tests/unit/lib/security-headers.test.ts (17 tests | 6 failed) 512ms\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars 183ms\n\n     → expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars 46ms\n     → expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255 28ms\n\n     → expected 12 to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256 1ms\n\n     → expected 12 to be 255 // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle filename without extension 1ms\n\n     → expected 'unnamed_file' to be 'README' // Object.is equality\n\n   × Security - Final Mutation Killers > Extension extraction > should handle empty extension 40ms\n\n     → expected 'unnamed_file' to be 'file.' // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 246ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 36ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 172ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 19ms\n\n   × Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames 11ms\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 5 failed) 78ms\n\n   × Security Utils > sanitizeFilename > should remove path traversal attempts 44ms\n\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove forward slashes 2ms\n\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should remove backslashes 1ms\n\n     → expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should handle normal filenames 1ms\n\n     → expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n   × Security Utils > sanitizeFilename > should return unnamed_file for empty input 24ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5973ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 945ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-behavior.test.ts (8 tests | 8 failed) 248ms\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string 13ms\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _ 4ms\n\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _ 1ms\n\n     → expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd 2ms\n\n     → expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles /// 1ms\n\n     → expected 'unnamed_file' to be '___' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string 1ms\n\n     → expected '' to be 'unnamed_file' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename 1ms\n\n     → expected 'unnamed_file' to be 'file.txt' // Object.is equality\n\n   × Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension 224ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1462ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 635ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 186ms\n\n   × Security - Real Import Tests > sanitizeFilename > should sanitize simple filename 176ms\n     → expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 31 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces .. with empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:8:35\n\n      6|  describe('sanitizeFilename - Verified Behavior', () => {\n      7|   it('replaces .. with empty string', () => {\n      8|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n      9|   });\n     10| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces / with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:12:36\n\n     10| \n     11|   it('replaces / with _', () => {\n     12|    expect(sanitizeFilename('a/b')).toBe('a_b');\n       |                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > replaces \\\\ with _\n\nAssertionError: expected 'unnamed_file' to be 'a_b' // Object.is equality\n\n\nExpected: \"a_b\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:16:37\n\n     14| \n     15|   it('replaces \\\\\\\\ with _', () => {\n     16|    expect(sanitizeFilename('a\\\\b')).toBe('a_b');\n       |                                     ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ../../../etc/passwd\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:20:52\n\n     18| \n     19|   it('handles ../../../etc/passwd', () => {\n     20|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > handles ///\n\nAssertionError: expected 'unnamed_file' to be '___' // Object.is equality\n\n\nExpected: \"___\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:24:36\n\n     22| \n     23|   it('handles ///', () => {\n     24|    expect(sanitizeFilename('///')).toBe('___');\n       |                                    ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > returns unnamed_file for empty string\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:28:33\n\n     26| \n     27|   it('returns unnamed_file for empty string', () => {\n     28|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > preserves safe filename\n\nAssertionError: expected 'unnamed_file' to be 'file.txt' // Object.is equality\n\n\nExpected: \"file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:32:41\n\n     30| \n     31|   it('preserves safe filename', () => {\n     32|    expect(sanitizeFilename('file.txt')).toBe('file.txt');\n       |                                         ^\n     33|   });\n     34| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/31]⎯\n\n\n FAIL  tests/unit/lib/security-behavior.test.ts > Security - Exact Behavior > sanitizeFilename - Verified Behavior > truncates at 255 chars preserving extension\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-behavior.test.ts:39:36\n\n     37|    const result = sanitizeFilename(long);\n     38|    expect(result.length).toBeLessThanOrEqual(255);\n     39|    expect(result.endsWith('.txt')).toBe(true);\n       |                                    ^\n     40|   });\n     41|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/31]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should remove all dots in path traversal\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security-complete.test.ts:61:35\n\n     59|  describe('sanitizeFilename - complete coverage', () => {\n     60|   it('should remove all dots in path traversal', () => {\n     61|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n       |                                   ^\n     62|    expect(sanitizeFilename('....')).toBe('unnamed_file');\n     63|    expect(sanitizeFilename('a..b..c')).toBe('abc');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/31]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should replace all slashes\n\nAssertionError: expected 'unnamed_file' to be 'a_b_c_d' // Object.is equality\n\n\nExpected: \"a_b_c_d\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:67:40\n\n     65| \n     66|   it('should replace all slashes', () => {\n     67|    expect(sanitizeFilename('a/b/c/d')).toBe('a_b_c_d');\n       |                                        ^\n     68|    expect(sanitizeFilename('a\\\\b\\\\c\\\\d')).toBe('a_b_c_d');\n     69|    expect(sanitizeFilename('a/b\\\\c/d')).toBe('a_b_c_d');\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/31]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle filenames with no extension\n\nAssertionError: expected 'unnamed_file' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:73:39\n\n     71| \n     72|   it('should handle filenames with no extension', () => {\n     73|    expect(sanitizeFilename('README')).toBe('README');\n       |                                       ^\n     74|   });\n     75| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/31]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should handle exactly 255 chars\n\nAssertionError: expected 12 to be 254 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 254\n+ 12\n\n\n ❯ tests/unit/lib/security-complete.test.ts:79:26\n\n     77|    const name = 'a'.repeat(250) + '.txt';\n     78|    const result = sanitizeFilename(name);\n     79|    expect(result.length).toBe(254);\n       |                          ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/31]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > sanitizeFilename - complete coverage > should return unnamed_file for empty after sanitization\n\nAssertionError: expected 'unnamed_file' to be '_' // Object.is equality\n\n\nExpected: \"_\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-complete.test.ts:89:34\n\n     87| \n     88|   it('should return unnamed_file for empty after sanitization', () => {\n     89|    expect(sanitizeFilename('/')).toBe('_');\n       |                                  ^\n     90|    expect(sanitizeFilename('\\\\')).toBe('_');\n     91|    expect(sanitizeFilename('..')).toBe('unnamed_file');\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/31]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > sanitizeFilename - All Edge Cases > should preserve safe filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:8:45\n\n      6|  describe('sanitizeFilename - All Edge Cases', () => {\n      7|   it('should preserve safe filenames', () => {\n      8|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n      9|   });\n     10| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/31]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle very long filenames\n\nAssertionError: expected 'unnamed_file' to contain '.txt'\n\n\nExpected: \".txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:61:19\n\n     59|    const result = sanitizeFilename(longName);\n     60|    expect(result.length).toBeLessThanOrEqual(255);\n     61|    expect(result).toContain('.txt');\n       |                   ^\n     62|   });\n     63| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/31]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle multiple dots\n\nAssertionError: expected 'unnamed_file' to be 'file.tar.gz' // Object.is equality\n\n\nExpected: \"file.tar.gz\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:65:44\n\n     63| \n     64|   it('should handle multiple dots', () => {\n     65|    expect(sanitizeFilename('file.tar.gz')).toBe('file.tar.gz');\n       |                                            ^\n     66|   });\n     67| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/31]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle unicode characters\n\nAssertionError: expected 'unnamed_file' to be '文件.pdf' // Object.is equality\n\n\nExpected: \"文件.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:69:39\n\n     67| \n     68|   it('should handle unicode characters', () => {\n     69|    expect(sanitizeFilename('文件.pdf')).toBe('文件.pdf');\n       |                                       ^\n     70|   });\n     71| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/31]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > filename edge cases > should handle spaces\n\nAssertionError: expected 'unnamed_file' to be 'my file.txt' // Object.is equality\n\n\nExpected: \"my file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-extended.test.ts:73:44\n\n     71| \n     72|   it('should handle spaces', () => {\n     73|    expect(sanitizeFilename('my file.txt')).toBe('my file.txt');\n       |                                            ^\n     74|   });\n     75|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/31]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should NOT truncate at 254 chars\n\nAssertionError: expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:121:19\n\n    119|    const name = 'a'.repeat(250) + '.txt';\n    120|    const result = sanitizeFilename(name);\n    121|    expect(result).toBe(name);\n       |                   ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/31]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security Headers - Mutation Testing > sanitizeFilename - Boundary Tests > should handle exactly 255 chars\n\nAssertionError: expected 'unnamed_file' to be 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa…' // Object.is equality\n\n\nExpected: \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:127:19\n\n    125|    const name = 'a'.repeat(251) + '.txt';\n    126|    const result = sanitizeFilename(name);\n    127|    expect(result).toBe(name);\n       |                   ^\n    128|   });\n    129|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/31]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate ONLY when > 255\n\nAssertionError: expected 12 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 12\n\n\n ❯ tests/unit/lib/security-headers.test.ts:170:48\n\n    168|   it('should truncate ONLY when > 255', () => {\n    169|    const exactly255 = 'a'.repeat(251) + '.txt';\n    170|    expect(sanitizeFilename(exactly255).length).toBe(255);\n       |                                                ^\n    171|    expect(sanitizeFilename(exactly255)).toBe(exactly255);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/31]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > sanitizeFilename - Boundary at 255 > should truncate when = 256\n\nAssertionError: expected 12 to be 255 // Object.is equality\n\n\n- Expected\n+ Received\n\n- 255\n+ 12\n\n\n ❯ tests/unit/lib/security-headers.test.ts:177:26\n\n    175|    const exactly256 = 'a'.repeat(252) + '.txt';\n    176|    const result = sanitizeFilename(exactly256);\n    177|    expect(result.length).toBe(255);\n       |                          ^\n    178|    expect(result).not.toBe(exactly256);\n    179|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/31]⎯\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle filename without extension\n\nAssertionError: expected 'unnamed_file' to be 'README' // Object.is equality\n\n\nExpected: \"README\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:185:19\n\n    183|   it('should handle filename without extension', () => {\n    184|    const result = sanitizeFilename('README');\n    185|    expect(result).toBe('README');\n       |                   ^\n    186|   });\n    187| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/31]⎯\n\n\n FAIL  tests/unit/lib/security-headers.test.ts > Security - Final Mutation Killers > Extension extraction > should handle empty extension\n\nAssertionError: expected 'unnamed_file' to be 'file.' // Object.is equality\n\n\nExpected: \"file.\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-headers.test.ts:190:19\n\n    188|   it('should handle empty extension', () => {\n    189|    const result = sanitizeFilename('file.');\n    190|    expect(result).toBe('file.');\n       |                   ^\n    191|   });\n    192|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/31]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > sanitizeFilename > should sanitize simple filename\n\nAssertionError: expected 'unnamed_file' to be 'test.txt' // Object.is equality\n\n\nExpected: \"test.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:9:19\n\n      7|   it('should sanitize simple filename', () => {\n      8|    const result = sanitizeFilename('test.txt');\n      9|    expect(result).toBe('test.txt');\n       |                   ^\n     10|   });\n     11| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/31]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove path traversal attempts\n\nAssertionError: expected 'unnamed_file' to be '___etc_passwd' // Object.is equality\n\n\nExpected: \"___etc_passwd\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:12:52\n\n     10|  describe('sanitizeFilename', () => {\n     11|   it('should remove path traversal attempts', () => {\n     12|    expect(sanitizeFilename('../../../etc/passwd')).toBe('___etc_passwd…\n       |                                                    ^\n     13|   });\n     14| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/31]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove forward slashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:16:49\n\n     14| \n     15|   it('should remove forward slashes', () => {\n     16|    expect(sanitizeFilename('path/to/file.txt')).toBe('path_to_file.txt…\n       |                                                 ^\n     17|   });\n     18| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/31]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should remove backslashes\n\nAssertionError: expected 'unnamed_file' to be 'path_to_file.txt' // Object.is equality\n\n\nExpected: \"path_to_file.txt\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:20:51\n\n     18| \n     19|   it('should remove backslashes', () => {\n     20|    expect(sanitizeFilename('path\\\\to\\\\file.txt')).toBe('path_to_file.t…\n       |                                                   ^\n     21|   });\n     22| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/31]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should handle normal filenames\n\nAssertionError: expected 'unnamed_file' to be 'document.pdf' // Object.is equality\n\n\nExpected: \"document.pdf\"\nReceived: \"unnamed_file\"\n\n\n ❯ tests/unit/lib/security.test.ts:24:45\n\n     22| \n     23|   it('should handle normal filenames', () => {\n     24|    expect(sanitizeFilename('document.pdf')).toBe('document.pdf');\n       |                                             ^\n     25|   });\n     26| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/31]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > sanitizeFilename > should return unnamed_file for empty input\n\nAssertionError: expected '' to be 'unnamed_file' // Object.is equality\n\n\n- Expected\n+ Received\n\n- unnamed_file\n\n\n ❯ tests/unit/lib/security.test.ts:34:33\n\n     32| \n     33|   it('should return unnamed_file for empty input', () => {\n     34|    expect(sanitizeFilename('')).toBe('unnamed_file');\n       |                                 ^\n     35|   });\n     36|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/31]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/31]⎯\n\n\n Test Files  8 failed | 24 passed (32)\n\n      Tests  31 failed | 495 passed (526)\n\n   Start at  23:05:59\n\n   Duration  13.92s (transform 9.00s, setup 0ms, collect 15.59s, tests 9.42s, environment 7ms, prepare 21.93s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 101 },
						"start": { "column": 9, "line": 101 }
					}
				},
				{
					"id": "150",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 128ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 39ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 13ms\n\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 6ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 7 failed) 44ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 15ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 0ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 258ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 72ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 48ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 202ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 190ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate exact match 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2927ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2912ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 861ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 458ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 13ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 6ms\n     → expected undefined to be true // Object.is equality\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 36ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 22 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/22]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/22]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/22]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/22]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/22]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/22]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/22]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/22]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/22]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  22 failed | 504 passed (526)\n\n   Start at  23:06:10\n\n   Duration  8.71s (transform 4.34s, setup 0ms, collect 9.26s, tests 4.97s, environment 9ms, prepare 13.22s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 119 },
						"start": { "column": 84, "line": 107 }
					}
				},
				{
					"id": "151",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 69ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 37ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 21ms\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 43ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 13ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 16ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 148ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 194ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 20ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 10ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 18ms\n\n   × Security Utils > isValidMimeType > should validate exact match 9ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3706ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3696ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 33ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 43ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1366ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 788ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 513 passed (526)\n\n   Start at  23:06:16\n\n   Duration  9.35s (transform 4.46s, setup 0ms, collect 9.40s, tests 6.04s, environment 9ms, prepare 13.31s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "113",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/[<>]/g, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 67, "line": 70 }, "start": { "column": 9, "line": 70 } }
				},
				{
					"id": "152",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 28ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 15ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 32ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 206ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 97ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 225ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 87ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 214ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 149ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 20ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 9ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6233ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1210ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 307ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 301ms\n     → expected false to be true // Object.is equality\n\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1574ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 847ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 140ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n\n   Start at  23:06:20\n\n   Duration  12.31s (transform 6.16s, setup 0ms, collect 11.25s, tests 9.51s, environment 49ms, prepare 19.15s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "153",
					"mutatorName": "EqualityOperator",
					"replacement": "allowedTypes.length !== 0",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 271ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 58ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 26ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 11ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 5 failed) 39ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 13ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 10ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 260ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 176ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 524ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 392ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 74ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 20ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 9ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 1ms\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 20ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 9ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should validate exact match 1ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6185ms\n\n   × Theme Store > Store Structure > should have subscribe method 5066ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1109ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1414ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 855ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 233ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 310ms\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 277ms\n     → expected false to be true // Object.is equality\n\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 23ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 19 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/19]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/19]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/19]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/19]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/19]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/19]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/19]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/19]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/19]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/19]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/19]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/19]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/19]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/19]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/19]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/19]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/19]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/19]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/19]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  19 failed | 507 passed (526)\n\n   Start at  23:06:22\n\n   Duration  13.98s (transform 9.80s, setup 0ms, collect 17.99s, tests 9.98s, environment 72ms, prepare 23.42s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 31, "line": 109 },
						"start": { "column": 6, "line": 109 }
					}
				},
				{
					"id": "154",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 32ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 9ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 154ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array 41ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 296ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 140ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 84ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 276ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 83ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list 58ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4719ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4710ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 173ms\n\n   × Security Utils > isValidMimeType > should allow all types when allowedTypes is empty 163ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 286ms\n\n   × Security - Real Import Tests > isValidMimeType > should accept image/png 280ms\n     → expected false to be true // Object.is equality\n\n   × Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty 2ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1826ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 949ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should allow all when empty array\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:183:49\n\n    181|  describe('isValidMimeType - complete branches', () => {\n    182|   it('should allow all when empty array', () => {\n    183|    expect(isValidMimeType('anything/goes', [])).toBe(true);\n       |                                                 ^\n    184|    expect(isValidMimeType('random/type', [])).toBe(true);\n    185|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should return true for empty allowed list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:41:44\n\n     39|  describe('isValidMimeType - Boundary Tests', () => {\n     40|   it('should return true for empty allowed list', () => {\n     41|    expect(isValidMimeType('anything', [])).toBe(true);\n       |                                            ^\n     42|   });\n     43| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:158:36\n\n    156|   it('should handle empty MIME type', () => {\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n       |                                    ^\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n    160|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept image/png\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-real-import.test.ts:21:19\n\n     19|   it('should accept image/png', () => {\n     20|    const result = isValidMimeType('image/png', []);\n     21|    expect(result).toBe(true);\n       |                   ^\n     22|   });\n     23| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > isValidMimeType > should accept when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:26:19\n\n     24|   it('should accept when allowedTypes is empty', () => {\n     25|    const result = isValidMimeType('application/pdf', []);\n     26|    expect(result).toBe(true);\n       |                   ^\n     27|   });\n     28|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should allow all types when allowedTypes is empty\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:66:51\n\n     64|  describe('isValidMimeType', () => {\n     65|   it('should allow all types when allowedTypes is empty', () => {\n     66|    expect(isValidMimeType('application/pdf', [])).toBe(true);\n       |                                                   ^\n     67|    expect(isValidMimeType('image/jpeg', [])).toBe(true);\n     68|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n      Tests  6 failed | 520 passed (526)\n   Start at  23:06:23\n\n   Duration  13.13s (transform 7.52s, setup 0ms, collect 14.21s, tests 8.44s, environment 48ms, prepare 21.92s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 109 },
						"start": { "column": 40, "line": 109 }
					}
				},
				{
					"id": "155",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 87ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 168ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 133ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n     → expected true to be false // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 302ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 163ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 101ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 8ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 516ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 347ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 28ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 167ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 156ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 146ms\n\n   × Security Utils > isValidMimeType > should validate exact match 136ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5678ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 643ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 206ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2082ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 979ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 14 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/14]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/14]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/14]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/14]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/14]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/14]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/14]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  14 failed | 512 passed (526)\n\n   Start at  23:06:23\n\n   Duration  12.79s (transform 5.93s, setup 0ms, collect 10.81s, tests 9.91s, environment 41ms, prepare 23.03s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "156",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 62ms\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 39ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 38ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 218ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 55ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 210ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 49ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 27ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 15ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 18ms\n\n   × Security Utils > isValidMimeType > should validate exact match 8ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 148ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3138ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3123ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 916ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 377ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 22ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  7 failed | 519 passed (526)\n   Start at  23:06:33\n\n   Duration  8.94s (transform 5.12s, setup 0ms, collect 10.64s, tests 5.29s, environment 7ms, prepare 13.33s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 112 },
						"start": { "column": 6, "line": 112 }
					}
				},
				{
					"id": "117",
					"mutatorName": "EqualityOperator",
					"replacement": "sanitized === (sanitized = sanitized.replace(/javascript:/gi, ''))",
					"status": "Timeout",
					"location": { "end": { "column": 75, "line": 73 }, "start": { "column": 9, "line": 73 } }
				},
				{
					"id": "157",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 47ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 2 failed) 24ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match exact type 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 25ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 30ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 345ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 316ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 182ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 2 failed) 122ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match 100ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list 2ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 197ms\n\n   × Security Utils > isValidMimeType > should validate exact match 175ms\n\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4153ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4143ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 178ms\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2049ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1277ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 131ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match exact type\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:188:58\n\n    186| \n    187|   it('should match exact type', () => {\n    188|    expect(isValidMimeType('image/jpeg', ['image/jpeg'])).toBe(true);\n       |                                                          ^\n    189|   });\n    190| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:210:51\n\n    208|   it('should handle multiple allowed types', () => {\n    209|    const allowed = ['image/jpeg', 'image/png', 'application/pdf'];\n    210|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should validate exact mime match\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:45:70\n\n     43| \n     44|   it('should validate exact mime match', () => {\n     45|    expect(isValidMimeType('image/png', ['image/png', 'image/jpeg'])).t…\n       |                                                                      ^\n     46|   });\n     47| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should handle single item list\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:53:58\n\n     51| \n     52|   it('should handle single item list', () => {\n     53|    expect(isValidMimeType('text/plain', ['text/plain'])).toBe(true);\n       |                                                          ^\n     54|   });\n     55|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:151:56\n\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:71:68\n\n     69| \n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n       |                                                                    ^\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n     73|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:84:56\n\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n       |                                                        ^\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n     86|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n      Tests  7 failed | 519 passed (526)\n   Start at  23:06:40\n   Duration  10.65s (transform 6.01s, setup 0ms, collect 10.97s, tests 7.73s, environment 11ms, prepare 19.23s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 50, "line": 112 },
						"start": { "column": 46, "line": 112 }
					}
				},
				{
					"id": "158",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 49ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 22ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 94ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 78ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 57ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 545ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 33ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 232ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 17ms\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 129ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 214ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 279ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 268ms\n     → expected false to be true // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 30ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6592ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1571ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1926ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 866ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n      Tests  6 failed | 520 passed (526)\n   Start at  23:06:43\n   Duration  13.64s (transform 6.53s, setup 0ms, collect 12.74s, tests 10.42s, environment 34ms, prepare 24.14s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 115 },
						"start": { "column": 34, "line": 115 }
					}
				},
				{
					"id": "159",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 42ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 16ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 213ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 83ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 58ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 3ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 5ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 2ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 204ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 211ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 500ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 77ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 333ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 322ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 140ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 237ms\n\n   × Security Utils > isValidMimeType > should validate exact match 227ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 1ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7658ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2644ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 41ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1858ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 910ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 26ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 14 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/14]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/14]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/14]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/14]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/14]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:72:63\n\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/14]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/14]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/14]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/14]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  14 failed | 512 passed (526)\n\n   Start at  23:06:43\n\n   Duration  14.02s (transform 8.73s, setup 0ms, collect 11.49s, tests 12.00s, environment 14ms, prepare 23.36s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "162",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 102ms\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 86ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 98ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 79ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 124ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 233ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 358ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 343ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 331ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 322ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5440ms\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 419ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1565ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 690ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:06:47\n\n   Duration  14.09s (transform 8.84s, setup 0ms, collect 16.18s, tests 8.66s, environment 8ms, prepare 24.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 57, "line": 116 },
						"start": { "column": 53, "line": 116 }
					}
				},
				{
					"id": "161",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 181ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 89ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 302ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 123ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 109ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 175ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 183ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 302ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 136ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 370ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 357ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 102ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 279ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 25ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 81ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 72ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5643ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 629ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 14ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 130ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1302ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 710ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 137ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 22ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:06:47\n\n   Duration  14.39s (transform 9.11s, setup 0ms, collect 15.26s, tests 9.64s, environment 79ms, prepare 24.73s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 43, "line": 116 },
						"start": { "column": 28, "line": 116 }
					}
				},
				{
					"id": "160",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 47ms\n\n   × Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard 17ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 108ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 66ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 239ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 230ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 70ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 435ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 423ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 40ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 182ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4981ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4971ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 76ms\n\n   × Security Utils > isValidMimeType > should validate wildcard match 63ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > isValidMimeType > should handle multiple allowed types 4ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1378ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 643ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should match wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:196:55\n\n    194| \n    195|   it('should match wildcard', () => {\n    196|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n    197|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n    198|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:140:51\n\n    138|    const allowed = ['image/*', 'video/*', 'audio/*'];\n    139| \n    140|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:150:50\n\n    148|    const allowed = ['image/*', 'application/pdf', 'text/plain'];\n    149| \n    150|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n       |                                                  ^\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:76:55\n\n     74| \n     75|   it('should validate wildcard match', () => {\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n       |                                                       ^\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:83:51\n\n     81|   it('should handle multiple allowed types', () => {\n     82|    const allowed = ['image/*', 'application/pdf'];\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n       |                                                   ^\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  5 failed | 521 passed (526)\n   Start at  23:06:47\n   Duration  14.22s (transform 8.96s, setup 0ms, collect 15.97s, tests 8.01s, environment 25ms, prepare 23.30s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 44, "line": 116 },
						"start": { "column": 6, "line": 116 }
					}
				},
				{
					"id": "163",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 44ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 5 failed) 29ms\n\n   × Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards 10ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard 2ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle empty MIME type 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format 1ms\n\n     → expected true to be false // Object.is equality\n\n   × Security Extended Tests > MIME type validation edge cases > should be case sensitive 1ms\n\n     → expected true to be false // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 4 failed) 36ms\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type 11ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard 1ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category 1ms\n     → expected true to be false // Object.is equality\n   × Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types 1ms\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 216ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 21ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 38ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 137ms\n\n   × Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list 37ms\n\n     → expected true to be false // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 3 failed) 298ms\n\n   × Security Utils > isValidMimeType > should validate exact match 269ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should validate wildcard match 12ms\n     → expected true to be false // Object.is equality\n   × Security Utils > isValidMimeType > should handle multiple allowed types 2ms\n\n     → expected true to be false // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3814ms\n   ✓ Theme Store > Store Structure > should have subscribe method 3802ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1051ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 435ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 19ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different exact type\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:192:57\n\n    190| \n    191|   it('should not match different exact type', () => {\n    192|    expect(isValidMimeType('image/png', ['image/jpeg'])).toBe(false);\n       |                                                         ^\n    193|   });\n    194| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should not match different category wildcard\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security-complete.test.ts:201:54\n\n    199| \n    200|   it('should not match different category wildcard', () => {\n    201|    expect(isValidMimeType('video/mp4', ['image/*'])).toBe(false);\n       |                                                      ^\n    202|   });\n    203| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle MIME without category\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:205:55\n\n    203| \n    204|   it('should handle MIME without category', () => {\n    205|    expect(isValidMimeType('nocategory', ['image/*'])).toBe(false);\n       |                                                       ^\n    206|   });\n    207| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > isValidMimeType - complete branches > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-complete.test.ts:213:50\n\n    211|    expect(isValidMimeType('image/png', allowed)).toBe(true);\n    212|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    213|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n    214|   });\n    215|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > isValidMimeType - Boundary Tests > should reject when not in list\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:49:62\n\n     47| \n     48|   it('should reject when not in list', () => {\n     49|    expect(isValidMimeType('application/pdf', ['image/png'])).toBe(fals…\n       |                                                              ^\n     50|   });\n     51| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle multiple wildcards\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:143:56\n\n    141|    expect(isValidMimeType('video/mp4', allowed)).toBe(true);\n    142|    expect(isValidMimeType('audio/mpeg', allowed)).toBe(true);\n    143|    expect(isValidMimeType('application/pdf', allowed)).toBe(false);\n       |                                                        ^\n    144|   });\n    145| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle mixed exact and wildcard\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:153:57\n\n    151|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n    152|    expect(isValidMimeType('text/plain', allowed)).toBe(true);\n    153|    expect(isValidMimeType('application/json', allowed)).toBe(false);\n       |                                                         ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle empty MIME type\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:159:45\n\n    157|    // Function already imported\n    158|    expect(isValidMimeType('', [])).toBe(true);\n    159|    expect(isValidMimeType('', ['image/*'])).toBe(false);\n       |                                             ^\n    160|   });\n    161| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should handle invalid MIME format\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:164:52\n\n    162|   it('should handle invalid MIME format', () => {\n    163|    // Function already imported\n    164|    expect(isValidMimeType('invalid', ['image/*'])).toBe(false);\n       |                                                    ^\n    165|   });\n    166| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > MIME type validation edge cases > should be case sensitive\n\nAssertionError: expected true to be false // Object.is equality\n\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security-extended.test.ts:170:51\n\n    168|    // Function already imported\n    169|    const allowed = ['image/jpeg'];\n    170|    expect(isValidMimeType('image/JPEG', allowed)).toBe(false);\n       |                                                   ^\n    171|    expect(isValidMimeType('IMAGE/jpeg', allowed)).toBe(false);\n    172|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate exact match\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:72:63\n     70|   it('should validate exact match', () => {\n     71|    expect(isValidMimeType('application/pdf', ['application/pdf'])).toB…\n     72|    expect(isValidMimeType('image/jpeg', ['application/pdf'])).toBe(fal…\n       |                                                               ^\n     73|   });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should validate wildcard match\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n ❯ tests/unit/lib/security.test.ts:78:60\n\n     76|    expect(isValidMimeType('image/jpeg', ['image/*'])).toBe(true);\n     77|    expect(isValidMimeType('image/png', ['image/*'])).toBe(true);\n     78|    expect(isValidMimeType('application/pdf', ['image/*'])).toBe(false);\n       |                                                            ^\n     79|   });\n     80| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > isValidMimeType > should handle multiple allowed types\n\nAssertionError: expected true to be false // Object.is equality\n\n- Expected\n+ Received\n\n- false\n+ true\n\n\n ❯ tests/unit/lib/security.test.ts:85:50\n\n     83|    expect(isValidMimeType('image/jpeg', allowed)).toBe(true);\n     84|    expect(isValidMimeType('application/pdf', allowed)).toBe(true);\n     85|    expect(isValidMimeType('video/mp4', allowed)).toBe(false);\n       |                                                  ^\n     86|   });\n     87|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  13 failed | 513 passed (526)\n\n   Start at  23:07:00\n\n   Duration  8.92s (transform 4.62s, setup 0ms, collect 8.36s, tests 6.08s, environment 16ms, prepare 14.06s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 14, "line": 118 },
						"start": { "column": 9, "line": 118 }
					}
				},
				{
					"id": "164",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 21 failed) 42ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 9ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 2ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 3ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 5ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 0ms\n\n     → expected undefined to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension 0ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 105ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 61ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 48ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 7 failed) 25ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 9ms\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe image formats 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe document formats 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats 1ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 409ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 391ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 96ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 170ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 101ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 13 failed) 117ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 62ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 2ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 14ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 6ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 2ms\n     → expected undefined to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions 5ms\n     → expected undefined to be false // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension 1ms\n     → expected undefined to be false // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 12ms\n     → expected undefined to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 22ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 6 failed) 76ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 63ms\n     → expected undefined to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected undefined to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should allow .pdf files 2ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should allow .jpg files 2ms\n\n     → expected undefined to be false // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected undefined to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5639ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 621ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1404ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 657ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 2 failed) 133ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 125ms\n     → expected undefined to be true // Object.is equality\n\n   × Security - Real Import Tests > hasDangerousExtension > should allow .txt 3ms\n\n     → expected undefined to be false // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 20ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 50 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/50]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/50]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/50]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should handle no extension\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-complete.test.ts:177:49\n\n    175| \n    176|   it('should handle no extension', () => {\n    177|    expect(hasDangerousExtension('noextension')).toBe(false);\n       |                                                 ^\n    178|   });\n    179|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/50]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/50]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/50]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/50]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should allow safe extensions\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:85:50\n\n     83| \n     84|   it('should allow safe extensions', () => {\n     85|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     86|    expect(hasDangerousExtension('image.png')).toBe(false);\n     87|    expect(hasDangerousExtension('data.json')).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/50]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle files without extension\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:91:44\n\n     89| \n     90|   it('should handle files without extension', () => {\n     91|    expect(hasDangerousExtension('README')).toBe(false);\n       |                                            ^\n     92|   });\n     93| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/50]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe image formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:94:47\n\n     92|   it('should allow safe image formats', () => {\n     93|    // Function already imported\n     94|    expect(hasDangerousExtension('photo.png')).toBe(false);\n       |                                               ^\n     95|    expect(hasDangerousExtension('image.gif')).toBe(false);\n     96|    expect(hasDangerousExtension('pic.webp')).toBe(false);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/50]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe document formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:101:51\n\n     99|   it('should allow safe document formats', () => {\n    100|    // Function already imported\n    101|    expect(hasDangerousExtension('document.docx')).toBe(false);\n       |                                                   ^\n    102|    expect(hasDangerousExtension('sheet.xlsx')).toBe(false);\n    103|    expect(hasDangerousExtension('presentation.pptx')).toBe(false);\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should allow safe archive formats\n\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:108:48\n\n    106|   it('should allow safe archive formats', () => {\n    107|    // Function already imported\n    108|    expect(hasDangerousExtension('archive.7z')).toBe(false);\n       |                                                ^\n    109|    expect(hasDangerousExtension('files.rar')).toBe(false);\n    110|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/50]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/50]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/50]⎯\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should allow .txt\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security-real-import.test.ts:38:19\n     36|   it('should allow .txt', () => {\n     37|    const result = hasDangerousExtension('safe.txt');\n     38|    expect(result).toBe(false);\n       |                   ^\n     39|   });\n     40|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/50]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/50]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/50]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/50]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .pdf files\n\nAssertionError: expected undefined to be false // Object.is equality\n\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:52:50\n\n     50| \n     51|   it('should allow .pdf files', () => {\n     52|    expect(hasDangerousExtension('document.pdf')).toBe(false);\n       |                                                  ^\n     53|   });\n     54| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/50]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should allow .jpg files\nAssertionError: expected undefined to be false // Object.is equality\n\n- Expected: \nfalse\n\n+ Received: \nundefined\n\n ❯ tests/unit/lib/security.test.ts:56:47\n\n     54| \n     55|   it('should allow .jpg files', () => {\n     56|    expect(hasDangerousExtension('photo.jpg')).toBe(false);\n       |                                               ^\n     57|   });\n     58| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/50]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected undefined to be true // Object.is equality\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/50]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[43/50]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  50 failed | 476 passed (526)\n\n   Start at  23:07:04\n\n   Duration  11.06s (transform 5.75s, setup 0ms, collect 9.74s, tests 8.79s, environment 10ms, prepare 19.01s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 2, "line": 150 },
						"start": { "column": 66, "line": 124 }
					}
				},
				{
					"id": "165",
					"mutatorName": "ArrayDeclaration",
					"replacement": "[]",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 177ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 25ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 57ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 42ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 17ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 40ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 6ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 610ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 303ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 171ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 68ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 185ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 107ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 57ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 38ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 106ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 13ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 7ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 65ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 2ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6651ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1635ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1738ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1205ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 305ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 288ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 7ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n      Tests  41 failed | 485 passed (526)\n   Start at  23:07:05\n\n   Duration  13.95s (transform 7.39s, setup 0ms, collect 11.42s, tests 10.48s, environment 11ms, prepare 22.77s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 3, "line": 146 },
						"start": { "column": 20, "line": 125 }
					}
				},
				{
					"id": "166",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 52ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 350ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 2 failed) 131ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 11ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 83ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 36ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 78ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 157ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 312ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 43ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 66ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 182ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 21ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 51ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 4 failed) 267ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 203ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 3ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 2 failed) 108ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 20ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6491ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1450ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 204ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 198ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1952ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 807ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 11 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/11]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/11]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/11]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/11]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/11]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/11]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/11]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/11]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  11 failed | 515 passed (526)\n\n   Start at  23:07:08\n\n   Duration  14.92s (transform 9.78s, setup 0ms, collect 16.87s, tests 10.63s, environment 9ms, prepare 22.33s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 126 }, "start": { "column": 3, "line": 126 } }
				},
				{
					"id": "167",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 144ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 37ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 53ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 19ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 106ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 66ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 229ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 270ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 367ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 351ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 200ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 283ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 45ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 336ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 327ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 31ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 17ms\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 9ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7013ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2000ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1677ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 758ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  5 failed | 27 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:07:10\n\n   Duration  14.47s (transform 7.57s, setup 0ms, collect 12.47s, tests 10.99s, environment 34ms, prepare 23.27s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 127 }, "start": { "column": 3, "line": 127 } }
				},
				{
					"id": "169",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 22ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 192ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 30ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 15ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 109ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 510ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 316ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 65ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 24ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 187ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 176ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5630ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 617ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1420ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 747ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:07:15\n\n   Duration  14.24s (transform 10.79s, setup 0ms, collect 15.91s, tests 8.58s, environment 11ms, prepare 22.99s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 129 }, "start": { "column": 3, "line": 129 } }
				},
				{
					"id": "170",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 171ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 73ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 14ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 50ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 191ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 473ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 417ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 62ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 20ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 141ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5952ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 939ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 997ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 549ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 135ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:07:15\n\n   Duration  14.48s (transform 8.55s, setup 0ms, collect 14.35s, tests 8.63s, environment 34ms, prepare 26.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 130 }, "start": { "column": 3, "line": 130 } }
				},
				{
					"id": "168",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 56ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 9ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 102ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 9ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 235ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 249ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 215ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 570ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 261ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 189ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 179ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5652ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 636ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1395ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 579ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:07:15\n\n   Duration  14.49s (transform 9.63s, setup 0ms, collect 15.84s, tests 9.13s, environment 8ms, prepare 22.83s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 128 }, "start": { "column": 3, "line": 128 } }
				},
				{
					"id": "171",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 26ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 12ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 55ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 50ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 55ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 11ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 97ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 19ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 127ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 162ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 148ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 46ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 2935ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 2925ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1085ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 617ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 21ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:07:28\n\n   Duration  8.67s (transform 3.24s, setup 0ms, collect 7.14s, tests 5.04s, environment 8ms, prepare 13.32s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 131 }, "start": { "column": 3, "line": 131 } }
				},
				{
					"id": "172",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 28ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 122ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 35ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 57ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 396ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 383ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 25ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 202ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 178ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6219ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1205ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1146ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 518ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 133ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  4 failed | 28 passed (32)\n\n      Tests  4 failed | 522 passed (526)\n\n   Start at  23:07:31\n\n   Duration  11.68s (transform 6.61s, setup 0ms, collect 10.02s, tests 8.78s, environment 11ms, prepare 18.74s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 132 }, "start": { "column": 3, "line": 132 } }
				},
				{
					"id": "173",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 25ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 11ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 28ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 13ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 111ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 233ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 433ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 380ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 31ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 47ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 112ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5933ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 917ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1508ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 885ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 38ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 19ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:07:33\n\n   Duration  14.40s (transform 6.81s, setup 0ms, collect 13.52s, tests 8.88s, environment 8ms, prepare 20.39s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 133 }, "start": { "column": 3, "line": 133 } }
				},
				{
					"id": "174",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 247ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 252ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 241ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 211ms\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 252ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 11ms\n     → expected false to be true // Object.is equality\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 380ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 469ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 435ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 163ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 30ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 29ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2129ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 943ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7065ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2051ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  3 failed | 523 passed (526)\n   Start at  23:07:35\n\n   Duration  14.48s (transform 7.58s, setup 0ms, collect 13.17s, tests 11.59s, environment 19ms, prepare 22.97s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 134 }, "start": { "column": 3, "line": 134 } }
				},
				{
					"id": "175",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 38ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 27ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 51ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 263ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 41ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 87ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 266ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 211ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 173ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6409ms\n\n   × Theme Store > Store Structure > should have subscribe method 5020ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1380ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1730ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 857ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n      Tests  3 failed | 523 passed (526)\n   Start at  23:07:36\n\n   Duration  14.82s (transform 8.96s, setup 0ms, collect 16.76s, tests 9.49s, environment 25ms, prepare 23.72s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 135 }, "start": { "column": 3, "line": 135 } }
				},
				{
					"id": "176",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 33ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 16ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 272ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 50ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 122ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 486ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 316ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 67ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 177ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 56ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 56ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5598ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 557ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 118ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1362ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 638ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 159ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:07:42\n\n   Duration  13.32s (transform 7.18s, setup 0ms, collect 12.97s, tests 8.76s, environment 34ms, prepare 22.34s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 136 }, "start": { "column": 3, "line": 136 } }
				},
				{
					"id": "177",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 1 failed) 141ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 41ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 102ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 36ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 260ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 205ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 198ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 436ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 333ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 41ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 70ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 105ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5298ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1166ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 640ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:07:43\n\n   Duration  13.77s (transform 8.75s, setup 0ms, collect 14.76s, tests 8.36s, environment 10ms, prepare 22.70s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 137 }, "start": { "column": 3, "line": 137 } }
				},
				{
					"id": "178",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 28ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 89ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 197ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 182ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 61ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 335ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 172ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4672ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4662ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1136ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 509ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 39ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:07:44\n\n   Duration  12.74s (transform 7.75s, setup 0ms, collect 15.43s, tests 7.27s, environment 10ms, prepare 19.81s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 138 },
						"start": { "column": 3, "line": 138 }
					}
				},
				{
					"id": "179",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 3 failed) 41ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 16ms\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 59ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 31ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 9ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 159ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3266ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3250ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 54ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 1 failed) 156ms\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 146ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1650ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 905ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:07:55\n\n   Duration  9.23s (transform 4.04s, setup 0ms, collect 8.20s, tests 5.87s, environment 10ms, prepare 15.02s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 8, "line": 139 }, "start": { "column": 3, "line": 139 } }
				},
				{
					"id": "180",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 157ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 102ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 15ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 76ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 250ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 351ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 337ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 40ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 37ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 26ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 195ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6096ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1083ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1413ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 684ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 19ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 85ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:07:58\n\n   Duration  11.69s (transform 5.62s, setup 0ms, collect 8.13s, tests 9.20s, environment 24ms, prepare 17.70s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 10, "line": 140 },
						"start": { "column": 3, "line": 140 }
					}
				},
				{
					"id": "181",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 32ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 225ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 110ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 89ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 150ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 160ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 83ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 385ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 587ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 302ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 42ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 75ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 194ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 20ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5214ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1625ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 979ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 18ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 14ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:08:00\n\n   Duration  13.25s (transform 5.35s, setup 0ms, collect 11.63s, tests 9.22s, environment 8ms, prepare 20.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 141 }, "start": { "column": 3, "line": 141 } }
				},
				{
					"id": "182",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 90ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 44ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 157ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 127ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 355ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 320ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 296ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 286ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7194ms\n\n   × Theme Store > Store Structure > should have subscribe method 5133ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2052ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1911ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 960ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:08:01\n\n   Duration  15.29s (transform 8.63s, setup 0ms, collect 15.56s, tests 10.60s, environment 8ms, prepare 23.35s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 142 }, "start": { "column": 3, "line": 142 } }
				},
				{
					"id": "183",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 24ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 10ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 139ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 351ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 64ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 89ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 29ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 28ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 13ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 1 failed) 135ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 98ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7702ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2674ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 35ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2037ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 734ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  3 failed | 29 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n\n   Start at  23:08:03\n\n   Duration  15.20s (transform 9.79s, setup 0ms, collect 13.89s, tests 11.06s, environment 13ms, prepare 22.05s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 143 }, "start": { "column": 3, "line": 143 } }
				},
				{
					"id": "184",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 126ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 20ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 332ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 183ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 488ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 203ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4741ms\n   ✓ Theme Store > Store Structure > should have subscribe method 4732ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1157ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 588ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:08:09\n\n   Duration  13.49s (transform 5.98s, setup 0ms, collect 13.11s, tests 7.64s, environment 11ms, prepare 23.79s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 144 }, "start": { "column": 3, "line": 144 } }
				},
				{
					"id": "185",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 1 failed) 97ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 78ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 129ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 383ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 403ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 329ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 118ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 547ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 420ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 39ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 12ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4203ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4191ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1264ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 603ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 150ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:08:10\n\n   Duration  13.05s (transform 6.22s, setup 0ms, collect 12.26s, tests 7.69s, environment 11ms, prepare 20.24s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 9, "line": 145 }, "start": { "column": 3, "line": 145 } }
				},
				{
					"id": "186",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 153ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 29ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 11ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 3ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 16ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 154ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 32ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 26ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 56ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 223ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 321ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 34ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 459ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 362ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 231ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 115ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 96ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 58ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 47ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5058ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1343ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 744ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 14ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 10ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:10\n\n   Duration  12.89s (transform 7.46s, setup 0ms, collect 15.20s, tests 8.45s, environment 9ms, prepare 20.69s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "187",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 25ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 51ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 37ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 10ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 141ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 34ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 40ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 71ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 49ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 9ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 24ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 219ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 140ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 38ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1624ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1043ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5352ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 335ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 371ms\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 365ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:60:49\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:22\n\n   Duration  10.43s (transform 5.21s, setup 0ms, collect 7.94s, tests 8.41s, environment 11ms, prepare 15.74s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "188",
					"mutatorName": "LogicalOperator",
					"replacement": "filename.toLowerCase().split('.').pop() && ''",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 74ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 32ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 18ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 99ms\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 31ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 34ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 386ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 87ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 18ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 58ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 68ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 197ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 62ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 82ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 31ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 198ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 33ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 99ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 35ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 30ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 78ms\n   × Security Utils > hasDangerousExtension > should detect .exe files 37ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 3ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6665ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1645ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 248ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 200ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 8ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 11ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1527ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 849ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 26ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:25\n\n   Duration  12.97s (transform 7.07s, setup 0ms, collect 11.67s, tests 10.32s, environment 10ms, prepare 18.84s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "189",
					"mutatorName": "MethodExpression",
					"replacement": "filename.toUpperCase()",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 28ms\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 11ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n     → expected false to be true // Object.is equality\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 37ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 44ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 194ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 71ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 10ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 31ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 360ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 347ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 191ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 33ms\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 8ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 2ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n     → expected false to be true // Object.is equality\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 2ms\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5620ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 600ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 12ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 76ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 65ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1415ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 667ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 353ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 347ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:26\n\n   Duration  14.22s (transform 7.85s, setup 0ms, collect 15.83s, tests 8.62s, environment 37ms, prepare 23.49s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 36, "line": 148 },
						"start": { "column": 14, "line": 148 }
					}
				},
				{
					"id": "190",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 140ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 122ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 5ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 140ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 267ms\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 336ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 103ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 113ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 28ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 18ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 0ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 28ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 21ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 1ms\n     → expected false to be true // Object.is equality\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 1ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 142ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 251ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 22ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 178ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 108ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 55ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 10ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 21ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 27ms\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 248ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 30ms\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .sh files 26ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 120ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 42ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7153ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2137ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1803ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 738ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 285ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 151ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:29\n\n   Duration  15.34s (transform 9.56s, setup 0ms, collect 14.61s, tests 11.29s, environment 28ms, prepare 22.80s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 46, "line": 148 },
						"start": { "column": 43, "line": 148 }
					}
				},
				{
					"id": "191",
					"mutatorName": "StringLiteral",
					"replacement": "\"Stryker was here!\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 162ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 40ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 51ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 259ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 272ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 24ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 32ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 170ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6772ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1740ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 62ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2140ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 977ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  23:08:30\n   Duration  15.14s (transform 11.99s, setup 0ms, collect 18.06s, tests 10.35s, environment 13ms, prepare 24.20s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 59, "line": 148 },
						"start": { "column": 57, "line": 148 }
					}
				},
				{
					"id": "192",
					"mutatorName": "StringLiteral",
					"replacement": "``",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 264ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ❯ tests/unit/lib/security-extended.test.ts (25 tests | 4 failed) 91ms\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions 15ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect mixed case 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions 18ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security-complete.test.ts (42 tests | 20 failed) 127ms\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe 14ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat 4ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd 37ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com 13ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js 28ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse 8ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf 2ms\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb 0ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm 0ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 133ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 239ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 411ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 61ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 54ms\n\n ❯ tests/unit/lib/security-comprehensive.test.ts (23 tests | 11 failed) 318ms\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe 210ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat 1ms\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs 86ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app 1ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE 3ms\n\n     → expected false to be true // Object.is equality\n\n   × Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names 1ms\n\n     → expected false to be true // Object.is equality\n\n ❯ tests/unit/lib/security.test.ts (16 tests | 4 failed) 108ms\n\n   × Security Utils > hasDangerousExtension > should detect .exe files 94ms\n     → expected false to be true // Object.is equality\n   × Security Utils > hasDangerousExtension > should detect .sh files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should detect .bat files 2ms\n\n     → expected false to be true // Object.is equality\n\n   × Security Utils > hasDangerousExtension > should be case insensitive 1ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5106ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 77ms\n\n ❯ tests/unit/lib/security-real-import.test.ts (6 tests | 1 failed) 14ms\n\n   × Security - Real Import Tests > hasDangerousExtension > should detect .exe 8ms\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1191ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 669ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 202ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 41 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:97:46\n\n     95|  describe('hasDangerousExtension - all extensions', () => {\n     96|   it('should detect .exe', () => {\n     97|    expect(hasDangerousExtension('file.exe')).toBe(true);\n       |                                              ^\n     98|   });\n     99| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bat\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:101:46\n\n     99| \n    100|   it('should detect .bat', () => {\n    101|    expect(hasDangerousExtension('file.bat')).toBe(true);\n       |                                              ^\n    102|   });\n    103| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .cmd\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:105:46\n\n    103| \n    104|   it('should detect .cmd', () => {\n    105|    expect(hasDangerousExtension('file.cmd')).toBe(true);\n       |                                              ^\n    106|   });\n    107| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .com\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:109:46\n\n    107| \n    108|   it('should detect .com', () => {\n    109|    expect(hasDangerousExtension('file.com')).toBe(true);\n       |                                              ^\n    110|   });\n    111| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .pif\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:113:46\n    111| \n    112|   it('should detect .pif', () => {\n    113|    expect(hasDangerousExtension('file.pif')).toBe(true);\n       |                                              ^\n    114|   });\n    115| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .scr\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:117:46\n    115| \n    116|   it('should detect .scr', () => {\n    117|    expect(hasDangerousExtension('file.scr')).toBe(true);\n       |                                              ^\n    118|   });\n    119| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .vbs\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:121:46\n    119| \n    120|   it('should detect .vbs', () => {\n    121|    expect(hasDangerousExtension('file.vbs')).toBe(true);\n       |                                              ^\n    122|   });\n    123| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .js\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:125:45\n    123| \n    124|   it('should detect .js', () => {\n    125|    expect(hasDangerousExtension('file.js')).toBe(true);\n       |                                             ^\n    126|   });\n    127| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jse\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:129:46\n    127| \n    128|   it('should detect .jse', () => {\n    129|    expect(hasDangerousExtension('file.jse')).toBe(true);\n       |                                              ^\n    130|   });\n    131| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsf\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:133:46\n    131| \n    132|   it('should detect .wsf', () => {\n    133|    expect(hasDangerousExtension('file.wsf')).toBe(true);\n       |                                              ^\n    134|   });\n    135| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .wsh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:137:46\n    135| \n    136|   it('should detect .wsh', () => {\n    137|    expect(hasDangerousExtension('file.wsh')).toBe(true);\n       |                                              ^\n    138|   });\n    139| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .ps1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:141:46\n    139| \n    140|   it('should detect .ps1', () => {\n    141|    expect(hasDangerousExtension('file.ps1')).toBe(true);\n       |                                              ^\n    142|   });\n    143| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .psm1\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:145:47\n    143| \n    144|   it('should detect .psm1', () => {\n    145|    expect(hasDangerousExtension('file.psm1')).toBe(true);\n       |                                               ^\n    146|   });\n    147| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .sh\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:149:45\n    147| \n    148|   it('should detect .sh', () => {\n    149|    expect(hasDangerousExtension('file.sh')).toBe(true);\n       |                                             ^\n    150|   });\n    151| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .bash\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:153:47\n    151| \n    152|   it('should detect .bash', () => {\n    153|    expect(hasDangerousExtension('file.bash')).toBe(true);\n       |                                               ^\n    154|   });\n    155| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .csh\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:157:46\n\n    155| \n    156|   it('should detect .csh', () => {\n    157|    expect(hasDangerousExtension('file.csh')).toBe(true);\n       |                                              ^\n    158|   });\n    159| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .jar\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:161:46\n    159| \n    160|   it('should detect .jar', () => {\n    161|    expect(hasDangerousExtension('file.jar')).toBe(true);\n       |                                              ^\n    162|   });\n    163| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .app\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:165:46\n    163| \n    164|   it('should detect .app', () => {\n    165|    expect(hasDangerousExtension('file.app')).toBe(true);\n       |                                              ^\n    166|   });\n    167| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/41]⎯\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .deb\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n ❯ tests/unit/lib/security-complete.test.ts:169:46\n\n    167| \n    168|   it('should detect .deb', () => {\n    169|    expect(hasDangerousExtension('file.deb')).toBe(true);\n       |                                              ^\n    170|   });\n    171| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/41]⎯\n\n\n FAIL  tests/unit/lib/security-complete.test.ts > Security - Complete Coverage > hasDangerousExtension - all extensions > should detect .rpm\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-complete.test.ts:173:46\n\n    171| \n    172|   it('should detect .rpm', () => {\n    173|    expect(hasDangerousExtension('file.rpm')).toBe(true);\n       |                                              ^\n    174|   });\n    175| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block file.exe\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block script.bat\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block run.cmd\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.com\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block virus.scr\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block evil.vbs\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block hack.jar\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should block app.app\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:72:45\n\n     70|   actualDangerous.forEach((filename) => {\n     71|    it(`should block ${filename}`, () => {\n     72|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n     73|    });\n     74|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle uppercase EXE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:77:46\n\n     75| \n     76|   it('should handle uppercase EXE', () => {\n     77|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     78|   });\n     79| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should handle mixed case ExE\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:81:46\n\n     79| \n     80|   it('should handle mixed case ExE', () => {\n     81|    expect(hasDangerousExtension('file.ExE')).toBe(true);\n       |                                              ^\n     82|   });\n     83| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/41]⎯\n\n\n FAIL  tests/unit/lib/security-comprehensive.test.ts > Security - Mutation Testing Improvements > hasDangerousExtension - Known Dangerous > should check last extension in compound names\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-comprehensive.test.ts:95:53\n\n     93| \n     94|   it('should check last extension in compound names', () => {\n     95|    expect(hasDangerousExtension('archive.tar.exe')).toBe(true);\n       |                                                     ^\n     96|   });\n     97|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect uppercase extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:79:46\n\n     77|  describe('dangerous extensions edge cases', () => {\n     78|   it('should detect uppercase extensions', () => {\n     79|    expect(hasDangerousExtension('FILE.EXE')).toBe(true);\n       |                                              ^\n     80|   });\n     81| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/41]⎯\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect mixed case\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:84:47\n\n     82|   it('should detect mixed case', () => {\n     83|    // Function already imported\n     84|    expect(hasDangerousExtension('script.Sh')).toBe(true);\n       |                                               ^\n     85|   });\n     86| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should handle multiple extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:89:49\n\n     87|   it('should handle multiple extensions', () => {\n     88|    // Function already imported\n     89|    expect(hasDangerousExtension('file.tar.sh')).toBe(true);\n       |                                                 ^\n     90|   });\n     91| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/41]⎯\n\n\n FAIL  tests/unit/lib/security-extended.test.ts > Security Extended Tests > dangerous extensions edge cases > should detect all dangerous script extensions\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-extended.test.ts:130:45\n\n    128| \n    129|    dangerous.forEach((filename) => {\n    130|     expect(hasDangerousExtension(filename)).toBe(true);\n       |                                             ^\n    131|    });\n    132|   });\n\n ❯ tests/unit/lib/security-extended.test.ts:129:14\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/41]⎯\n\n\n FAIL  tests/unit/lib/security-real-import.test.ts > Security - Real Import Tests > hasDangerousExtension > should detect .exe\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security-real-import.test.ts:33:19\n\n     31|   it('should detect .exe', () => {\n     32|    const result = hasDangerousExtension('virus.exe');\n     33|    expect(result).toBe(true);\n       |                   ^\n     34|   });\n     35| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/41]⎯\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .exe files\n\nAssertionError: expected false to be true // Object.is equality\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:40:49\n\n     38|  describe('hasDangerousExtension', () => {\n     39|   it('should detect .exe files', () => {\n     40|    expect(hasDangerousExtension('malware.exe')).toBe(true);\n       |                                                 ^\n     41|   });\n     42| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .sh files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:44:47\n\n     42| \n     43|   it('should detect .sh files', () => {\n     44|    expect(hasDangerousExtension('script.sh')).toBe(true);\n       |                                               ^\n     45|   });\n     46| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should detect .bat files\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:48:48\n\n     46| \n     47|   it('should detect .bat files', () => {\n     48|    expect(hasDangerousExtension('script.bat')).toBe(true);\n       |                                                ^\n     49|   });\n     50| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/41]⎯\n\n\n FAIL  tests/unit/lib/security.test.ts > Security Utils > hasDangerousExtension > should be case insensitive\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/security.test.ts:60:49\n\n     58| \n     59|   it('should be case insensitive', () => {\n     60|    expect(hasDangerousExtension('MALWARE.EXE')).toBe(true);\n       |                                                 ^\n     61|   });\n     62|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/41]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/41]⎯\n\n\n Test Files  6 failed | 26 passed (32)\n\n      Tests  41 failed | 485 passed (526)\n\n   Start at  23:08:38\n\n   Duration  13.11s (transform 6.99s, setup 0ms, collect 12.55s, tests 8.72s, environment 9ms, prepare 23.68s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": {
						"end": { "column": 37, "line": 149 },
						"start": { "column": 28, "line": 149 }
					}
				}
			],
			"source": "import type { Handle } from '@sveltejs/kit';\n\n/**\n * Security middleware for HTTP headers and request validation\n */\nexport const securityHeaders: Handle = async ({ event, resolve }) => {\n\tconst response = await resolve(event);\n\n\t// Security headers\n\tresponse.headers.set('X-Content-Type-Options', 'nosniff');\n\tresponse.headers.set('X-Frame-Options', 'DENY');\n\tresponse.headers.set('X-XSS-Protection', '1; mode=block');\n\tresponse.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n\tresponse.headers.set(\n\t\t'Permissions-Policy',\n\t\t'camera=(), microphone=(), geolocation=(), interest-cohort=()'\n\t);\n\n\t// Content Security Policy\n\tresponse.headers.set(\n\t\t'Content-Security-Policy',\n\t\t[\n\t\t\t\"default-src 'self'\",\n\t\t\t\"script-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"style-src 'self' 'unsafe-inline'\", // unsafe-inline needed for Svelte\n\t\t\t\"img-src 'self' data: blob:\",\n\t\t\t\"font-src 'self' data:\",\n\t\t\t\"connect-src 'self'\",\n\t\t\t\"frame-ancestors 'none'\",\n\t\t\t\"base-uri 'self'\",\n\t\t\t\"form-action 'self'\"\n\t\t].join('; ')\n\t);\n\n\t// HSTS (HTTP Strict Transport Security) - only in production with HTTPS\n\tif (event.url.protocol === 'https:') {\n\t\tresponse.headers.set('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');\n\t}\n\n\treturn response;\n};\n\n/**\n * Enforce HTTPS in production\n */\nexport const httpsRedirect: Handle = async ({ event, resolve }) => {\n\tconst proto = event.request.headers.get('x-forwarded-proto');\n\n\t// In production, redirect HTTP to HTTPS\n\tif (process.env.NODE_ENV === 'production' && proto === 'http') {\n\t\tconst httpsUrl = event.url.toString().replace('http://', 'https://');\n\t\treturn new Response(null, {\n\t\t\tstatus: 301,\n\t\t\theaders: {\n\t\t\t\tlocation: httpsUrl\n\t\t\t}\n\t\t});\n\t}\n\n\treturn resolve(event);\n};\n\n/**\n * Sanitize user input to prevent XSS\n */\nexport function sanitizeInput(input: string): string {\n\tlet sanitized = input;\n\n\t// Remove dangerous characters - loop to handle nested attempts\n\twhile (sanitized !== (sanitized = sanitized.replace(/[<>]/g, '')));\n\n\t// Remove javascript: protocol - loop to handle obfuscation like jajavascript:vascript:\n\twhile (sanitized !== (sanitized = sanitized.replace(/javascript:/gi, '')));\n\n\t// Remove all URL schemes that could be dangerous\n\tsanitized = sanitized.replace(/\\b(javascript|data|vbscript|about):/gi, '');\n\n\t// Remove event handlers - more comprehensive\n\tsanitized = sanitized.replace(/\\s*on\\w+\\s*=/gi, '');\n\n\treturn sanitized.trim();\n}\n\n/**\n * Validate filename for security\n */\nexport function sanitizeFilename(filename: string): string {\n\t// Remove path traversal attempts\n\tlet sanitized = filename.replace(/\\.\\./g, '');\n\n\t// Remove potentially dangerous characters\n\tsanitized = sanitized.replace(/[/\\\\]/g, '_');\n\n\t// Limit length\n\tif (sanitized.length > 255) {\n\t\tconst ext = sanitized.split('.').pop() || '';\n\t\tconst nameWithoutExt = sanitized.substring(0, 255 - ext.length - 1);\n\t\tsanitized = `${nameWithoutExt}.${ext}`;\n\t}\n\n\treturn sanitized || 'unnamed_file';\n}\n\n/**\n * Validate MIME type against whitelist\n */\nexport function isValidMimeType(mimeType: string, allowedTypes: string[]): boolean {\n\t// If no restrictions, allow all\n\tif (allowedTypes.length === 0) return true;\n\n\t// Exact match\n\tif (allowedTypes.includes(mimeType)) return true;\n\n\t// Wildcard match (e.g., image/*)\n\tconst category = mimeType.split('/')[0];\n\tif (allowedTypes.includes(`${category}/*`)) return true;\n\n\treturn false;\n}\n\n/**\n * Detect potentially dangerous file extensions\n */\nexport function hasDangerousExtension(filename: string): boolean {\n\tconst dangerous = [\n\t\t'.exe',\n\t\t'.bat',\n\t\t'.cmd',\n\t\t'.com',\n\t\t'.pif',\n\t\t'.scr',\n\t\t'.vbs',\n\t\t'.js',\n\t\t'.jse',\n\t\t'.wsf',\n\t\t'.wsh',\n\t\t'.ps1',\n\t\t'.psm1',\n\t\t'.sh',\n\t\t'.bash',\n\t\t'.csh',\n\t\t'.jar',\n\t\t'.app',\n\t\t'.deb',\n\t\t'.rpm'\n\t];\n\n\tconst ext = filename.toLowerCase().split('.').pop() || '';\n\treturn dangerous.includes(`.${ext}`);\n}\n"
		},
		"src/lib/server/session.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "193",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 96ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 188ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 239ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 82ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 280ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 36ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 22ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5294ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1267ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 701ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 50ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:08:38\n\n   Duration  13.48s (transform 7.47s, setup 0ms, collect 13.67s, tests 7.94s, environment 9ms, prepare 20.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 59, "line": 16 }, "start": { "column": 40, "line": 16 } }
				},
				{
					"id": "194",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 26 }, "start": { "column": 22, "line": 19 } }
				},
				{
					"id": "195",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 84, "line": 21 }, "start": { "column": 24, "line": 21 } }
				},
				{
					"id": "196",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 111ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 180ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 25ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 44ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 131ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 327ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 315ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 45ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 221ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 20ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 44ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 36ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 23ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6017ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1002ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1542ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 886ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:08:53\n\n   Duration  11.74s (transform 4.85s, setup 0ms, collect 9.37s, tests 8.93s, environment 15ms, prepare 18.77s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 84, "line": 21 }, "start": { "column": 24, "line": 21 } }
				},
				{
					"id": "197",
					"mutatorName": "LogicalOperator",
					"replacement": "config.auth.sessionSecret && randomBytes(32).toString('hex')",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 43ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 43ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 41ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 314ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 94ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6246ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1222ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 29ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1401ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 637ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:08:54\n\n   Duration  14.02s (transform 7.52s, setup 0ms, collect 14.34s, tests 8.62s, environment 9ms, prepare 20.72s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 84, "line": 21 }, "start": { "column": 24, "line": 21 } }
				},
				{
					"id": "198",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 122ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 78ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 78ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 30ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 132ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 364ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 258ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 50ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ❯ tests/unit/lib/session.test.ts (0 test)\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 29ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 207ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7140ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2123ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 120ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1159ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 535ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts [ tests/unit/lib/session.test.ts ]\n\nTypeError: Unknown encoding: \n ❯ Function.initialize src/lib/server/session.ts:69:266\n\n\n\n ❯ src/lib/server/session.ts:206:16\n\n ❯ tests/unit/lib/session.test.ts:2:31\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  1 failed | 509 passed (510)\n\n   Start at  23:08:57\n\n   Duration  14.92s (transform 9.37s, setup 0ms, collect 14.22s, tests 10.10s, environment 8ms, prepare 23.89s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 83, "line": 21 }, "start": { "column": 78, "line": 21 } }
				},
				{
					"id": "199",
					"mutatorName": "BooleanLiteral",
					"replacement": "config.auth.sessionSecret",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 224ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 30ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 127ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 422ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 383ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 57ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 185ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6128ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1111ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1283ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 666ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 59ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:08:58\n\n   Duration  14.28s (transform 7.46s, setup 0ms, collect 13.14s, tests 8.95s, environment 262ms, prepare 23.69s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 22 }, "start": { "column": 7, "line": 22 } }
				},
				{
					"id": "200",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 33, "line": 22 }, "start": { "column": 7, "line": 22 } }
				},
				{
					"id": "201",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 33, "line": 22 }, "start": { "column": 7, "line": 22 } }
				},
				{
					"id": "202",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 37ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 309ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 344ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 327ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\nstdout | tests/unit/lib/session.test.ts\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 19ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 469ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 37ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 33ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1205ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 757ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5024ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 15ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:09:06\n\n   Duration  13.02s (transform 7.12s, setup 0ms, collect 13.17s, tests 8.18s, environment 10ms, prepare 20.38s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 24 }, "start": { "column": 35, "line": 22 } }
				},
				{
					"id": "203",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 47, "line": 23 }, "start": { "column": 16, "line": 23 } }
				},
				{
					"id": "204",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 44ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 334ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 319ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 70ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\n\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 20ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 175ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6064ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1051ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1832ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 973ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:09:20\n\n   Duration  10.94s (transform 5.51s, setup 0ms, collect 9.24s, tests 8.99s, environment 8ms, prepare 19.18s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 44, "line": 25 }, "start": { "column": 15, "line": 25 } }
				},
				{
					"id": "205",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 125ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 449ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 436ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 32ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 12ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 96ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 7 failed) 149ms\n\n   × SessionService > Session Creation > should create session with valid ID 8ms\n\n     → expected undefined to be defined\n\n   × SessionService > Session Creation > should create session with valid expiration 1ms\n\n     → Cannot read properties of undefined (reading 'createdAt')\n\n   × SessionService > Session Creation > should create admin session 1ms\n\n     → Cannot read properties of undefined (reading 'isAdmin')\n\n   × SessionService > Session Creation > should create unique session IDs 0ms\n\n     → Cannot read properties of undefined (reading 'id')\n\n   × SessionService > Session Retrieval > should retrieve valid session 1ms\n\n     → Cannot read properties of undefined (reading 'id')\n\n   × SessionService > Session Destruction > should destroy session 1ms\n\n     → Cannot read properties of undefined (reading 'id')\n\n   × SessionService > Session Count > should track session count 1ms\n\n     → expected 0 to be greater than 0\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 158ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 110ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 52ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5685ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 671ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 9ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1270ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 884ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 27ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 8 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid ID\n\nAssertionError: expected undefined to be defined\n\n ❯ tests/unit/lib/session.test.ts:10:20\n\n      8|    const session = SessionService.createSession();\n      9| \n     10|    expect(session).toBeDefined();\n       |                    ^\n     11|    expect(session.id).toBeDefined();\n     12|    expect(typeof session.id).toBe('string');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid expiration\nTypeError: Cannot read properties of undefined (reading 'createdAt')\n ❯ tests/unit/lib/session.test.ts:20:19\n\n     18|    const now = new Date();\n     19| \n     20|    expect(session.createdAt).toBeInstanceOf(Date);\n       |                   ^\n     21|    expect(session.expiresAt).toBeInstanceOf(Date);\n     22|    expect(session.expiresAt.getTime()).toBeGreaterThan(now.getTime());\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create admin session\nTypeError: Cannot read properties of undefined (reading 'isAdmin')\n ❯ tests/unit/lib/session.test.ts:28:19\n     26|    const session = SessionService.createSession();\n     27| \n     28|    expect(session.isAdmin).toBe(true);\n       |                   ^\n     29|   });\n     30| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create unique session IDs\nTypeError: Cannot read properties of undefined (reading 'id')\n ❯ tests/unit/lib/session.test.ts:35:20\n     33|    const session2 = SessionService.createSession();\n     34| \n     35|    expect(session1.id).not.toBe(session2.id);\n       |                    ^\n     36|   });\n     37|  });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\nTypeError: Cannot read properties of undefined (reading 'id')\n ❯ tests/unit/lib/session.test.ts:42:56\n     40|   it('should retrieve valid session', () => {\n     41|    const created = SessionService.createSession();\n     42|    const retrieved = SessionService.getSession(created.id);\n       |                                                        ^\n     43| \n     44|    expect(retrieved).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nTypeError: Cannot read properties of undefined (reading 'id')\n ❯ tests/unit/lib/session.test.ts:63:42\n\n     61|   it('should destroy session', () => {\n     62|    const session = SessionService.createSession();\n     63|    SessionService.destroySession(session.id);\n       |                                          ^\n     64| \n     65|    const retrieved = SessionService.getSession(session.id);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/8]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Count > should track session count\n\nAssertionError: expected 0 to be greater than 0\n\n ❯ tests/unit/lib/session.test.ts:81:21\n\n     79|    const newCount = SessionService.getSessionCount();\n     80| \n     81|    expect(newCount).toBeGreaterThan(initialCount);\n       |                     ^\n     82| \n     83|    SessionService.destroySession(session.id);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/8]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/8]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  8 failed | 518 passed (526)\n   Start at  23:09:21\n\n   Duration  12.41s (transform 6.11s, setup 0ms, collect 11.90s, tests 8.40s, environment 14ms, prepare 20.02s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 41 }, "start": { "column": 34, "line": 28 } }
				},
				{
					"id": "206",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 288ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 169ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 441ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 7 failed) 23ms\n\n   × SessionService > Session Creation > should create session with valid ID 8ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Creation > should create session with valid expiration 1ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Creation > should create admin session 2ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Creation > should create unique session IDs 1ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Retrieval > should retrieve valid session 1ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Destruction > should destroy session 1ms\n\n     → Unknown encoding: \n\n   × SessionService > Session Count > should track session count 1ms\n\n     → Unknown encoding: \n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 187ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 18ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 32ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 30ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5896ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 881ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 127ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2012ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1147ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 8 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid ID\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:8:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/8]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid expiration\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:17:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/8]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create admin session\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:26:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/8]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create unique session IDs\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:32:36\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:41:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/8]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nTypeError: Unknown encoding: \n\n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:62:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/8]⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Count > should track session count\n\nTypeError: Unknown encoding: \n ❯ Function.createSession src/lib/server/session.ts:86:34\n\n     84|     } else {\n     85|       stryCov_9fa48(\"205\");\n     86|       const id = randomBytes(32).toString(stryMutAct_9fa48(\"206\") ? \"\"…\n       |                                  ^\n     87|       const timeoutHours = config.auth.sessionTimeoutHours;\n     88|       const session: Session = stryMutAct_9fa48(\"207\") ? {} : (stryCov…\n\n ❯ tests/unit/lib/session.test.ts:78:35\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/8]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/8]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  8 failed | 518 passed (526)\n\n   Start at  23:09:24\n\n   Duration  13.94s (transform 7.83s, setup 0ms, collect 16.07s, tests 9.47s, environment 13ms, prepare 23.84s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 44, "line": 29 }, "start": { "column": 39, "line": 29 } }
				},
				{
					"id": "207",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 44ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 337ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 119ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 330ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 316ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 14ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 4 failed) 62ms\n\n   × SessionService > Session Creation > should create session with valid ID 7ms\n\n     → expected undefined to be defined\n\n   × SessionService > Session Creation > should create session with valid expiration 3ms\n\n     → expected undefined to be an instance of Date\n\n   × SessionService > Session Creation > should create admin session 39ms\n\n     → expected undefined to be true // Object.is equality\n\n   × SessionService > Session Creation > should create unique session IDs 1ms\n\n     → expected undefined not to be undefined // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 103ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 46ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 24ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5596ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 582ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1706ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 848ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid ID\n\nAssertionError: expected undefined to be defined\n ❯ tests/unit/lib/session.test.ts:11:23\n\n      9| \n     10|    expect(session).toBeDefined();\n     11|    expect(session.id).toBeDefined();\n       |                       ^\n     12|    expect(typeof session.id).toBe('string');\n     13|    expect(session.id.length).toBeGreaterThan(0);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid expiration\n\nAssertionError: expected undefined to be an instance of Date\n ❯ tests/unit/lib/session.test.ts:20:30\n\n     18|    const now = new Date();\n     19| \n     20|    expect(session.createdAt).toBeInstanceOf(Date);\n       |                              ^\n     21|    expect(session.expiresAt).toBeInstanceOf(Date);\n     22|    expect(session.expiresAt.getTime()).toBeGreaterThan(now.getTime());\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create admin session\n\nAssertionError: expected undefined to be true // Object.is equality\n\n\n- Expected: \ntrue\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:28:28\n\n     26|    const session = SessionService.createSession();\n     27| \n     28|    expect(session.isAdmin).toBe(true);\n       |                            ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create unique session IDs\n\nAssertionError: expected undefined not to be undefined // Object.is equality\n\n ❯ tests/unit/lib/session.test.ts:35:28\n\n     33|    const session2 = SessionService.createSession();\n     34| \n     35|    expect(session1.id).not.toBe(session2.id);\n       |                            ^\n     36|   });\n     37|  });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  5 failed | 521 passed (526)\n\n   Start at  23:09:25\n\n   Duration  13.72s (transform 5.93s, setup 0ms, collect 12.55s, tests 8.77s, environment 8ms, prepare 20.45s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 37 }, "start": { "column": 28, "line": 32 } }
				},
				{
					"id": "209",
					"mutatorName": "ArithmeticOperator",
					"replacement": "timeoutHours * 60 * 60 / 1000",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 66, "line": 35 }, "start": { "column": 37, "line": 35 } }
				},
				{
					"id": "210",
					"mutatorName": "ArithmeticOperator",
					"replacement": "timeoutHours * 60 / 60",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 59, "line": 35 }, "start": { "column": 37, "line": 35 } }
				},
				{
					"id": "208",
					"mutatorName": "ArithmeticOperator",
					"replacement": "Date.now() - timeoutHours * 60 * 60 * 1000",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 194ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 65ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 271ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 148ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 283ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 16ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 2 failed) 22ms\n\n   × SessionService > Session Creation > should create session with valid expiration 10ms\n\n     → expected 1764972580521 to be greater than 1765058980521\n\n   × SessionService > Session Retrieval > should retrieve valid session 3ms\n\n     → expected undefined to be '69ea715c00b0e694f552de2a1c0ec293e174f…' // Object.is equality\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 58ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4384ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4374ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 30ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1244ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 745ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create session with valid expiration\n\nAssertionError: expected 1764972580521 to be greater than 1765058980521\n\n ❯ tests/unit/lib/session.test.ts:22:40\n\n     20|    expect(session.createdAt).toBeInstanceOf(Date);\n     21|    expect(session.expiresAt).toBeInstanceOf(Date);\n     22|    expect(session.expiresAt.getTime()).toBeGreaterThan(now.getTime());\n       |                                        ^\n     23|   });\n     24| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be '69ea715c00b0e694f552de2a1c0ec293e174f…' // Object.is equality\n\n\n- Expected: \n\"69ea715c00b0e694f552de2a1c0ec293e174fa7cf8444454a1095be5d7627d82\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:45:26\n\n     43| \n     44|    expect(retrieved).toBeDefined();\n     45|    expect(retrieved?.id).toBe(created.id);\n       |                          ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:09:33\n\n   Duration  12.37s (transform 8.69s, setup 0ms, collect 14.54s, tests 7.10s, environment 8ms, prepare 19.50s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 66, "line": 35 }, "start": { "column": 24, "line": 35 } }
				},
				{
					"id": "211",
					"mutatorName": "ArithmeticOperator",
					"replacement": "timeoutHours / 60",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 20ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 55ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 51ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 51ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 70ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 244ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 250ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 191ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 80ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1370ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 730ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5810ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 796ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 133ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:09:44\n\n   Duration  11.51s (transform 5.73s, setup 0ms, collect 9.64s, tests 8.55s, environment 8ms, prepare 18.80s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 54, "line": 35 }, "start": { "column": 37, "line": 35 } }
				},
				{
					"id": "212",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 18ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 197ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 60ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 380ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 353ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 33ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 64ms\n\n   × SessionService > Session Creation > should create admin session 14ms\n\n     → expected false to be true // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 20ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 232ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6888ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1873ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1707ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 989ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Creation > should create admin session\n\nAssertionError: expected false to be true // Object.is equality\n\n\n- Expected\n+ Received\n\n- true\n+ false\n\n\n ❯ tests/unit/lib/session.test.ts:28:28\n\n     26|    const session = SessionService.createSession();\n     27| \n     28|    expect(session.isAdmin).toBe(true);\n       |                            ^\n     29|   });\n     30| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:09:46\n\n   Duration  12.74s (transform 8.36s, setup 0ms, collect 12.92s, tests 9.99s, environment 9ms, prepare 19.00s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 17, "line": 36 }, "start": { "column": 13, "line": 36 } }
				},
				{
					"id": "213",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 84ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 90ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 486ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 468ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 23ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 23ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 3 failed) 235ms\n   × SessionService > Session Retrieval > should retrieve valid session 84ms\n\n     → expected undefined to be defined\n   × SessionService > Session Retrieval > should return null for non-existent session 55ms\n     → expected undefined to be null\n   × SessionService > Session Destruction > should destroy session 1ms\n     → expected undefined to be null\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 230ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6014ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1001ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 16ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 40ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1297ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 485ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be defined\n ❯ tests/unit/lib/session.test.ts:44:22\n\n     42|    const retrieved = SessionService.getSession(created.id);\n     43| \n     44|    expect(retrieved).toBeDefined();\n       |                      ^\n     45|    expect(retrieved?.id).toBe(created.id);\n     46|   });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should return null for non-existent session\n\nAssertionError: expected undefined to be null\n\n\n- Expected: \nnull\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:50:22\n\n     48|   it('should return null for non-existent session', () => {\n     49|    const retrieved = SessionService.getSession('non-existent-id');\n     50|    expect(retrieved).toBeNull();\n       |                      ^\n     51|   });\n     52| \n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nAssertionError: expected undefined to be null\n\n- Expected: \nnull\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:66:22\n\n     64| \n     65|    const retrieved = SessionService.getSession(session.id);\n     66|    expect(retrieved).toBeNull();\n       |                      ^\n     67|   });\n     68| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  4 failed | 522 passed (526)\n   Start at  23:09:47\n\n   Duration  12.39s (transform 6.67s, setup 0ms, collect 12.73s, tests 8.81s, environment 8ms, prepare 18.74s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 54 }, "start": { "column": 55, "line": 43 } }
				},
				{
					"id": "214",
					"mutatorName": "BooleanLiteral",
					"replacement": "session",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 23ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 42ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 334ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 295ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 251ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 14ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 3 failed) 81ms\n   × SessionService > Session Retrieval > should retrieve valid session 47ms\n     → expected undefined to be '4dd98cc3431bbd2bddaad54ac48a498566fc6…' // Object.is equality\n   × SessionService > Session Retrieval > should return null for non-existent session 12ms\n     → Cannot read properties of undefined (reading 'expiresAt')\n   × SessionService > Session Destruction > should destroy session 7ms\n     → Cannot read properties of undefined (reading 'expiresAt')\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 184ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 21ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 62ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 111ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4803ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4792ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1871ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1184ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 256ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 20ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be '4dd98cc3431bbd2bddaad54ac48a498566fc6…' // Object.is equality\n\n\n- Expected: \n\"4dd98cc3431bbd2bddaad54ac48a498566fc63ec5ed6f0bcd0e3094d58b00866\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:45:26\n\n     43| \n     44|    expect(retrieved).toBeDefined();\n     45|    expect(retrieved?.id).toBe(created.id);\n       |                          ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should return null for non-existent session\n\nTypeError: Cannot read properties of undefined (reading 'expiresAt')\n\n ❯ Function.getSession src/lib/server/session.ts:107:263\n\n\n\n ❯ tests/unit/lib/session.test.ts:49:37\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nTypeError: Cannot read properties of undefined (reading 'expiresAt')\n\n ❯ Function.getSession src/lib/server/session.ts:107:263\n\n\n\n ❯ tests/unit/lib/session.test.ts:65:37\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  3 failed | 523 passed (526)\n   Start at  23:09:51\n   Duration  13.83s (transform 8.48s, setup 0ms, collect 17.59s, tests 8.55s, environment 24ms, prepare 21.30s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 15, "line": 45 }, "start": { "column": 7, "line": 45 } }
				},
				{
					"id": "215",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 294ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 61ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 170ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 298ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 74ms\n\n   × SessionService > Session Retrieval > should retrieve valid session 63ms\n\n     → expected undefined to be '93ad78c6b53e6969431091fb73818a9f4092c…' // Object.is equality\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 113ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 28ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5518ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 497ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1958ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 873ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be '93ad78c6b53e6969431091fb73818a9f4092c…' // Object.is equality\n\n\n- Expected: \n\"93ad78c6b53e6969431091fb73818a9f4092c1a579ad3d52a1ec4d2f610bbbf2\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:45:26\n\n     43| \n     44|    expect(retrieved).toBeDefined();\n     45|    expect(retrieved?.id).toBe(created.id);\n       |                          ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:09:52\n\n   Duration  14.21s (transform 7.64s, setup 0ms, collect 13.66s, tests 8.94s, environment 11ms, prepare 23.74s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 15, "line": 45 }, "start": { "column": 7, "line": 45 } }
				},
				{
					"id": "218",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 48 }, "start": { "column": 7, "line": 48 } }
				},
				{
					"id": "216",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 88ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 13ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 359ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 131ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 344ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 332ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 91ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 2 failed) 144ms\n\n   × SessionService > Session Retrieval > should return null for non-existent session 71ms\n\n     → Cannot read properties of undefined (reading 'expiresAt')\n\n   × SessionService > Session Destruction > should destroy session 1ms\n\n     → Cannot read properties of undefined (reading 'expiresAt')\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 81ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4705ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4692ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1277ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 646ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should return null for non-existent session\n\nTypeError: Cannot read properties of undefined (reading 'expiresAt')\n\n ❯ Function.getSession src/lib/server/session.ts:107:263\n\n\n\n ❯ tests/unit/lib/session.test.ts:49:37\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nTypeError: Cannot read properties of undefined (reading 'expiresAt')\n\n ❯ Function.getSession src/lib/server/session.ts:107:263\n\n\n\n ❯ tests/unit/lib/session.test.ts:65:37\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:10:00\n\n   Duration  12.66s (transform 5.92s, setup 0ms, collect 12.43s, tests 7.62s, environment 9ms, prepare 21.69s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 15, "line": 45 }, "start": { "column": 7, "line": 45 } }
				},
				{
					"id": "217",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 76ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 210ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 404ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 408ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 394ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 91ms\n\n   × SessionService > Session Retrieval > should retrieve valid session 81ms\n\n     → expected undefined to be 'dedb876a78f9eea427d261ba819fd360e9fed…' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 40ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 4983ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 4973ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 43ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1380ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 802ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be 'dedb876a78f9eea427d261ba819fd360e9fed…' // Object.is equality\n\n\n- Expected: \n\"dedb876a78f9eea427d261ba819fd360e9fed8465d6f7a8de6159f2a43de5807\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:45:26\n\n     43| \n     44|    expect(retrieved).toBeDefined();\n     45|    expect(retrieved?.id).toBe(created.id);\n       |                          ^\n     46|   });\n     47| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:01\n\n   Duration  12.10s (transform 5.83s, setup 0ms, collect 12.15s, tests 8.06s, environment 18ms, prepare 18.58s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 48 }, "start": { "column": 7, "line": 48 } }
				},
				{
					"id": "219",
					"mutatorName": "EqualityOperator",
					"replacement": "new Date() >= session.expiresAt",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 37, "line": 48 }, "start": { "column": 7, "line": 48 } }
				},
				{
					"id": "220",
					"mutatorName": "EqualityOperator",
					"replacement": "new Date() <= session.expiresAt",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 29ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 48ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 171ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 307ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 77ms\n\n   × SessionService > Session Retrieval > should retrieve valid session 65ms\n\n     → expected undefined to be 'b43a61562045a678849b6ba08c5a1c4eff639…' // Object.is equality\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6086ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1070ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 188ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 87ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2175ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 925ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Retrieval > should retrieve valid session\n\nAssertionError: expected undefined to be 'b43a61562045a678849b6ba08c5a1c4eff639…' // Object.is equality\n\n\n- Expected: \n\"b43a61562045a678849b6ba08c5a1c4eff6396b52a8b21c6d1861c64645ed4d7\"\n\n+ Received: \nundefined\n\n\n ❯ tests/unit/lib/session.test.ts:45:26\n\n     43| \n     44|    expect(retrieved).toBeDefined();\n     45|    expect(retrieved?.id).toBe(created.id);\n       |                          ^\n     46|   });\n     47| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  23:10:14\n   Duration  13.11s (transform 7.20s, setup 0ms, collect 15.25s, tests 9.59s, environment 12ms, prepare 22.13s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 37, "line": 48 }, "start": { "column": 7, "line": 48 } }
				},
				{
					"id": "221",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 53ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 229ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 147ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 363ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 350ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7383ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2365ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1762ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 808ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 9ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:10:14\n\n   Duration  14.26s (transform 7.79s, setup 0ms, collect 15.72s, tests 10.41s, environment 15ms, prepare 21.61s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 51 }, "start": { "column": 39, "line": 48 } }
				},
				{
					"id": "222",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 370ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 45ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 28ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 254ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 561ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 25ms\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 175ms\n\n   × SessionService > Session Destruction > should destroy session 165ms\n\n     → expected { …(4) } to be null\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 72ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 268ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 127ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 153ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 20ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7480ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2463ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 21ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3052ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1370ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 21ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Destruction > should destroy session\n\nAssertionError: expected { …(4) } to be null\n\n\n- Expected: \nnull\n\n+ Received: \nObject {\n  \"createdAt\": 2025-12-06T22:10:25.107Z,\n  \"expiresAt\": 2025-12-07T22:10:25.107Z,\n  \"id\": \"177493d661ea00e61e8f94f762b1a821d8bbc0c4acbfa1722b5e5b975d1e2f1f\",\n  \"isAdmin\": true,\n}\n\n\n ❯ tests/unit/lib/session.test.ts:66:22\n\n     64| \n     65|    const retrieved = SessionService.getSession(session.id);\n     66|    expect(retrieved).toBeNull();\n       |                      ^\n     67|   });\n     68| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:10:18\n\n   Duration  16.21s (transform 9.02s, setup 0ms, collect 14.68s, tests 13.03s, environment 173ms, prepare 25.97s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 58 }, "start": { "column": 49, "line": 56 } }
				},
				{
					"id": "223",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 30ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 73ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 42ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 308ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 201ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 442ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 467ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 451ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 121ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 22ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6980ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1953ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 179ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1842ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 844ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 15ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 194ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:19\n\n   Duration  16.28s (transform 9.15s, setup 0ms, collect 18.85s, tests 11.27s, environment 15ms, prepare 26.40s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 68 }, "start": { "column": 72, "line": 60 } }
				},
				{
					"id": "225",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 13, "line": 62 }, "start": { "column": 10, "line": 62 } }
				},
				{
					"id": "224",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 4, "line": 67 }, "start": { "column": 50, "line": 61 } }
				},
				{
					"id": "226",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 18, "line": 63 }, "start": { "column": 14, "line": 63 } }
				},
				{
					"id": "227",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 49, "line": 64 }, "start": { "column": 12, "line": 64 } }
				},
				{
					"id": "228",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 17ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 146ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 49ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 51ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 257ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 208ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 116ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 26ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5979ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 959ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1346ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 651ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 28ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:43\n\n   Duration  12.13s (transform 8.42s, setup 0ms, collect 14.04s, tests 8.57s, environment 11ms, prepare 18.88s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 49, "line": 64 }, "start": { "column": 12, "line": 64 } }
				},
				{
					"id": "229",
					"mutatorName": "EqualityOperator",
					"replacement": "process.env.NODE_ENV !== 'production'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 28ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 22ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 153ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 235ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 424ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 397ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 17ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 20ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 178ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 49ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 17ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 94ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6337ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1322ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1542ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 758ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:44\n\n   Duration  12.40s (transform 6.12s, setup 0ms, collect 11.20s, tests 9.32s, environment 7ms, prepare 19.80s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 49, "line": 64 }, "start": { "column": 12, "line": 64 } }
				},
				{
					"id": "230",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 58ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 177ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 145ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 198ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 162ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 17ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 24ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 35ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 90ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5658ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 632ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 33ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1868ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 777ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:47\n\n   Duration  14.18s (transform 7.57s, setup 0ms, collect 17.38s, tests 8.69s, environment 13ms, prepare 23.81s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 49, "line": 64 }, "start": { "column": 37, "line": 64 } }
				},
				{
					"id": "231",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 208ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 317ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 326ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 308ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 534ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 324ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 65ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 18ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 19ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 22ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5682ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 622ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2047ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 987ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:10:47\n\n   Duration  14.66s (transform 7.29s, setup 0ms, collect 12.95s, tests 9.62s, environment 13ms, prepare 22.88s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 22, "line": 65 }, "start": { "column": 14, "line": 65 } }
				},
				{
					"id": "232",
					"mutatorName": "ArithmeticOperator",
					"replacement": "config.auth.sessionTimeoutHours * 60 / 60",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 53, "line": 66 }, "start": { "column": 12, "line": 66 } }
				},
				{
					"id": "233",
					"mutatorName": "ArithmeticOperator",
					"replacement": "config.auth.sessionTimeoutHours / 60",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 48, "line": 66 }, "start": { "column": 12, "line": 66 } }
				},
				{
					"id": "234",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 72 }, "start": { "column": 55, "line": 70 } }
				},
				{
					"id": "235",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 55, "line": 71 }, "start": { "column": 42, "line": 71 } }
				},
				{
					"id": "236",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 27ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 17ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 85ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 163ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 143ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5350ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 335ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1571ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 843ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 106ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 51ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:11:10\n\n   Duration  11.82s (transform 5.96s, setup 0ms, collect 9.86s, tests 7.91s, environment 8ms, prepare 19.46s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 53, "line": 71 }, "start": { "column": 50, "line": 71 } }
				},
				{
					"id": "237",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 145ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 42ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 38ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 21ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 259ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 19ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5943ms\n\n   × Theme Store > Store Structure > should have subscribe method 5013ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 914ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1584ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 722ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:11:11\n\n   Duration  12.38s (transform 6.35s, setup 0ms, collect 10.84s, tests 8.47s, environment 8ms, prepare 18.10s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 79 }, "start": { "column": 67, "line": 74 } }
				},
				{
					"id": "239",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 24ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 38ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 169ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 23ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 177ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 217ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 34ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5702ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 671ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1782ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 894ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  23:11:15\n\n   Duration  13.57s (transform 8.07s, setup 0ms, collect 15.01s, tests 8.56s, environment 19ms, prepare 22.72s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 17, "line": 76 }, "start": { "column": 7, "line": 76 } }
				},
				{
					"id": "238",
					"mutatorName": "BooleanLiteral",
					"replacement": "sessionId",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 70ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 156ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 82ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 24ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 336ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 27ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 169ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 147ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 50ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 140ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 50ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 55ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6316ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1302ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 98ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1761ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1045ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:11:15\n   Duration  14.24s (transform 8.76s, setup 0ms, collect 14.96s, tests 9.64s, environment 8ms, prepare 23.16s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 17, "line": 76 }, "start": { "column": 7, "line": 76 } }
				},
				{
					"id": "240",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 17, "line": 76 }, "start": { "column": 7, "line": 76 } }
				},
				{
					"id": "241",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 94 }, "start": { "column": 30, "line": 82 } }
				},
				{
					"id": "242",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 5, "line": 91 }, "start": { "column": 10, "line": 84 } }
				},
				{
					"id": "243",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 6, "line": 90 }, "start": { "column": 53, "line": 86 } }
				},
				{
					"id": "244",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 16ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 28ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 44ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 170ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 131ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 426ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 392ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 19ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 140ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5163ms\n\n   × Theme Store > Store Structure > should have subscribe method 5008ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1593ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 737ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 246ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:11:37\n   Duration  11.44s (transform 7.18s, setup 0ms, collect 11.58s, tests 8.37s, environment 7ms, prepare 17.91s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 87 }, "start": { "column": 10, "line": 87 } }
				},
				{
					"id": "245",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 108ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 114ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 144ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 255ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 129ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 32ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 34ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 171ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5661ms\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 646ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1237ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 592ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:11:38\n\n   Duration  11.94s (transform 6.34s, setup 0ms, collect 12.46s, tests 8.25s, environment 152ms, prepare 19.76s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 87 }, "start": { "column": 10, "line": 87 } }
				},
				{
					"id": "246",
					"mutatorName": "EqualityOperator",
					"replacement": "now >= session.expiresAt",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 220ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 29ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 75ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 459ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 443ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 87ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 19ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6154ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1140ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 27ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 312ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2104ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1268ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:11:42\n   Duration  13.34s (transform 6.56s, setup 0ms, collect 13.01s, tests 9.85s, environment 9ms, prepare 24.87s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 87 }, "start": { "column": 10, "line": 87 } }
				},
				{
					"id": "247",
					"mutatorName": "EqualityOperator",
					"replacement": "now <= session.expiresAt",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 31ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 223ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 223ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 182ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 540ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 528ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 25ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 61ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 175ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 55ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5677ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 657ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1882ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1040ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 235ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:11:42\n\n   Duration  13.69s (transform 6.42s, setup 0ms, collect 12.83s, tests 9.51s, environment 66ms, prepare 22.98s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 87 }, "start": { "column": 10, "line": 87 } }
				},
				{
					"id": "248",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 7, "line": 89 }, "start": { "column": 35, "line": 87 } }
				},
				{
					"id": "249",
					"mutatorName": "ArithmeticOperator",
					"replacement": "60 * 60 / 1000",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 18, "line": 92 }, "start": { "column": 4, "line": 92 } }
				},
				{
					"id": "250",
					"mutatorName": "ArithmeticOperator",
					"replacement": "60 / 60",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 298ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 34ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 22ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 459ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 447ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 61ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 49ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 31ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5809ms\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 791ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 60ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 13ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1806ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 967ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:11:49\n\n   Duration  13.11s (transform 7.76s, setup 0ms, collect 12.13s, tests 9.03s, environment 24ms, prepare 22.82s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 11, "line": 92 }, "start": { "column": 4, "line": 92 } }
				},
				{
					"id": "251",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 18ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 126ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 145ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 69ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 75ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 221ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ❯ tests/unit/lib/session.test.ts (16 tests | 1 failed) 16ms\n\n   × SessionService > Session Count > should track session count 7ms\n\n     → actual value must be number or bigint, received \"undefined\"\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 16ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 165ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 134ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 25ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\n ✓ tests/unit/stores/theme.test.ts (26 tests) 3884ms\n\n   ✓ Theme Store > Store Structure > should have subscribe method 3874ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1090ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 531ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/lib/session.test.ts > SessionService > Session Count > should track session count\n\nTypeError: actual value must be number or bigint, received \"undefined\"\n\n ❯ tests/unit/lib/session.test.ts:81:21\n\n     79|    const newCount = SessionService.getSessionCount();\n     80| \n     81|    expect(newCount).toBeGreaterThan(initialCount);\n       |                     ^\n     82| \n     83|    SessionService.destroySession(session.id);\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:00\n\n   Duration  10.59s (transform 7.49s, setup 0ms, collect 14.36s, tests 6.20s, environment 17ms, prepare 15.08s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 99 }, "start": { "column": 35, "line": 97 } }
				}
			],
			"source": "import { randomBytes } from 'crypto';\nimport type { RequestEvent } from '@sveltejs/kit';\nimport { config } from './config';\n\nexport interface Session {\n\tid: string;\n\tcreatedAt: Date;\n\texpiresAt: Date;\n\tisAdmin: boolean;\n}\n\n// In-memory session store (simple, no external dependency)\nconst sessions = new Map<string, Session>();\n\nexport class SessionService {\n\tprivate static readonly COOKIE_NAME = 'privasend_session';\n\tprivate static sessionSecret: string;\n\n\tstatic initialize() {\n\t\t// Auto-generate session secret if not configured\n\t\tthis.sessionSecret = config.auth.sessionSecret || randomBytes(32).toString('hex');\n\t\tif (!config.auth.sessionSecret) {\n\t\t\tconsole.log('Session secret auto-generated');\n\t\t}\n\t\tconsole.log('Session service initialized');\n\t}\n\n\tstatic createSession(): Session {\n\t\tconst id = randomBytes(32).toString('hex');\n\t\tconst timeoutHours = config.auth.sessionTimeoutHours;\n\n\t\tconst session: Session = {\n\t\t\tid,\n\t\t\tcreatedAt: new Date(),\n\t\t\texpiresAt: new Date(Date.now() + timeoutHours * 60 * 60 * 1000),\n\t\t\tisAdmin: true\n\t\t};\n\n\t\tsessions.set(id, session);\n\t\treturn session;\n\t}\n\n\tstatic getSession(sessionId: string): Session | null {\n\t\tconst session = sessions.get(sessionId);\n\t\tif (!session) return null;\n\n\t\t// Check expiration\n\t\tif (new Date() > session.expiresAt) {\n\t\t\tthis.destroySession(sessionId);\n\t\t\treturn null;\n\t\t}\n\n\t\treturn session;\n\t}\n\n\tstatic destroySession(sessionId: string): void {\n\t\tsessions.delete(sessionId);\n\t}\n\n\tstatic setSessionCookie(event: RequestEvent, sessionId: string): void {\n\t\tevent.cookies.set(this.COOKIE_NAME, sessionId, {\n\t\t\tpath: '/',\n\t\t\thttpOnly: true,\n\t\t\tsecure: process.env.NODE_ENV === 'production',\n\t\t\tsameSite: 'strict',\n\t\t\tmaxAge: config.auth.sessionTimeoutHours * 60 * 60\n\t\t});\n\t}\n\n\tstatic clearSessionCookie(event: RequestEvent): void {\n\t\tevent.cookies.delete(this.COOKIE_NAME, { path: '/' });\n\t}\n\n\tstatic getSessionFromCookie(event: RequestEvent): Session | null {\n\t\tconst sessionId = event.cookies.get(this.COOKIE_NAME);\n\t\tif (!sessionId) return null;\n\n\t\treturn this.getSession(sessionId);\n\t}\n\n\t// Cleanup expired sessions periodically\n\tstatic startCleanup(): void {\n\t\tsetInterval(\n\t\t\t() => {\n\t\t\t\tconst now = new Date();\n\t\t\t\tfor (const [id, session] of sessions.entries()) {\n\t\t\t\t\tif (now > session.expiresAt) {\n\t\t\t\t\t\tsessions.delete(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t60 * 60 * 1000\n\t\t); // Every hour\n\t}\n\n\t// Get session count for monitoring\n\tstatic getSessionCount(): number {\n\t\treturn sessions.size;\n\t}\n}\n\n// Initialize on module load\nSessionService.initialize();\nSessionService.startCleanup();\n"
		},
		"src/lib/stores/auth.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "252",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 98ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 19ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 40ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 27ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 250ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 144ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 404ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 385ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5265ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 15ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1708ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 891ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 29ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:04\n\n   Duration  11.57s (transform 6.03s, setup 0ms, collect 9.79s, tests 8.36s, environment 10ms, prepare 18.41s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 2, "line": 45 }, "start": { "column": 28, "line": 10 } }
				},
				{
					"id": "253",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 22ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 124ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 495ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 470ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 72ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 167ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 8ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 46ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 66ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 121ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 15ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5806ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 761ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 19ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1303ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 530ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 84ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 136ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:05\n\n   Duration  12.56s (transform 6.57s, setup 0ms, collect 12.29s, tests 8.66s, environment 166ms, prepare 20.11s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 15 }, "start": { "column": 57, "line": 11 } }
				},
				{
					"id": "254",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 34ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 196ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 607ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 440ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5305ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 9ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1873ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 882ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 5ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  23:12:08\n\n   Duration  13.40s (transform 8.05s, setup 0ms, collect 16.80s, tests 8.48s, environment 18ms, prepare 23.82s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 25, "line": 12 }, "start": { "column": 20, "line": 12 } }
				},
				{
					"id": "255",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 20ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 149ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 59ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 186ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 171ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 325ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 28ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 47ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 20ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 24ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5796ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 783ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2155ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1277ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:09\n\n   Duration  14.14s (transform 8.06s, setup 0ms, collect 13.21s, tests 9.29s, environment 12ms, prepare 27.31s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 21, "line": 13 }, "start": { "column": 16, "line": 13 } }
				},
				{
					"id": "258",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 4, "line": 34 }, "start": { "column": 23, "line": 19 } }
				},
				{
					"id": "257",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 3, "line": 44 }, "start": { "column": 9, "line": 17 } }
				},
				{
					"id": "256",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 287ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 236ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 103ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 405ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 301ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5174ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1282ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 764ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 241ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 24ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 6ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:16\n\n   Duration  13.23s (transform 7.46s, setup 0ms, collect 12.89s, tests 8.17s, environment 21ms, prepare 23.51s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 16, "line": 14 }, "start": { "column": 12, "line": 14 } }
				},
				{
					"id": "259",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 5, "line": 30 }, "start": { "column": 8, "line": 20 } }
				},
				{
					"id": "260",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 60ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 49ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 32ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 33ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 88ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 255ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 38ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 19ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 168ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 249ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 313ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 134ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 27ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 20ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 145ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 7920ms\n\n   × Theme Store > Store Structure > should have subscribe method 5198ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 2673ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1611ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 708ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 17ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:31\n\n   Duration  13.74s (transform 10.41s, setup 0ms, collect 17.98s, tests 11.31s, environment 36ms, prepare 20.70s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 21 }, "start": { "column": 34, "line": 21 } }
				},
				{
					"id": "261",
					"mutatorName": "ArrowFunction",
					"replacement": "() => undefined",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 26ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 24ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 114ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 191ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 225ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 14ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 69ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 22ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 260ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8449ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3423ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 89ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 139ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1981ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1153ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 12ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:32\n\n   Duration  16.03s (transform 9.61s, setup 0ms, collect 14.82s, tests 11.88s, environment 10ms, prepare 27.94s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 7, "line": 29 }, "start": { "column": 12, "line": 24 } }
				},
				{
					"id": "262",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 255ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 30ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 760ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 16ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 170ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 53ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 12ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 131ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 197ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 14ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8200ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 3181ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 36ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 195ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2021ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1102ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:34\n\n   Duration  16.86s (transform 11.46s, setup 0ms, collect 19.53s, tests 12.30s, environment 13ms, prepare 34.80s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 6, "line": 29 }, "start": { "column": 24, "line": 24 } }
				},
				{
					"id": "263",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 66ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 42ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 764ms\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 745ms\n   ✓ Audit Log Fields > Required Fields > should require event_type 662ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 1532ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 965ms\n\n   ✓ Security Headers - Mutation Testing > httpsRedirect middleware > should redirect HTTP to HTTPS in production 352ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 15ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 416ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 391ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 59ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 89ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 171ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 19ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 207ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 45ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6682ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1626ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 39ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1654ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 743ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:36\n\n   Duration  16.49s (transform 9.14s, setup 0ms, collect 16.31s, tests 12.66s, environment 8ms, prepare 23.31s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 20, "line": 28 }, "start": { "column": 15, "line": 28 } }
				},
				{
					"id": "265",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 49, "line": 31 }, "start": { "column": 19, "line": 31 } }
				},
				{
					"id": "266",
					"mutatorName": "ArrowFunction",
					"replacement": "() => undefined",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 13ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 29ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 16ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 355ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 414ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 399ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 51ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 201ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 22ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 24ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5317ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1307ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 814ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 132ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 25ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  23:12:45\n\n   Duration  13.21s (transform 6.03s, setup 0ms, collect 13.45s, tests 8.11s, environment 13ms, prepare 20.13s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 53, "line": 32 }, "start": { "column": 12, "line": 32 } }
				},
				{
					"id": "264",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 20ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 26ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 30ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 290ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 186ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 86ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 18ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 217ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 180ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 286ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5502ms\n\n   × Theme Store > Store Structure > should have subscribe method 5007ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 478ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1356ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 844ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:12:44\n\n   Duration  14.31s (transform 8.14s, setup 0ms, collect 15.24s, tests 8.38s, environment 21ms, prepare 25.41s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 5, "line": 33 }, "start": { "column": 18, "line": 30 } }
				},
				{
					"id": "267",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 52, "line": 32 }, "start": { "column": 24, "line": 32 } }
				},
				{
					"id": "268",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 50, "line": 32 }, "start": { "column": 45, "line": 32 } }
				},
				{
					"id": "269",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 4, "line": 43 }, "start": { "column": 18, "line": 35 } }
				},
				{
					"id": "271",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 35, "line": 37 }, "start": { "column": 17, "line": 37 } }
				},
				{
					"id": "270",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 19ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 314ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 112ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 110ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 19ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 5ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 11ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 133ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 105ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 164ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 18ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6116ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 1102ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1498ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 762ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 11ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n   Start at  23:13:04\n   Duration  13.79s (transform 10.10s, setup 0ms, collect 17.82s, tests 8.98s, environment 19ms, prepare 22.58s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 5, "line": 40 }, "start": { "column": 8, "line": 36 } }
				},
				{
					"id": "272",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 55, "line": 37 }, "start": { "column": 37, "line": 37 } }
				},
				{
					"id": "273",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 53, "line": 37 }, "start": { "column": 47, "line": 37 } }
				},
				{
					"id": "274",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 70, "line": 38 }, "start": { "column": 9, "line": 38 } }
				},
				{
					"id": "275",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 33, "line": 38 }, "start": { "column": 28, "line": 38 } }
				},
				{
					"id": "277",
					"mutatorName": "BooleanLiteral",
					"replacement": "true",
					"status": "Survived",
					"testsCompleted": 1,
					"location": { "end": { "column": 68, "line": 38 }, "start": { "column": 63, "line": 38 } }
				},
				{
					"id": "276",
					"mutatorName": "BooleanLiteral",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 15ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 53ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 24ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 25ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 252ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 40ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 11ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 98ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 10ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 138ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 24ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 24ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5331ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 314ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1229ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 692ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 183ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 28ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:13:26\n   Duration  11.77s (transform 6.33s, setup 0ms, collect 11.74s, tests 7.77s, environment 14ms, prepare 19.66s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 52, "line": 38 }, "start": { "column": 48, "line": 38 } }
				},
				{
					"id": "280",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Timeout",
					"location": { "end": { "column": 35, "line": 41 }, "start": { "column": 19, "line": 41 } }
				},
				{
					"id": "278",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Timeout",
					"location": { "end": { "column": 18, "line": 39 }, "start": { "column": 10, "line": 39 } }
				},
				{
					"id": "279",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Timeout",
					"location": { "end": { "column": 5, "line": 42 }, "start": { "column": 18, "line": 40 } }
				}
			],
			"source": "import { writable } from 'svelte/store';\nimport { goto } from '$app/navigation';\n\ninterface AuthState {\n\tisAuthenticated: boolean;\n\tauthEnabled: boolean;\n\tloading: boolean;\n}\n\nfunction createAuthStore() {\n\tconst { subscribe, set, update } = writable<AuthState>({\n\t\tisAuthenticated: false,\n\t\tauthEnabled: false,\n\t\tloading: true\n\t});\n\n\treturn {\n\t\tsubscribe,\n\t\tasync checkStatus() {\n\t\t\ttry {\n\t\t\t\tconst response = await fetch('/api/auth/status');\n\t\t\t\tconst data = await response.json();\n\n\t\t\t\tupdate((state) => ({\n\t\t\t\t\t...state,\n\t\t\t\t\tisAuthenticated: data.authenticated,\n\t\t\t\t\tauthEnabled: data.authEnabled,\n\t\t\t\t\tloading: false\n\t\t\t\t}));\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Failed to check auth status:', err);\n\t\t\t\tupdate((state) => ({ ...state, loading: false }));\n\t\t\t}\n\t\t},\n\t\tasync logout() {\n\t\t\ttry {\n\t\t\t\tawait fetch('/api/auth/logout', { method: 'POST' });\n\t\t\t\tset({ isAuthenticated: false, authEnabled: true, loading: false });\n\t\t\t\tgoto('/login');\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Logout failed:', err);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport const auth = createAuthStore();\n"
		},
		"src/lib/stores/theme.ts": {
			"language": "typescript",
			"mutants": [
				{
					"id": "283",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"status": "Timeout",
					"location": { "end": { "column": 53, "line": 8 }, "start": { "column": 25, "line": 8 } }
				},
				{
					"id": "282",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"status": "Timeout",
					"location": { "end": { "column": 55, "line": 7 }, "start": { "column": 48, "line": 7 } }
				},
				{
					"id": "281",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"status": "Timeout",
					"location": { "end": { "column": 2, "line": 37 }, "start": { "column": 29, "line": 6 } }
				},
				{
					"id": "285",
					"mutatorName": "LogicalOperator",
					"replacement": "stored as Theme && 'light'",
					"status": "Timeout",
					"location": { "end": { "column": 53, "line": 8 }, "start": { "column": 25, "line": 8 } }
				},
				{
					"id": "284",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"status": "Timeout",
					"location": { "end": { "column": 53, "line": 8 }, "start": { "column": 25, "line": 8 } }
				},
				{
					"id": "286",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 132ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 169ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 260ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 674ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 465ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 595ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 481ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 15ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 21ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 168ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 222ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 12ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 26ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 166ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 67ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10556ms\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5002ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have set method 524ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 8ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 178ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3141ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1514ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 18ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:20:45\n\n   Duration  20.92s (transform 12.93s, setup 0ms, collect 19.72s, tests 16.57s, environment 13ms, prepare 38.49s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 53, "line": 8 }, "start": { "column": 46, "line": 8 } }
				},
				{
					"id": "290",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 128ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 79ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 20ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 210ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 571ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 778ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 768ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 5ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 19ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 198ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 46ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 140ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 214ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 33ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 32ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 55ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2952ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1467ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11023ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1010ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:20:45\n\n   Duration  21.71s (transform 13.39s, setup 0ms, collect 19.81s, tests 16.62s, environment 14ms, prepare 37.47s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 16 }, "start": { "column": 26, "line": 14 } }
				},
				{
					"id": "288",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 120ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 211ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 574ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 411ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 238ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 639ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 520ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 16ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 142ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 63ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 18ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 216ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 50ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 59ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 167ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10712ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5001ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 695ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2837ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1510ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:20:45\n\n   Duration  22.26s (transform 14.78s, setup 0ms, collect 21.37s, tests 16.38s, environment 9ms, prepare 36.52s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 14 }, "start": { "column": 6, "line": 14 } }
				},
				{
					"id": "289",
					"mutatorName": "LogicalOperator",
					"replacement": "browser || initial",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 216ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 21ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 180ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 185ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 687ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 450ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 382ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 163ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 55ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 54ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 13ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 277ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 29ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 3 failed) 9715ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 4687ms\n\n     → document is not defined\n\n   × Theme Store > Store Structure > should have set method 1ms\n\n     → document is not defined\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2697ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1551ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 12ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 10ms\n\n ❯ tests/unit/stores/theme-real.test.ts (0 test)\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme-real.test.ts [ tests/unit/stores/theme-real.test.ts ]\n\nReferenceError: document is not defined\n\n ❯ createThemeStore src/lib/stores/theme.ts:67:9\n\n     65|       } else {\n     66|         stryCov_9fa48(\"290\");\n     67|         document.documentElement.setAttribute(stryMutAct_9fa48(\"291\") …\n       |         ^\n     68|       }\n     69|     }\n\n ❯ src/lib/stores/theme.ts:111:22\n\n ❯ tests/unit/stores/theme-real.test.ts:2:31\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have set method\n\nReferenceError: document is not defined\n\n ❯ createThemeStore src/lib/stores/theme.ts:67:9\n\n     65|       } else {\n     66|         stryCov_9fa48(\"290\");\n     67|         document.documentElement.setAttribute(stryMutAct_9fa48(\"291\") …\n       |         ^\n     68|       }\n     69|     }\n\n ❯ src/lib/stores/theme.ts:111:22\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 520 passed (523)\n\n   Start at  23:20:45\n\n   Duration  21.99s (transform 14.42s, setup 0ms, collect 18.90s, tests 14.87s, environment 85ms, prepare 37.34s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 14 }, "start": { "column": 6, "line": 14 } }
				},
				{
					"id": "287",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 200ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 34ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 74ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 203ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 499ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 463ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 20ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 104ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 107ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 161ms\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 390ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 181ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 3 failed) 10418ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have set method 274ms\n\n     → document is not defined\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 92ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 11ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 3109ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1491ms\n\n ❯ tests/unit/stores/theme-real.test.ts (0 test)\n\n\n\n⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/unit/stores/theme-real.test.ts [ tests/unit/stores/theme-real.test.ts ]\n\nReferenceError: document is not defined\n\n ❯ createThemeStore src/lib/stores/theme.ts:67:9\n\n     65|       } else {\n     66|         stryCov_9fa48(\"290\");\n     67|         document.documentElement.setAttribute(stryMutAct_9fa48(\"291\") …\n       |         ^\n     68|       }\n     69|     }\n\n ❯ src/lib/stores/theme.ts:111:22\n\n ❯ tests/unit/stores/theme-real.test.ts:2:31\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have set method\n\nReferenceError: document is not defined\n\n ❯ createThemeStore src/lib/stores/theme.ts:67:9\n\n     65|       } else {\n     66|         stryCov_9fa48(\"290\");\n     67|         document.documentElement.setAttribute(stryMutAct_9fa48(\"291\") …\n       |         ^\n     68|       }\n     69|     }\n\n ❯ src/lib/stores/theme.ts:111:22\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  3 failed | 520 passed (523)\n\n   Start at  23:20:45\n\n   Duration  22.37s (transform 13.39s, setup 0ms, collect 19.88s, tests 16.20s, environment 17ms, prepare 37.62s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 24, "line": 14 }, "start": { "column": 6, "line": 14 } }
				},
				{
					"id": "292",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 15ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 47ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 44ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 254ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 392ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 557ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 493ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 350ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 14ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 49ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 86ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 38ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 52ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 13ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9686ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4667ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 7ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 148ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2613ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1143ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 12ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:20:45\n\n   Duration  21.63s (transform 12.54s, setup 0ms, collect 21.29s, tests 14.80s, environment 16ms, prepare 34.48s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 21 }, "start": { "column": 29, "line": 19 } }
				},
				{
					"id": "291",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 188ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 167ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 421ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 688ms\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 443ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 530ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 648ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 563ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 64ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 153ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 201ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 44ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 23ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 37ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11195ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1171ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 16ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 118ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2759ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1112ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 8ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 10ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:20:46\n\n   Duration  22.07s (transform 16.65s, setup 0ms, collect 24.15s, tests 17.40s, environment 38ms, prepare 34.27s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 53, "line": 15 }, "start": { "column": 41, "line": 15 } }
				},
				{
					"id": "293",
					"mutatorName": "ObjectLiteral",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 21ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 14ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 666ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 202ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 335ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 28ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 21ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 544ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 447ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 34ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 201ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 93ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 51ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 26ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 73ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 38ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 22ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 3 failed) 9818ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 4797ms\n\n     → expected 'undefined' to be 'function' // Object.is equality\n\n   × Theme Store > Store Structure > should have set method 1ms\n\n     → expected 'undefined' to be 'function' // Object.is equality\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1774ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 642ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 10ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 9ms\n\n ❯ tests/unit/stores/theme-real.test.ts (3 tests | 3 failed) 15ms\n\n   × Theme Store - Real Tests > should have subscribe method 10ms\n     → expected 'undefined' to be 'function' // Object.is equality\n\n   × Theme Store - Real Tests > should have toggle method 2ms\n     → expected 'undefined' to be 'function' // Object.is equality\n\n   × Theme Store - Real Tests > should have set method 1ms\n     → expected 'undefined' to be 'function' // Object.is equality\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme-real.test.ts > Theme Store - Real Tests > should have subscribe method\n\nAssertionError: expected 'undefined' to be 'function' // Object.is equality\n\n\nExpected: \"function\"\nReceived: \"undefined\"\n\n\n ❯ tests/unit/stores/theme-real.test.ts:11:34\n\n      9| describe('Theme Store - Real Tests', () => {\n     10|  it('should have subscribe method', () => {\n     11|   expect(typeof theme.subscribe).toBe('function');\n       |                                  ^\n     12|  });\n     13| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯\n\n\n FAIL  tests/unit/stores/theme-real.test.ts > Theme Store - Real Tests > should have toggle method\n\nAssertionError: expected 'undefined' to be 'function' // Object.is equality\n\n\nExpected: \"function\"\nReceived: \"undefined\"\n\n\n ❯ tests/unit/stores/theme-real.test.ts:15:31\n\n     13| \n     14|  it('should have toggle method', () => {\n     15|   expect(typeof theme.toggle).toBe('function');\n       |                               ^\n     16|  });\n     17| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯\n\n\n FAIL  tests/unit/stores/theme-real.test.ts > Theme Store - Real Tests > should have set method\n\nAssertionError: expected 'undefined' to be 'function' // Object.is equality\n\n\nExpected: \"function\"\nReceived: \"undefined\"\n\n\n ❯ tests/unit/stores/theme-real.test.ts:19:28\n\n     17| \n     18|  it('should have set method', () => {\n     19|   expect(typeof theme.set).toBe('function');\n       |                            ^\n     20|  });\n     21| });\n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nAssertionError: expected 'undefined' to be 'function' // Object.is equality\n\n\nExpected: \"function\"\nReceived: \"undefined\"\n\n\n ❯ tests/unit/stores/theme.test.ts:25:32\n\n     23|   it('should have toggle method', async () => {\n     24|    const { theme } = await import('$lib/stores/theme');\n     25|    expect(typeof theme.toggle).toBe('function');\n       |                                ^\n     26|   });\n     27| \n\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have set method\n\nAssertionError: expected 'undefined' to be 'function' // Object.is equality\n\n\nExpected: \"function\"\nReceived: \"undefined\"\n\n\n ❯ tests/unit/stores/theme.test.ts:30:29\n\n     28|   it('should have set method', async () => {\n     29|    const { theme } = await import('$lib/stores/theme');\n     30|    expect(typeof theme.set).toBe('function');\n       |                             ^\n     31|   });\n     32|  });\n\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯\n\n\n Test Files  2 failed | 30 passed (32)\n\n      Tests  6 failed | 520 passed (526)\n\n   Start at  23:20:47\n\n   Duration  20.83s (transform 17.73s, setup 0ms, collect 28.46s, tests 14.10s, environment 22ms, prepare 33.45s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 3, "line": 36 }, "start": { "column": 9, "line": 23 } }
				},
				{
					"id": "299",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 59ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 40ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 25ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 266ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 663ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 371ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 713ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 419ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 16ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 33ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 181ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 23ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 113ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 17ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 85ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 106ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 14ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 8ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 11817ms\n\n   × Theme Store > Store Structure > should have subscribe method 5010ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 1797ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 75ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2765ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1259ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 16ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  2 failed | 524 passed (526)\n   Start at  23:21:11\n\n   Duration  20.30s (transform 12.21s, setup 0ms, collect 16.32s, tests 17.12s, environment 30ms, prepare 33.10s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 54, "line": 26 }, "start": { "column": 48, "line": 26 } }
				},
				{
					"id": "294",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 44ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 39ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 152ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 14ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 77ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 173ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 239ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 60ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 62ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 166ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 72ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 68ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 10ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 54ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 46ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2629ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1463ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 13395ms\n\n   × Theme Store > Store Structure > should have subscribe method 5012ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 3342ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:21:11\n\n   Duration  20.95s (transform 13.94s, setup 0ms, collect 20.32s, tests 17.45s, environment 25ms, prepare 34.49s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 28 }, "start": { "column": 12, "line": 25 } }
				},
				{
					"id": "295",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 13ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 70ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 74ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 180ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 358ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 335ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 269ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 10ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 16ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 243ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 250ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 46ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 42ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 299ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 101ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 160ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 34ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 9157ms\n\n   × Theme Store > Store Structure > should have subscribe method 5003ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4146ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 67ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2419ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1011ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 8ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 21ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 9ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:11\n\n   Duration  21.42s (transform 13.69s, setup 0ms, collect 21.96s, tests 14.26s, environment 110ms, prepare 38.11s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 26 }, "start": { "column": 21, "line": 26 } }
				},
				{
					"id": "297",
					"mutatorName": "EqualityOperator",
					"replacement": "currentTheme !== 'light'",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 130ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 51ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 373ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 339ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 400ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 119ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 22ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 387ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 373ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 85ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 144ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 8ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 209ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 170ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 22ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 30ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 260ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 175ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 14ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 9ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 68ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10042ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   × Theme Store > Store Structure > should have toggle method 5007ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 14ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 172ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2694ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1169ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:21:11\n\n   Duration  21.28s (transform 15.03s, setup 0ms, collect 23.04s, tests 15.66s, environment 61ms, prepare 31.35s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 26 }, "start": { "column": 21, "line": 26 } }
				},
				{
					"id": "296",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 12ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 18ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 56ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 255ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 300ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 597ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 386ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 644ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 459ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 68ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 14ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 215ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 10ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 31ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 11ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 11ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10582ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have set method 565ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 20ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 7ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 26ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2980ms\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1277ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n   Start at  23:21:11\n\n   Duration  21.87s (transform 15.14s, setup 0ms, collect 22.74s, tests 15.98s, environment 11ms, prepare 36.90s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 26 }, "start": { "column": 21, "line": 26 } }
				},
				{
					"id": "298",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 36ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 114ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 32ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 34ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 502ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 346ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 333ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 16ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 93ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 190ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 6ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 45ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 15ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 21ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 10ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 5ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 10141ms\n\n   × Theme Store > Store Structure > should have subscribe method 5015ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 4911ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 3ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 41ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 2549ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1226ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:12\n\n   Duration  20.97s (transform 14.86s, setup 0ms, collect 24.50s, tests 14.30s, environment 101ms, prepare 32.06s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 45, "line": 26 }, "start": { "column": 38, "line": 26 } }
				},
				{
					"id": "300",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 517ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 122ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 108ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 137ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 281ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 27ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 558ms\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 548ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 53ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 15ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 179ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 15ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 33ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 177ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 12ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 14ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 2 failed) 10164ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   × Theme Store > Store Structure > should have toggle method 5002ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 10ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 102ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1798ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 662ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have toggle method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  2 failed | 524 passed (526)\n\n   Start at  23:21:14\n\n   Duration  20.07s (transform 13.77s, setup 0ms, collect 21.09s, tests 14.44s, environment 43ms, prepare 33.59s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 64, "line": 26 }, "start": { "column": 57, "line": 26 } }
				},
				{
					"id": "301",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 206ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 117ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 48ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 88ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 595ms\n\n   ✓ Security Headers - Mutation Testing > securityHeaders middleware > should set X-Frame-Options to DENY 409ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 596ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 563ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 91ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 7ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 121ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 171ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 224ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 173ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 53ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 194ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 8569ms\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n   ✓ Theme Store > Store Structure > should have toggle method 3555ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 6ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 9ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 36ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 36ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 25ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 67ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 943ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 306ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:15\n\n   Duration  19.36s (transform 12.48s, setup 0ms, collect 21.04s, tests 12.46s, environment 11ms, prepare 33.65s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 4, "line": 35 }, "start": { "column": 24, "line": 29 } }
				},
				{
					"id": "302",
					"mutatorName": "ConditionalExpression",
					"replacement": "true",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 17ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 42ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 27ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 14ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 99ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 394ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 372ms\n\n   ✓ Admin Dashboard (/admin) > Event Display > should format timestamp 352ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 23ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 38ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 12ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 46ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 160ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 8ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 135ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 12ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6889ms\n\n   × Theme Store > Store Structure > should have subscribe method 5004ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1875ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 4ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1859ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 1039ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 4ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n      Tests  1 failed | 525 passed (526)\n   Start at  23:21:36\n\n   Duration  11.80s (transform 6.99s, setup 0ms, collect 9.99s, tests 10.29s, environment 7ms, prepare 20.52s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 15, "line": 30 }, "start": { "column": 8, "line": 30 } }
				},
				{
					"id": "305",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 163ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 10ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 23ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 59ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 270ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 63ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 66ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 434ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 25ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 31ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 192ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 10ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 198ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 36ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 7ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 6ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6399ms\n\n   × Theme Store > Store Structure > should have subscribe method 5011ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1379ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 5ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 8ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 222ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 8ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 10ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1584ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 724ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 233ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:37\n\n   Duration  12.12s (transform 6.85s, setup 0ms, collect 11.44s, tests 10.13s, environment 13ms, prepare 21.08s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 33, "line": 31 }, "start": { "column": 26, "line": 31 } }
				},
				{
					"id": "303",
					"mutatorName": "ConditionalExpression",
					"replacement": "false",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 31ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 93ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 148ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 63ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 63ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 47ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 12ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 15ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 73ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 10ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 231ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 9ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 29ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 11ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 31ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 6ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5795ms\n\n   × Theme Store > Store Structure > should have subscribe method 5006ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 780ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1529ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 642ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 5ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 7ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 4ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:37\n\n   Duration  11.87s (transform 6.57s, setup 0ms, collect 10.66s, tests 8.30s, environment 8ms, prepare 22.86s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 15, "line": 30 }, "start": { "column": 8, "line": 30 } }
				},
				{
					"id": "306",
					"mutatorName": "StringLiteral",
					"replacement": "\"\"",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 9ms\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 13ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 55ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 198ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 308ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 8ms\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 10ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 302ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 18ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 13ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 33ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 13ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 11ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 51ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 164ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 10ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 8ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 22ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 23ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 17ms\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 6503ms\n\n   × Theme Store > Store Structure > should have subscribe method 5005ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 1484ms\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 1279ms\n\n   ✓ AuthService > Password Verification (when enabled) > should reject empty password 492ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 6ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 3ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 7ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:37\n\n   Duration  12.48s (transform 7.21s, setup 0ms, collect 13.01s, tests 9.14s, environment 13ms, prepare 20.35s)\n\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 55, "line": 32 }, "start": { "column": 43, "line": 32 } }
				},
				{
					"id": "304",
					"mutatorName": "BlockStatement",
					"replacement": "{}",
					"statusReason": "\n> privasend@0.4.5 test\n> vitest --run\n\n\n\n RUN  v2.1.9 /Users/fred/Code/PrivaSend/.stryker-tmp/sandbox-CtEGkL\n\n\n ✓ tests/unit/lib/security-extended.test.ts (25 tests) 12ms\n\n ✓ tests/unit/lib/security-complete.test.ts (42 tests) 16ms\n\n ✓ tests/unit/routes/upload-security.test.ts (16 tests) 7ms\n\n ✓ tests/unit/routes/auth-api.test.ts (21 tests) 8ms\n\n ✓ tests/unit/lib/audit-integration.test.ts (27 tests) 52ms\n\n ✓ tests/unit/lib/security-headers.test.ts (17 tests) 299ms\n\n ✓ tests/unit/database/audit-db.test.ts (30 tests) 246ms\n\n ✓ tests/unit/routes/phase-5.test.ts (31 tests) 96ms\n\n ✓ tests/unit/lib/ratelimit-complete.test.ts (11 tests) 17ms\n\n ✓ tests/unit/lib/config-upload.test.ts (10 tests) 6ms\n\nstdout | tests/unit/lib/session.test.ts\nSession secret auto-generated\nSession service initialized\n\n\n ✓ tests/unit/utils/formatters.test.ts (18 tests) 13ms\n\n ✓ tests/unit/lib/audit.test.ts (28 tests) 9ms\n\n ✓ tests/unit/lib/session.test.ts (16 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit.test.ts (13 tests) 159ms\n\n ✓ tests/unit/helpers/dates.test.ts (11 tests) 7ms\n\n ✓ tests/unit/api/admin-files.test.ts (21 tests) 7ms\n\n ✓ tests/unit/routes/global-nav.test.ts (22 tests) 7ms\n\n ✓ tests/unit/routes/phase-4.2.test.ts (23 tests) 9ms\n\n ✓ tests/unit/lib/ratelimit-extended.test.ts (9 tests) 32ms\n\n ✓ tests/unit/lib/security-comprehensive.test.ts (23 tests) 13ms\n\n ✓ tests/unit/helpers/bytes.test.ts (6 tests) 8ms\n\n ✓ tests/unit/components/qrcode.test.ts (14 tests) 8ms\n\n ✓ tests/unit/lib/security.test.ts (16 tests) 16ms\n\n ✓ tests/unit/lib/config.test.ts (11 tests) 7ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nHashing admin password...\n\n\n ❯ tests/unit/stores/theme.test.ts (26 tests | 1 failed) 5908ms\n\n   × Theme Store > Store Structure > should have subscribe method 5009ms\n\n     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n   ✓ Theme Store > Store Structure > should have toggle method 890ms\n\n ✓ tests/unit/lib/security-behavior.test.ts (8 tests) 6ms\n\nstdout | tests/unit/lib/auth.test.ts > AuthService\nAuthentication enabled - Admin password configured\n\n\n ✓ tests/unit/lib/auth.test.ts (11 tests) 483ms\n\n ✓ tests/unit/lib/security-real-import.test.ts (6 tests) 74ms\n\n ✓ tests/unit/lib/config-real.test.ts (6 tests) 5ms\n\n ✓ tests/unit/routes/version.test.ts (2 tests) 4ms\n\n ✓ tests/unit/lib/cleanup.test.ts (3 tests) 6ms\n\n ✓ tests/unit/stores/theme-real.test.ts (3 tests) 3ms\n\n\n\n⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯\n\n\n FAIL  tests/unit/stores/theme.test.ts > Theme Store > Store Structure > should have subscribe method\n\nError: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\n\n\n Test Files  1 failed | 31 passed (32)\n\n      Tests  1 failed | 525 passed (526)\n\n   Start at  23:21:39\n\n   Duration  11.56s (transform 10.36s, setup 0ms, collect 16.45s, tests 7.55s, environment 17ms, prepare 19.37s)\n\n",
					"status": "Killed",
					"testsCompleted": 1,
					"killedBy": ["0"],
					"location": { "end": { "column": 5, "line": 33 }, "start": { "column": 17, "line": 30 } }
				}
			],
			"source": "import { writable } from 'svelte/store';\nimport { browser } from '$app/environment';\n\ntype Theme = 'light' | 'dark';\n\nfunction createThemeStore() {\n\tconst stored = browser ? localStorage.getItem('theme') : null;\n\tconst initial: Theme = (stored as Theme) || 'light';\n\n\tconst store = writable<Theme>(initial);\n\tlet currentTheme = initial;\n\n\t// Apply theme on init\n\tif (browser && initial) {\n\t\tdocument.documentElement.setAttribute('data-theme', initial);\n\t}\n\n\t// Subscribe to update current value\n\tstore.subscribe((value) => {\n\t\tcurrentTheme = value;\n\t});\n\n\treturn {\n\t\tsubscribe: store.subscribe,\n\t\ttoggle() {\n\t\t\tconst newTheme = currentTheme === 'light' ? 'dark' : 'light';\n\t\t\tthis.set(newTheme);\n\t\t},\n\t\tset(newTheme: Theme) {\n\t\t\tif (browser) {\n\t\t\t\tlocalStorage.setItem('theme', newTheme);\n\t\t\t\tdocument.documentElement.setAttribute('data-theme', newTheme);\n\t\t\t}\n\t\t\tstore.set(newTheme);\n\t\t}\n\t};\n}\n\nexport const theme = createThemeStore();\n"
		}
	},
	"schemaVersion": "1.0",
	"thresholds": { "high": 80, "low": 60, "break": 50 },
	"testFiles": { "": { "tests": [{ "id": "0", "name": "All tests" }] } },
	"projectRoot": "/Users/fred/Code/PrivaSend",
	"config": {
		"$schema": "./node_modules/@stryker-mutator/core/schema/stryker-schema.json",
		"packageManager": "npm",
		"testRunner": "command",
		"commandRunner": { "command": "npm test -- --run" },
		"checkers": [],
		"mutate": [
			"src/lib/server/security.ts",
			"src/lib/server/config.ts",
			"src/lib/server/auth.ts",
			"src/lib/server/session.ts",
			"src/lib/server/audit.ts",
			"src/lib/stores/**/*.ts"
		],
		"reporters": ["progress", "clear-text", "html", "json"],
		"htmlReporter": { "fileName": "mutation-report.html" },
		"jsonReporter": { "fileName": "mutation-report.json" },
		"coverageAnalysis": "off",
		"thresholds": { "high": 80, "low": 60, "break": 50 },
		"timeoutMS": 180000,
		"concurrency": 8,
		"ignorePatterns": ["dist", "build", ".svelte-kit", "node_modules", "coverage"],
		"allowConsoleColors": true,
		"checkerNodeArgs": [],
		"clearTextReporter": {
			"allowColor": true,
			"allowEmojis": false,
			"logTests": true,
			"maxTestsToLog": 3,
			"reportTests": true,
			"reportMutants": true,
			"reportScoreTable": true,
			"skipFull": false
		},
		"dashboard": {
			"baseUrl": "https://dashboard.stryker-mutator.io/api/reports",
			"reportType": "full"
		},
		"dryRunOnly": false,
		"eventReporter": { "baseDir": "reports/mutation/events" },
		"ignoreStatic": false,
		"incremental": false,
		"incrementalFile": "reports/stryker-incremental.json",
		"force": false,
		"fileLogLevel": "off",
		"inPlace": false,
		"logLevel": "info",
		"maxConcurrentTestRunners": 9007199254740991,
		"maxTestRunnerReuse": 0,
		"mutator": { "plugins": null, "excludedMutations": [] },
		"plugins": ["@stryker-mutator/*"],
		"appendPlugins": [],
		"disableTypeChecks": true,
		"symlinkNodeModules": true,
		"tempDirName": ".stryker-tmp",
		"cleanTempDir": true,
		"testRunnerNodeArgs": [],
		"timeoutFactor": 1.5,
		"dryRunTimeoutMinutes": 5,
		"tsconfigFile": "tsconfig.json",
		"warnings": true,
		"disableBail": false,
		"allowEmpty": false,
		"ignorers": [],
		"typescriptChecker": { "prioritizePerformanceOverAccuracy": true },
		"vitest": { "related": true }
	},
	"framework": {
		"name": "StrykerJS",
		"version": "9.4.0",
		"branding": {
			"homepageUrl": "https://stryker-mutator.io",
			"imageUrl": "data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"
		},
		"dependencies": { "@stryker-mutator/typescript-checker": "9.4.0", "typescript": "5.9.3" }
	}
}
